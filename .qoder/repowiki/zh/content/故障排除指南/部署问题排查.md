ç°åœ¨æˆ‘å·²ç»æ”¶é›†äº†è¶³å¤Ÿçš„ä¿¡æ¯æ¥åˆ›å»ºè¯¦ç»†çš„éƒ¨ç½²æ•…éšœæ’æŸ¥æŒ‡å—ã€‚è®©æˆ‘å¼€å§‹ç¼–å†™æ–‡æ¡£ã€‚

<docs>
# éƒ¨ç½²é—®é¢˜æ’æŸ¥æŒ‡å—

<cite>
**æœ¬æ–‡æ¡£ä¸­å¼•ç”¨çš„æ–‡ä»¶**
- [diagnose-deployment.js](file://scripts/deployment/diagnose-deployment.js)
- [verify-config-match.js](file://scripts/deployment/verify-config-match.js)
- [fix-netlify-root-directory.mjs](file://scripts/deployment/fix-netlify-root-directory.mjs)
- [trigger-deployment.js](file://scripts/deployment/trigger-deployment.js)
- [check-netlify-config.js](file://scripts/deployment/check-netlify-config.js)
- [quick-fix-deployment.js](file://scripts/deployment/quick-fix-deployment.js)
- [monitor-deployment.js](file://scripts/deployment/monitor-deployment.js)
- [check-github-secrets.js](file://scripts/deployment/check-github-secrets.js)
- [netlify.toml](file://netlify.toml)
- [run_17963096786_logs/ğŸ¯ Deploy Performance Check/system.txt](file://run_17963096786_logs/ğŸ¯ Deploy Performance Check/system.txt)
- [run_17963096786_logs/ğŸ¯ Deploy Performance Check/1_Set up job.txt](file://run_17963096786_logs/ğŸ¯ Deploy Performance Check/1_Set up job.txt)
- [run_17963096786_logs/ğŸ¯ Deploy Performance Check/2_ğŸ“¥ Checkout code.txt](file://run_17963096786_logs/ğŸ¯ Deploy Performance Check/2_ğŸ“¥ Checkout code.txt)
- [run_17963096786_logs/ğŸ¯ Deploy Performance Check/3_ğŸ”§ Setup Node.js.txt](file://run_17963096786_logs/ğŸ¯ Deploy Performance Check/3_ğŸ”§ Setup Node.js.txt)
</cite>

## ç›®å½•
1. [ç®€ä»‹](#ç®€ä»‹)
2. [éƒ¨ç½²æ¶æ„æ¦‚è§ˆ](#éƒ¨ç½²æ¶æ„æ¦‚è§ˆ)
3. [å¸¸è§éƒ¨ç½²é—®é¢˜åˆ†ç±»](#å¸¸è§éƒ¨ç½²é—®é¢˜åˆ†ç±»)
4. [è¯Šæ–­è„šæœ¬è¯¦è§£](#è¯Šæ–­è„šæœ¬è¯¦è§£)
5. [Netlifyéƒ¨ç½²æ•…éšœæ’æŸ¥](#netlifyéƒ¨ç½²æ•…éšœæ’æŸ¥)
6. [GitHub Actionsæµæ°´çº¿é—®é¢˜](#github-actionsæµæ°´çº¿é—®é¢˜)
7. [ç¯å¢ƒå˜é‡é…ç½®é—®é¢˜](#ç¯å¢ƒå˜é‡é…ç½®é—®é¢˜)
8. [Supabaseé›†æˆé—®é¢˜](#supabaseé›†æˆé—®é¢˜)
9. [éƒ¨ç½²ç›‘æ§å’Œå‘Šè­¦](#éƒ¨ç½²ç›‘æ§å’Œå‘Šè­¦)
10. [æ•…éšœæ’é™¤æœ€ä½³å®è·µ](#æ•…éšœæ’é™¤æœ€ä½³å®è·µ)
11. [æˆåŠŸéƒ¨ç½²éªŒè¯æ–¹æ³•](#æˆåŠŸéƒ¨ç½²éªŒè¯æ–¹æ³•)
12. [æ€»ç»“](#æ€»ç»“)

## ç®€ä»‹

æœ¬æŒ‡å—åŸºäºContext7æœ€ä½³å®è·µï¼Œé’ˆå¯¹Advanced Tools Navigationé¡¹ç›®çš„éƒ¨ç½²é—®é¢˜æä¾›å…¨é¢çš„æ•…éšœæ’æŸ¥è§£å†³æ–¹æ¡ˆã€‚é¡¹ç›®é‡‡ç”¨ç°ä»£åŒ–çš„å…¨æ ˆæ¶æ„ï¼ŒåŒ…æ‹¬Vue.jså‰ç«¯ã€Supabaseæ•°æ®åº“å’ŒNetlifyéƒ¨ç½²å¹³å°ï¼Œé€šè¿‡GitHub Actionså®ç°æŒç»­é›†æˆå’Œéƒ¨ç½²ã€‚

## éƒ¨ç½²æ¶æ„æ¦‚è§ˆ

```mermaid
graph TB
subgraph "å¼€å‘ç¯å¢ƒ"
Dev[å¼€å‘è€…æœ¬åœ°]
Repo[GitHubä»“åº“]
end
subgraph "CI/CDæµæ°´çº¿"
Actions[GitHub Actions]
Workflows[éƒ¨ç½²å·¥ä½œæµ]
Secrets[GitHub Secrets]
end
subgraph "éƒ¨ç½²å¹³å°"
Netlify[Netlifyå¹³å°]
Domain[è‡ªå®šä¹‰åŸŸå]
CDN[å…¨çƒCDN]
end
subgraph "åç«¯æœåŠ¡"
Supabase[Supabaseæ•°æ®åº“]
API[REST API]
end
Dev --> Repo
Repo --> Actions
Actions --> Workflows
Workflows --> Secrets
Workflows --> Netlify
Netlify --> Domain
Netlify --> CDN
Netlify --> Supabase
Supabase --> API
```

**å›¾è¡¨æ¥æº**
- [diagnose-deployment.js](file://scripts/deployment/diagnose-deployment.js#L1-L50)
- [netlify.toml](file://netlify.toml#L1-L12)

## å¸¸éƒ¨ç½²é—®é¢˜åˆ†ç±»

### 1. æ„å»ºå¤±è´¥ç±»é—®é¢˜

- **ä¾èµ–å®‰è£…å¤±è´¥**: npmåŒ…ç‰ˆæœ¬å†²çªæˆ–ç½‘ç»œé—®é¢˜
- **æ„å»ºå‘½ä»¤é”™è¯¯**: Viteé…ç½®æˆ–æ„å»ºè„šæœ¬é—®é¢˜
- **å†…å­˜ä¸è¶³**: å¤§å‹é¡¹ç›®æ„å»ºæ—¶çš„èµ„æºé™åˆ¶

### 2. é…ç½®é”™è¯¯ç±»é—®é¢˜

- **æ ¹ç›®å½•é…ç½®é”™è¯¯**: Netlifyç«™ç‚¹è®¾ç½®ä¸­çš„æ ¹ç›®å½•è·¯å¾„
- **ç¯å¢ƒå˜é‡ç¼ºå¤±**: ç”Ÿäº§ç¯å¢ƒæ‰€éœ€çš„é…ç½®å‚æ•°
- **åŸŸåè§£æé—®é¢˜**: DNSé…ç½®æˆ–SSLè¯ä¹¦é—®é¢˜

### 3. ç½‘ç»œè¿æ¥ç±»é—®é¢˜

- **GitHub Actionsç½‘ç»œé™åˆ¶**: è®¿é—®å¤–éƒ¨æœåŠ¡çš„æƒé™
- **Supabaseè¿æ¥å¤±è´¥**: æ•°æ®åº“è®¿é—®æƒé™æˆ–ç½‘ç»œé—®é¢˜
- **CDNç¼“å­˜é—®é¢˜**: å…¨çƒCDNçš„ç¼“å­˜åŒæ­¥å»¶è¿Ÿ

### 4. æƒé™å’Œè®¤è¯ç±»é—®é¢˜

- **GitHub Tokenæƒé™ä¸è¶³**: ç¼ºå°‘repoæˆ–workflowæƒé™
- **Supabaseè®¿é—®ä»¤ç‰Œè¿‡æœŸ**: APIå¯†é’¥çš„æœ‰æ•ˆæœŸç®¡ç†
- **Netlifyéƒ¨ç½²æƒé™**: ç«™ç‚¹è®¿é—®å’Œéƒ¨ç½²æƒé™

## è¯Šæ–­è„šæœ¬è¯¦è§£

### diagnose-deployment.js - ç»¼åˆè¯Šæ–­è„šæœ¬

è¿™æ˜¯é¡¹ç›®çš„æ ¸å¿ƒè¯Šæ–­å·¥å…·ï¼ŒåŸºäºContext7æœ€ä½³å®è·µè®¾è®¡ï¼š

```javascript
// æ ¸å¿ƒè¯Šæ–­åŠŸèƒ½
async function diagnoseDeploy() {
  // 1. æ£€æŸ¥GitHub ActionsçŠ¶æ€
  const { data: runs } = await octokit.rest.actions.listWorkflowRunsForRepo({
    owner: REPO_OWNER,
    repo: REPO_NAME,
    per_page: 10,
  });

  // 2. ç½‘ç»œè¿æ¥è¯Šæ–­
  const endpoints = [
    "https://ramusi.cn",
    "https://api.github.com/zen",
    "https://api.netlify.com/api/v1/sites",
  ];

  // 3. Supabaseè¿æ¥æ£€æŸ¥
  const supabaseUrl = process.env.VITE_SUPABASE_URL;
  const supabaseKey = process.env.VITE_SUPABASE_ANON_KEY;
  
  // 4. æ„å»ºçŠ¶æ€æ£€æŸ¥
  const criticalFiles = [
    "package.json",
    "netlify.toml", 
    "dist/index.html",
    ".env.local",
  ];
}
```

**ç« èŠ‚æ¥æº**
- [diagnose-deployment.js](file://scripts/deployment/diagnose-deployment.js#L1-L169)

### verify-config-match.js - é…ç½®éªŒè¯è„šæœ¬

è¯¥è„šæœ¬ç¡®ä¿æ‰€æœ‰é…ç½®æ–‡ä»¶çš„ä¸€è‡´æ€§ï¼š

```javascript
// é¢„æœŸé…ç½®å€¼
const expectedConfig = {
  github: {
    owner: "jiayuwee",
    repo: "advanced-tools-navigation",
  },
  netlify: {
    siteId: "spiffy-torrone-5454e1",
    domain: "ramusi.cn",
  },
  supabase: {
    projectRef: "ndmxwdejswybvbwrxsai",
    url: "https://your-supabase-project.supabase.co",
  },
};
```

**ç« èŠ‚æ¥æº**
- [verify-config-match.js](file://scripts/deployment/verify-config-match.js#L1-L255)

### fix-netlify-root-directory.mjs - æ ¹ç›®å½•ä¿®å¤å·¥å…·

ä¸“é—¨è§£å†³Netlifyæ ¹ç›®å½•é…ç½®é”™è¯¯çš„é—®é¢˜ï¼š

```javascript
// ä¿®å¤æ­¥éª¤
console.log("1. ç™»å½• Netlify æ§åˆ¶å°: https://app.netlify.com/");
console.log("2. è¿›å…¥ç«™ç‚¹è®¾ç½®: https://app.netlify.com/sites/spiffy-torrone-5454e1/settings/deploys");
console.log("3. ä¿®æ”¹ä»¥ä¸‹è®¾ç½®:");
console.log("   - Base directory: ç•™ç©º (ä¸è¦å¡«å†™ä»»ä½•å€¼)");
console.log("   - Build command: npm cache clean --force && npm install --no-optional && npm run build");
console.log("   - Publish directory: dist");
```

**ç« èŠ‚æ¥æº**
- [fix-netlify-root-directory.mjs](file://scripts/deployment/fix-netlify-root-directory.mjs#L1-L122)

## Netlifyéƒ¨ç½²æ•…éšœæ’æŸ¥

### å¸¸è§Netlifyé—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

#### 1. æ ¹ç›®å½•é…ç½®é”™è¯¯

**é—®é¢˜ç—‡çŠ¶**:
```
"The specified Root Directory 'jiayuwee' does not exist"
```

**è¯Šæ–­æ­¥éª¤**:
1. æ£€æŸ¥é¡¹ç›®æ ¹ç›®å½•ç»“æ„
2. éªŒè¯netlify.tomlé…ç½®
3. ç¡®è®¤æ„å»ºå‘½ä»¤è®¾ç½®

**ä¿®å¤æ–¹æ³•**:
```bash
# 1. ä½¿ç”¨ä¿®å¤è„šæœ¬
node scripts/deployment/fix-netlify-root-directory.mjs

# 2. æ‰‹åŠ¨ä¿®æ”¹Netlifyè®¾ç½®
# Base directory: ç•™ç©º
# Build command: npm cache clean --force && npm install --no-optional && npm run build
# Publish directory: dist
```

#### 2. æ„å»ºå‘½ä»¤å¤±è´¥

**netlify.tomlé…ç½®æ£€æŸ¥**:
```toml
[build]
  command = "npm install --legacy-peer-deps --prefer-offline --no-audit --include=optional && npm run build"
  publish = "dist"

[build.environment]
  NODE_ENV = "production"
  NPM_CONFIG_INCLUDE_OPTIONAL = "true"

[context.production.environment]
  VITE_APP_ENV = "production"
```

**ç« èŠ‚æ¥æº**
- [netlify.toml](file://netlify.toml#L1-L12)
- [fix-netlify-root-directory.mjs](file://scripts/deployment/fix-netlify-root-directory.mjs#L40-L60)

#### 3. å‘å¸ƒç›®å½•é…ç½®é—®é¢˜

**æ£€æŸ¥è¦ç‚¹**:
- ç¡®è®¤distç›®å½•å­˜åœ¨
- éªŒè¯æ„å»ºè¾“å‡ºè·¯å¾„
- æ£€æŸ¥é™æ€æ–‡ä»¶ç”Ÿæˆ

### Netlifyé…ç½®éªŒè¯

ä½¿ç”¨check-netlify-config.jsè¿›è¡Œè‡ªåŠ¨åŒ–éªŒè¯ï¼š

```javascript
// æ„å»ºå‘½ä»¤æ£€æŸ¥
if (content.includes("npm ci && npm run build")) {
  console.log("âœ… æ„å»ºå‘½ä»¤æ­£ç¡®");
} else {
  console.log("âš ï¸  æ„å»ºå‘½ä»¤å¯èƒ½æœ‰é—®é¢˜");
}

// å‘å¸ƒç›®å½•æ£€æŸ¥
if (content.includes('publish = "dist"')) {
  console.log("âœ… å‘å¸ƒç›®å½•è®¾ç½®æ­£ç¡®");
} else {
  console.log("âš ï¸  å‘å¸ƒç›®å½•è®¾ç½®å¯èƒ½æœ‰é—®é¢˜");
}
```

**ç« èŠ‚æ¥æº**
- [check-netlify-config.js](file://scripts/deployment/check-netlify-config.js#L1-L111)

## GitHub Actionsæµæ°´çº¿é—®é¢˜

### å·¥ä½œæµè¯Šæ–­å’Œè§¦å‘

#### 1. å·¥ä½œæµçŠ¶æ€æ£€æŸ¥

```javascript
// è·å–å¯ç”¨çš„å·¥ä½œæµ
const { data: workflows } = await octokit.rest.actions.listRepoWorkflows({
  owner: REPO_OWNER,
  repo: REPO_NAME,
});

// é€‰æ‹©éƒ¨ç½²å·¥ä½œæµ
const supabaseWorkflow = deployWorkflows.find(
  (w) => w.name.includes("Supabase") || w.path.includes("supabase-deploy"),
);
```

**ç« èŠ‚æ¥æº**
- [trigger-deployment.js](file://scripts/deployment/trigger-deployment.js#L25-L60)

#### 2. æ‰‹åŠ¨è§¦å‘éƒ¨ç½²

ä½¿ç”¨trigger-deployment.jsè„šæœ¬ï¼š

```bash
# è®¾ç½®GitHub Token
export GITHUB_TOKEN=your_github_token

# è§¦å‘éƒ¨ç½²
node scripts/deployment/trigger-deployment.js
```

**æ•…éšœæ’é™¤æç¤º**:
- ç¡®è®¤Tokenå…·æœ‰repoå’Œworkflowæƒé™
- æ£€æŸ¥å·¥ä½œæµæ–‡ä»¶æ˜¯å¦åŒ…å«workflow_dispatch
- éªŒè¯ä»“åº“è®¿é—®æƒé™

#### 3. GitHub Actionsæ—¥å¿—åˆ†æ

ä»æä¾›çš„æ—¥å¿—æ–‡ä»¶åˆ†æï¼š

**ç³»ç»Ÿç¯å¢ƒä¿¡æ¯**:
```
Runner Image: ubuntu-24.04
Version: 20250907.24.1
Included Software: https://github.com/actions/runner-images/blob/ubuntu24/20250907.24/images/ubuntu/Ubuntu2404-Readme.md
```

**æ£€æŸ¥è¦ç‚¹**:
- Runnerç‰ˆæœ¬å…¼å®¹æ€§
- ç¯å¢ƒå˜é‡é…ç½®
- ä¾èµ–ç¼“å­˜çŠ¶æ€

**ç« èŠ‚æ¥æº**
- [run_17963096786_logs/ğŸ¯ Deploy Performance Check/system.txt](file://run_17963096786_logs/ğŸ¯ Deploy Performance Check/system.txt#L1-L5)
- [run_17963096786_logs/ğŸ¯ Deploy Performance Check/1_Set up job.txt](file://run_17963096786_logs/ğŸ¯ Deploy Performance Check/1_Set up job.txt#L1-L44)

### GitHub Secretsé…ç½®æ£€æŸ¥

#### 1. å¿…éœ€çš„Secretsåˆ—è¡¨

```javascript
const requiredSecrets = [
  {
    name: "SUPABASE_ACCESS_TOKEN",
    description: "Supabaseè®¿é—®ä»¤ç‰Œ",
    howToGet: "ä»Supabase Dashboard > Settings > API > Personal access tokensè·å–",
  },
  {
    name: "SUPABASE_PROJECT_REF", 
    description: "é¡¹ç›®å¼•ç”¨ID",
    howToGet: "ä»é¡¹ç›®URLä¸­è·å–ï¼Œæ‚¨çš„é¡¹ç›®ID: ndmxwdejswybvbwrxsai",
  },
  {
    name: "VITE_SUPABASE_URL",
    description: "é¡¹ç›®API URL",
    howToGet: "ä»Supabase Dashboard > Settings > APIè·å–",
  },
  {
    name: "VITE_SUPABASE_ANON_KEY",
    description: "é¡¹ç›®åŒ¿åå¯†é’¥",
    howToGet: "ä»Supabase Dashboard > Settings > APIè·å–",
  },
];
```

**ç« èŠ‚æ¥æº**
- [check-github-secrets.js](file://scripts/deployment/check-github-secrets.js#L10-L40)

#### 2. æœ¬åœ°è¿æ¥æµ‹è¯•

```javascript
async function testSupabaseConnection() {
  const supabase = createClient(supabaseUrl, supabaseKey);
  
  const { error } = await supabase
    .from("categories")
    .select("count")
    .limit(1);

  if (error) {
    console.error("âŒ æ•°æ®åº“è¿æ¥å¤±è´¥:", error.message);
  } else {
    console.log("âœ… æ•°æ®åº“è¿æ¥æ­£å¸¸");
  }
}
```

**ç« èŠ‚æ¥æº**
- [check-github-secrets.js](file://scripts/deployment/check-github-secrets.js#L50-L80)

## ç¯å¢ƒå˜é‡é…ç½®é—®é¢˜

### æœ¬åœ°ç¯å¢ƒå˜é‡æ£€æŸ¥

#### 1. .env.localæ–‡ä»¶éªŒè¯

```javascript
// æ£€æŸ¥å…³é”®é…ç½®
if (envContent.includes(expectedConfig.supabase.url)) {
  console.log("âœ… VITE_SUPABASE_URLé…ç½®æ­£ç¡®");
} else {
  console.log("âŒ VITE_SUPABASE_URLå¯èƒ½ä¸æ­£ç¡®");
}

// æ£€æŸ¥ç¯å¢ƒå˜é‡å®Œæ•´æ€§
if (content.includes("VITE_SUPABASE_URL") && content.includes("VITE_SUPABASE_ANON_KEY")) {
  console.log(`   - åŒ…å«å¿…è¦çš„Supabaseç¯å¢ƒå˜é‡`);
} else {
  console.log(`   - âš ï¸ ç¼ºå°‘Supabaseç¯å¢ƒå˜é‡`);
}
```

**ç« èŠ‚æ¥æº**
- [verify-config-match.js](file://scripts/deployment/verify-config-match.js#L180-L200)

#### 2. Netlifyç¯å¢ƒå˜é‡é…ç½®

**å¿…éœ€çš„ç¯å¢ƒå˜é‡**:
- `VITE_SUPABASE_URL`: Supabaseé¡¹ç›®URL
- `VITE_SUPABASE_ANON_KEY`: åŒ¿åè®¿é—®å¯†é’¥
- `NODE_ENV`: ç”Ÿäº§ç¯å¢ƒæ ‡è¯†

**é…ç½®ä½ç½®**:
- Netlifyæ§åˆ¶å°: https://app.netlify.com/sites/spiffy-torrone-5454e1/settings/env
- GitHub Secrets: https://github.com/jiayuwee/advanced-tools-navigation/settings/secrets/actions

### é…ç½®ä¸€è‡´æ€§éªŒè¯

ä½¿ç”¨verify-config-match.jsç¡®ä¿é…ç½®ä¸€è‡´æ€§ï¼š

```javascript
// é…ç½®æ–‡ä»¶æ£€æŸ¥
const configFiles = [
  {
    path: ".github/workflows/deploy.yml",
    checks: [
      { pattern: /ramusi\.cn/, expected: "ramusi.cn", description: "åŸŸåé…ç½®" },
      {
        pattern: /spiffy-torrone-5454e1/,
        expected: "spiffy-torrone-5454e1", 
        description: "Netlifyç«™ç‚¹ID",
      },
    ],
  },
  // æ›´å¤šé…ç½®æ–‡ä»¶...
];
```

**ç« èŠ‚æ¥æº**
- [verify-config-match.js](file://scripts/deployment/verify-config-match.js#L20-L80)

## Supabaseé›†æˆé—®é¢˜

### è¿æ¥è¯Šæ–­å’Œæ•…éšœæ’é™¤

#### 1. Supabaseè¿æ¥çŠ¶æ€æ£€æŸ¥

```javascript
// ç½‘ç»œè¿æ¥æµ‹è¯•
const supabaseUrl = process.env.VITE_SUPABASE_URL;
const supabaseKey = process.env.VITE_SUPABASE_ANON_KEY;

if (supabaseUrl && supabaseKey) {
  try {
    const healthCheck = await fetch(`${supabaseUrl}/rest/v1/`, {
      headers: {
        apikey: supabaseKey,
        Authorization: `Bearer ${supabaseKey}`,
      },
    });
    console.log(`âœ… Supabaseè¿æ¥: ${healthCheck.status}`);
  } catch (error) {
    console.log(`âŒ Supabaseè¿æ¥å¤±è´¥: ${error.message}`);
  }
} else {
  console.log("âš ï¸ Supabaseç¯å¢ƒå˜é‡æœªé…ç½®");
}
```

**ç« èŠ‚æ¥æº**
- [diagnose-deployment.js](file://scripts/deployment/diagnose-deployment.js#L50-L70)

#### 2. æ•°æ®åº“è¿æ¥æµ‹è¯•

```javascript
// åŸºæœ¬è¿æ¥æµ‹è¯•
const { error } = await supabase
  .from("categories")
  .select("count")
  .limit(1);

if (error) {
  console.error("âŒ æ•°æ®åº“è¿æ¥å¤±è´¥:", error.message);
} else {
  console.log("âœ… æ•°æ®åº“è¿æ¥æ­£å¸¸");
}
```

**ç« èŠ‚æ¥æº**
- [check-github-secrets.js](file://scripts/deployment/check-github-secrets.js#L60-L80)

### Supabaseé¡¹ç›®çŠ¶æ€æ£€æŸ¥

**æ£€æŸ¥é¡¹ç›®çŠ¶æ€**:
1. ç¡®è®¤é¡¹ç›®çŠ¶æ€ä¸º"Active"
2. éªŒè¯é¡¹ç›®å¼•ç”¨IDæ­£ç¡®æ€§
3. æ£€æŸ¥è®¿é—®ä»¤ç‰Œæƒé™
4. æµ‹è¯•æ•°æ®åº“è¿æ¥

**ç›¸å…³é“¾æ¥**:
- Supabase Dashboard: https://supabase.com/dashboard/project/ndmxwdejswybvbwrxsai
- é¡¹ç›®Issues: https://github.com/jiayuwee/advanced-tools-navigation/issues

## éƒ¨ç½²ç›‘æ§å’Œå‘Šè­¦

### monitor-deployment.js - å®æ—¶ç›‘æ§ç³»ç»Ÿ

#### 1. ç›‘æ§æ£€æŸ¥é¡¹

```javascript
const healthChecks = [
  {
    name: "ç½‘ç«™å¯è®¿é—®æ€§",
    check: checkSiteHealth,
    critical: true,
  },
  {
    name: "GitHub ActionsçŠ¶æ€", 
    check: checkGitHubActions,
    critical: false,
  },
  {
    name: "Supabaseæ•°æ®åº“",
    check: checkSupabaseHealth,
    critical: true,
  },
];
```

**ç« èŠ‚æ¥æº**
- [monitor-deployment.js](file://scripts/deployment/monitor-deployment.js#L30-L50)

#### 2. å¥åº·æ£€æŸ¥å®ç°

```javascript
async function checkSiteHealth() {
  try {
    const response = await fetch(SITE_URL, {
      method: "HEAD",
      signal: controller.signal,
    });

    if (!response.ok) {
      throw new Error(`HTTP ${response.status}: ${response.statusText}`);
    }

    return {
      status: "healthy",
      message: `ç½‘ç«™æ­£å¸¸å“åº” (${response.status})`,
      responseTime: Date.now() - lastCheckTime,
    };
  } catch (error) {
    return {
      status: "unhealthy",
      message: `ç½‘ç«™è®¿é—®å¤±è´¥: ${error.message}`,
      error: error.message,
    };
  }
}
```

**ç« èŠ‚æ¥æº**
- [monitor-deployment.js](file://scripts/deployment/monitor-deployment.js#L50-L80)

#### 3. å‘Šè­¦æœºåˆ¶

```javascript
async function triggerAlert(results, criticalFailures) {
  console.log("ğŸš¨ è§¦å‘å‘Šè­¦ï¼");
  console.log(`å…³é”®æœåŠ¡å¤±è´¥æ•°: ${criticalFailures}`);
  console.log(`è¿ç»­å¤±è´¥æ¬¡æ•°: ${failureCount}`);
  
  console.log("ğŸ”§ å»ºè®®çš„å¤„ç†æ­¥éª¤:");
  console.log("1. æ£€æŸ¥ç½‘ç«™æ˜¯å¦å¯ä»¥æ­£å¸¸è®¿é—®");
  console.log("2. æŸ¥çœ‹GitHub Actionså·¥ä½œæµçŠ¶æ€");
  console.log("3. æ£€æŸ¥Supabaseé¡¹ç›®çŠ¶æ€");
  console.log("4. æŸ¥çœ‹Netlifyéƒ¨ç½²æ—¥å¿—");
}
```

**ç« èŠ‚æ¥æº**
- [monitor-deployment.js](file://scripts/deployment/monitor-deployment.js#L200-L250)

### ç›‘æ§é…ç½®é€‰é¡¹

```javascript
const monitorConfig = {
  checkInterval: 5 * 60 * 1000, // 5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
  maxFailures: 3, // è¿ç»­å¤±è´¥3æ¬¡åå‘Šè­¦
  timeout: 30000, // 30ç§’è¶…æ—¶
};
```

**ç« èŠ‚æ¥æº**
- [monitor-deployment.js](file://scripts/deployment/monitor-deployment.js#L25-L30)

## æ•…éšœæ’é™¤æœ€ä½³å®è·µ

### Context7æœ€ä½³å®è·µæ–¹æ³•è®º

#### 1. é—®é¢˜åˆ†ç±»å’Œä¼˜å…ˆçº§

```mermaid
flowchart TD
Start[å‘ç°é—®é¢˜] --> Classify{é—®é¢˜åˆ†ç±»}
Classify --> |ç½‘ç»œè¿æ¥| Network[ç½‘ç»œè¯Šæ–­]
Classify --> |é…ç½®é”™è¯¯| Config[é…ç½®æ£€æŸ¥]
Classify --> |æƒé™é—®é¢˜| Auth[æƒé™éªŒè¯]
Classify --> |æ„å»ºå¤±è´¥| Build[æ„å»ºè¯Šæ–­]
Network --> NetworkFix[ä¿®å¤ç½‘ç»œé—®é¢˜]
Config --> ConfigFix[ä¿®æ­£é…ç½®]
Auth --> AuthFix[æ›´æ–°æƒé™]
Build --> BuildFix[è§£å†³æ„å»ºé—®é¢˜]
NetworkFix --> Verify[éªŒè¯ä¿®å¤]
ConfigFix --> Verify
AuthFix --> Verify
BuildFix --> Verify
Verify --> Success{ä¿®å¤æˆåŠŸ?}
Success --> |æ˜¯| Monitor[éƒ¨ç½²ç›‘æ§]
Success --> |å¦| Escalate[å‡çº§å¤„ç†]
```

**å›¾è¡¨æ¥æº**
- [diagnose-deployment.js](file://scripts/deployment/diagnose-deployment.js#L100-L150)

#### 2. é€æ­¥è¯Šæ–­æµç¨‹

**å¿«é€Ÿä¿®å¤è„šæœ¬**:
```javascript
// Context7å¿«é€Ÿä¿®å¤æ–¹æ³•
console.log("æ­¥éª¤ 1: æ£€æŸ¥Netlifyç«™ç‚¹çŠ¶æ€");
console.log("æ­¥éª¤ 2: éªŒè¯åŸŸåé…ç½®");
console.log("æ­¥éª¤ 3: æ£€æŸ¥æ„å»ºé…ç½®");
console.log("æ­¥éª¤ 4: æµ‹è¯•æœ¬åœ°æ„å»º");
```

**ç« èŠ‚æ¥æº**
- [quick-fix-deployment.js](file://scripts/deployment/quick-fix-deployment.js#L10-L40)

#### 3. å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ

**é—®é¢˜A: åŸŸåæœªæ­£ç¡®é…ç½®**
```bash
# è§£å†³æ–¹æ¡ˆ
1. åœ¨Netlifyä¸­æ·»åŠ è‡ªå®šä¹‰åŸŸå ramusi.cn
2. æŒ‰ç…§Netlifyæä¾›çš„DNSè®°å½•é…ç½®æ‚¨çš„åŸŸå
3. ç­‰å¾…DNSä¼ æ’­ï¼ˆå¯èƒ½éœ€è¦å‡ å°æ—¶ï¼‰
```

**é—®é¢˜B: SSLè¯ä¹¦é—®é¢˜**
```bash
# è§£å†³æ–¹æ¡ˆ
1. åœ¨NetlifyåŸŸåè®¾ç½®ä¸­å¯ç”¨ 'Force HTTPS'
2. ç­‰å¾…Let's Encryptè¯ä¹¦è‡ªåŠ¨é…ç½®
3. å¦‚æœå¤±è´¥ï¼Œå°è¯•é‡æ–°ç”Ÿæˆè¯ä¹¦
```

**é—®é¢˜C: æ„å»ºå¤±è´¥**
```bash
# è§£å†³æ–¹æ¡ˆ
1. æ£€æŸ¥Netlifyæ„å»ºæ—¥å¿—
2. ç¡®è®¤æ‰€æœ‰ç¯å¢ƒå˜é‡å·²è®¾ç½®
3. éªŒè¯package.jsonå’Œnetlify.tomlé…ç½®
```

**ç« èŠ‚æ¥æº**
- [quick-fix-deployment.js](file://scripts/deployment/quick-fix-deployment.js#L50-L90)

### ç´§æ€¥å¤‡ç”¨æ–¹æ¡ˆ

**ä¸´æ—¶ä¸Šçº¿æ–¹æ¡ˆ**:
1. ä½¿ç”¨Netlifyæä¾›çš„é»˜è®¤åŸŸå (xxx.netlify.app)
2. ç¨åé…ç½®è‡ªå®šä¹‰åŸŸå
3. æˆ–è€ƒè™‘ä½¿ç”¨å…¶ä»–éƒ¨ç½²å¹³å° (Vercel, GitHub Pages)

**ç« èŠ‚æ¥æº**
- [quick-fix-deployment.js](file://scripts/deployment/quick-fix-deployment.js#L80-L90)

## æˆåŠŸéƒ¨ç½²éªŒè¯æ–¹æ³•

### éƒ¨ç½²éªŒè¯æ¸…å•

#### 1. åŸºç¡€åŠŸèƒ½éªŒè¯

```javascript
// éƒ¨ç½²éªŒè¯æ£€æŸ¥
const verificationSteps = [
  {
    name: "ç½‘ç«™å¯è®¿é—®æ€§",
    check: async () => {
      const response = await fetch(SITE_URL);
      return response.ok;
    },
  },
  {
    name: "æ ¸å¿ƒé¡µé¢åŠ è½½",
    check: async () => {
      const homeResponse = await fetch(`${SITE_URL}/`);
      const productResponse = await fetch(`${SITE_URL}/products`);
      return homeResponse.ok && productResponse.ok;
    },
  },
  {
    name: "APIè¿æ¥æµ‹è¯•",
    check: async () => {
      const apiResponse = await fetch(`${SITE_URL}/api/status`);
      return apiResponse.ok;
    },
  },
];
```

#### 2. åŠŸèƒ½å®Œæ•´æ€§æµ‹è¯•

**å…³é”®åŠŸèƒ½æµ‹è¯•**:
1. ç”¨æˆ·ç™»å½•/æ³¨å†Œ
2. äº§å“æµè§ˆå’Œæœç´¢
3. è´­ç‰©è½¦åŠŸèƒ½
4. æ”¯ä»˜æµç¨‹
5. Supabaseæ•°æ®äº¤äº’

#### 3. æ€§èƒ½æŒ‡æ ‡æ£€æŸ¥

**æ€§èƒ½åŸºå‡†**:
- é¦–é¡µåŠ è½½æ—¶é—´ < 2ç§’
- å…³é”®èµ„æºåŠ è½½ < 1ç§’
- SEOå…ƒæ ‡ç­¾æ­£ç¡®è®¾ç½®
- PWAåŠŸèƒ½æ­£å¸¸

### éƒ¨ç½²åç›‘æ§

**ç›‘æ§æŒ‡æ ‡**:
- ç½‘ç«™å¯ç”¨æ€§ (99.9%)
- å“åº”æ—¶é—´ (< 3ç§’)
- é”™è¯¯ç‡ (< 1%)
- é¦–å±åŠ è½½æ—¶é—´

**å‘Šè­¦é˜ˆå€¼**:
- è¿ç»­3æ¬¡å¤±è´¥è§¦å‘å‘Šè­¦
- å“åº”æ—¶é—´è¶…è¿‡5ç§’è­¦å‘Š
- 4xx/5xxé”™è¯¯ç‡è¶…è¿‡5%

**ç« èŠ‚æ¥æº**
- [monitor-deployment.js](file://scripts/deployment/monitor-deployment.js#L25-L35)

## æ€»ç»“

æœ¬éƒ¨ç½²æ•…éšœæ’æŸ¥æŒ‡å—åŸºäºAdvanced Tools Navigationé¡¹ç›®çš„å®é™…ç»éªŒï¼Œæä¾›äº†å®Œæ•´çš„æ•…éšœæ’é™¤æ¡†æ¶å’Œå®ç”¨å·¥å…·ã€‚é€šè¿‡åˆç†è¿ç”¨å„ç§è¯Šæ–­è„šæœ¬å’Œç›‘æ§å·¥å…·ï¼Œå¯ä»¥å¿«é€Ÿå®šä½å’Œè§£å†³éƒ¨ç½²è¿‡ç¨‹ä¸­çš„å„ç±»é—®é¢˜ã€‚

### å…³é”®è¦ç‚¹å›é¡¾

1. **é¢„é˜²ä¸ºä¸»**: ä½¿ç”¨verify-config-match.jsç¡®ä¿é…ç½®ä¸€è‡´æ€§
2. **å¿«é€Ÿè¯Šæ–­**: åˆ©ç”¨diagnose-deployment.jsè¿›è¡Œç»¼åˆé—®é¢˜è¯†åˆ«
3. **ç²¾å‡†ä¿®å¤**: é€šè¿‡fix-netlify-root-directory.mjsè§£å†³ç‰¹å®šé…ç½®é—®é¢˜
4. **å®æ—¶ç›‘æ§**: å€ŸåŠ©monitor-deployment.jså»ºç«‹ä¸»åŠ¨ç›‘æ§ä½“ç³»
5. **æŒç»­æ”¹è¿›**: åŸºäºContext7æœ€ä½³å®è·µä¸æ–­å®Œå–„éƒ¨ç½²æµç¨‹

### ä¸‹ä¸€æ­¥è¡ŒåŠ¨å»ºè®®

1. **é…ç½®æ£€æŸ¥**: è¿è¡Œverify-config-match.jséªŒè¯æ‰€æœ‰é…ç½®
2. **ç¯å¢ƒå‡†å¤‡**: ç¡®ä¿GitHub Secretså’Œç¯å¢ƒå˜é‡æ­£ç¡®è®¾ç½®
3. **ç›‘æ§éƒ¨ç½²**: å¯åŠ¨monitor-deployment.jsè¿›è¡Œå®æ—¶ç›‘æ§
4. **æ–‡æ¡£ç»´æŠ¤**: å®šæœŸæ›´æ–°æ•…éšœæ’é™¤çŸ¥è¯†åº“