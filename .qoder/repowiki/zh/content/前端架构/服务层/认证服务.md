# è®¤è¯æœåŠ¡æŠ€æœ¯æ–‡æ¡£

<cite>
**æœ¬æ–‡æ¡£å¼•ç”¨çš„æ–‡ä»¶**
- [authService.ts](file://src/services/authService.ts)
- [auth.ts](file://src/stores/auth.ts)
- [supabaseClient.ts](file://src/lib/supabaseClient.ts)
- [errorHandler.ts](file://src/utils/errorHandler.ts)
- [index.ts](file://src/types/index.ts)
- [LoginForm.vue](file://src/components/auth/LoginForm.vue)
- [RegisterView.vue](file://src/views/auth/RegisterView.vue)
- [ForgotPasswordView.vue](file://src/views/auth/ForgotPasswordView.vue)
- [LoginView.vue](file://src/views/auth/LoginView.vue)
</cite>

## ç›®å½•
1. [ç®€ä»‹](#ç®€ä»‹)
2. [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
3. [æ ¸å¿ƒç»„ä»¶](#æ ¸å¿ƒç»„ä»¶)
4. [æ¶æ„æ¦‚è§ˆ](#æ¶æ„æ¦‚è§ˆ)
5. [è¯¦ç»†ç»„ä»¶åˆ†æ](#è¯¦ç»†ç»„ä»¶åˆ†æ)
6. [ä¾èµ–å…³ç³»åˆ†æ](#ä¾èµ–å…³ç³»åˆ†æ)
7. [æ€§èƒ½è€ƒè™‘](#æ€§èƒ½è€ƒè™‘)
8. [æ•…éšœæ’é™¤æŒ‡å—](#æ•…éšœæ’é™¤æŒ‡å—)
9. [ç»“è®º](#ç»“è®º)

## ç®€ä»‹

è®¤è¯æœåŠ¡æ˜¯Advanced Tools Navigationåº”ç”¨çš„æ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£å¤„ç†ç”¨æˆ·èº«ä»½éªŒè¯ã€ä¼šè¯ç®¡ç†å’Œå®‰å…¨é˜²æŠ¤ã€‚è¯¥æœåŠ¡åŸºäºSupabaseå¹³å°æ„å»ºï¼Œæä¾›äº†å®Œæ•´çš„ç”¨æˆ·è®¤è¯è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬æœ¬åœ°ç™»å½•æ³¨å†Œã€ç¬¬ä¸‰æ–¹OAuthç™»å½•ã€å¯†ç é‡ç½®å’Œé‚®ç®±éªŒè¯ç­‰åŠŸèƒ½ã€‚

è®¤è¯æœåŠ¡é‡‡ç”¨ç°ä»£åŒ–çš„æ¶æ„è®¾è®¡ï¼Œç»“åˆäº†PiniaçŠ¶æ€ç®¡ç†ã€TypeScriptç±»å‹å®‰å…¨å’Œé”™è¯¯å¤„ç†æœºåˆ¶ï¼Œç¡®ä¿äº†ç³»ç»Ÿçš„å¯é æ€§ã€å¯ç»´æŠ¤æ€§å’Œå®‰å…¨æ€§ã€‚

## é¡¹ç›®ç»“æ„

è®¤è¯æœåŠ¡ç›¸å…³çš„æ–‡ä»¶ç»„ç»‡ç»“æ„å¦‚ä¸‹ï¼š

```mermaid
graph TB
subgraph "è®¤è¯æœåŠ¡æ¨¡å—"
A[authService.ts] --> B[Pinia Auth Store]
A --> C[Supabase Client]
A --> D[é”™è¯¯å¤„ç†å™¨]
B --> E[ç”¨æˆ·çŠ¶æ€ç®¡ç†]
C --> F[Supabase Auth API]
D --> G[ç»Ÿä¸€é”™è¯¯å¤„ç†]
end
subgraph "è§†å›¾å±‚"
H[LoginView.vue] --> A
I[RegisterView.vue] --> A
J[ForgotPasswordView.vue] --> A
K[LoginForm.vue] --> A
end
subgraph "ç±»å‹å®šä¹‰"
L[index.ts] --> M[è®¤è¯æ¥å£ç±»å‹]
N[supabase.ts] --> O[Supabaseç±»å‹]
end
```

**å›¾è¡¨æ¥æº**
- [authService.ts](file://src/services/authService.ts#L1-L306)
- [auth.ts](file://src/stores/auth.ts#L1-L190)

**ç« èŠ‚æ¥æº**
- [authService.ts](file://src/services/authService.ts#L1-L306)
- [auth.ts](file://src/stores/auth.ts#L1-L190)

## æ ¸å¿ƒç»„ä»¶

### AuthService ç±»

AuthService æ˜¯è®¤è¯æœåŠ¡çš„æ ¸å¿ƒç±»ï¼Œæä¾›äº†æ‰€æœ‰ç”¨æˆ·è®¤è¯ç›¸å…³çš„æ“ä½œï¼š

- **ç™»å½•åŠŸèƒ½**ï¼šæ”¯æŒé‚®ç®±å¯†ç ç™»å½•
- **æ³¨å†ŒåŠŸèƒ½**ï¼šæ”¯æŒç”¨æˆ·æ³¨å†Œå’Œèµ„æ–™åˆ›å»º
- **ä¼šè¯ç®¡ç†**ï¼šåŒ…æ‹¬ä¼šè¯è·å–ã€åˆ·æ–°å’Œæ³¨é”€
- **å¯†ç ç®¡ç†**ï¼šå¿˜è®°å¯†ç ã€é‡ç½®å¯†ç å’Œæ›´æ”¹å¯†ç 
- **ç¬¬ä¸‰æ–¹ç™»å½•**ï¼šé›†æˆGoogleå’ŒGitHub OAuth
- **å®‰å…¨åŠŸèƒ½**ï¼šé‚®ç®±éªŒè¯ã€è´¦æˆ·åˆ é™¤å’Œå®‰å…¨é˜²æŠ¤

### Pinia Auth Store

Pinia Auth Store æä¾›äº†å“åº”å¼çš„ç”¨æˆ·çŠ¶æ€ç®¡ç†ï¼š

- **çŠ¶æ€ç®¡ç†**ï¼šè·Ÿè¸ªç”¨æˆ·ç™»å½•çŠ¶æ€ã€åŠ è½½çŠ¶æ€å’Œé”™è¯¯ä¿¡æ¯
- **è®¡ç®—å±æ€§**ï¼šæä¾›ç”¨æˆ·è®¤è¯çŠ¶æ€å’Œç®¡ç†å‘˜æƒé™æ£€æŸ¥
- **å¼‚æ­¥æ“ä½œ**ï¼šå°è£…è®¤è¯ç›¸å…³çš„å¼‚æ­¥æ“ä½œ
- **å®æ—¶ç›‘å¬**ï¼šç›‘å¬Supabaseè®¤è¯çŠ¶æ€å˜åŒ–

**ç« èŠ‚æ¥æº**
- [authService.ts](file://src/services/authService.ts#L15-L306)
- [auth.ts](file://src/stores/auth.ts#L15-L190)

## æ¶æ„æ¦‚è§ˆ

è®¤è¯æœåŠ¡é‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ï¼Œç¡®ä¿äº†ä»£ç çš„æ¨¡å—åŒ–å’Œå¯ç»´æŠ¤æ€§ï¼š

```mermaid
sequenceDiagram
participant U as ç”¨æˆ·
participant V as è§†å›¾ç»„ä»¶
participant S as AuthService
participant P as Pinia Store
participant SC as Supabase Client
participant DB as æ•°æ®åº“
U->>V : æäº¤ç™»å½•è¡¨å•
V->>S : AuthService.login()
S->>SC : supabase.auth.signInWithPassword()
SC->>DB : éªŒè¯ç”¨æˆ·å‡­æ®
DB-->>SC : è¿”å›ç”¨æˆ·ä¿¡æ¯
SC-->>S : è¿”å›è®¤è¯ç»“æœ
S->>S : æ›´æ–°æœ€åç™»å½•æ—¶é—´
S->>S : è·å–ç”¨æˆ·èµ„æ–™
S-->>V : è¿”å›ç”¨æˆ·å’Œä¼šè¯
V->>P : store.initialize()
P->>SC : ç›‘å¬è®¤è¯çŠ¶æ€å˜åŒ–
SC-->>P : è§¦å‘çŠ¶æ€æ›´æ–°
P-->>U : æ›´æ–°å…¨å±€çŠ¶æ€
```

**å›¾è¡¨æ¥æº**
- [authService.ts](file://src/services/authService.ts#L15-L48)
- [auth.ts](file://src/stores/auth.ts#L73-L113)

## è¯¦ç»†ç»„ä»¶åˆ†æ

### AuthService å®ç°åˆ†æ

AuthService é‡‡ç”¨äº†é™æ€æ–¹æ³•è®¾è®¡æ¨¡å¼ï¼Œæä¾›äº†å®Œæ•´çš„è®¤è¯APIå°è£…ï¼š

```mermaid
classDiagram
class AuthService {
-performance : PerformanceService
+login(credentials : LoginForm) Promise~AuthResult~
+register(userData : RegisterForm) Promise~AuthResult~
+logout() Promise~void~
+forgotPassword(email : string) Promise~void~
+resetPassword(newPassword : string) Promise~void~
+changePassword(newPassword : string) Promise~void~
+updateEmail(newEmail : string) Promise~void~
+verifyEmail(token : string, type : string) Promise~void~
+resendVerificationEmail() Promise~void~
+getSession() Promise~AuthSession~
+refreshSession() Promise~any~
+isAuthenticated() Promise~boolean~
+onAuthStateChange(callback : Function) Subscription
+signInWithGoogle() Promise~void~
+signInWithGitHub() Promise~void~
+deleteAccount() Promise~void~
}
class ErrorHandler {
+handleApiError(error : unknown) AppError
+logError(error : AppError, context? : string) void
+createError(code : string, message : string, details? : unknown) AppError
}
class UserService {
+updateLastLogin(userId : string) Promise~void~
+getCurrentUser() Promise~User~
+createUserProfile(userId : string, email : string) Promise~User~
+updateProfile(userId : string, data : object) Promise~User~
+checkUsernameAvailability(username : string) Promise~boolean~
+deleteAccount(userId : string) Promise~void~
}
AuthService --> ErrorHandler : "ä½¿ç”¨"
AuthService --> UserService : "ä¾èµ–"
AuthService --> SupabaseClient : "è°ƒç”¨"
```

**å›¾è¡¨æ¥æº**
- [authService.ts](file://src/services/authService.ts#L15-L306)
- [errorHandler.ts](file://src/utils/errorHandler.ts#L1-L331)

#### ç™»å½•æµç¨‹å®ç°

ç™»å½•åŠŸèƒ½çš„å®ç°å±•ç¤ºäº†å®Œæ•´çš„è®¤è¯æµç¨‹ï¼š

```typescript
static async login(
  credentials: LoginForm,
): Promise<{ user: User; session: AuthSession }> {
  try {
    const { data, error } = await supabase.auth.signInWithPassword({
      email: credentials.email,
      password: credentials.password,
    });

    if (error) throw error;
    if (!data.user) throw new Error("ç™»å½•å¤±è´¥");

    // æ›´æ–°æœ€åç™»å½•æ—¶é—´
    await UserService.updateLastLogin(data.user.id);

    // è·å–ç”¨æˆ·èµ„æ–™
    const userProfile = await UserService.getCurrentUser();
    if (!userProfile) throw new Error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥");

    return {
      user: userProfile,
      session: data.session,
    };
  } catch (error) {
    const appError = ErrorHandler.handleApiError(error);
    ErrorHandler.logError(appError, "AuthService.login");
    throw appError;
  }
}
```

#### æ³¨å†Œæµç¨‹å®ç°

æ³¨å†ŒåŠŸèƒ½åŒ…å«äº†ç”¨æˆ·åæ£€æŸ¥ã€ç”¨æˆ·èµ„æ–™åˆ›å»ºå’Œä¼šè¯ç®¡ç†ï¼š

```typescript
static async register(
  userData: RegisterForm,
): Promise<{ user: User; session: AuthSession }> {
  try {
    // æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å¯ç”¨
    if (userData.username) {
      const isUsernameAvailable = await UserService.checkUsernameAvailability(
        userData.username,
      );
      if (!isUsernameAvailable) {
        throw new Error("ç”¨æˆ·åå·²è¢«ä½¿ç”¨");
      }
    }

    const { data, error } = await supabase.auth.signUp({
      email: userData.email,
      password: userData.password,
      options: {
        data: {
          full_name: userData.full_name,
          username: userData.username,
        },
      },
    });

    if (error) throw error;
    if (!data.user) throw new Error("æ³¨å†Œå¤±è´¥");

    // åˆ›å»ºç”¨æˆ·èµ„æ–™
    const userProfile = await UserService.createUserProfile(
      data.user.id,
      userData.email,
    );

    return {
      user: userProfile,
      session: data.session,
    };
  } catch (error) {
    const appError = ErrorHandler.handleApiError(error);
    ErrorHandler.logError(appError, "AuthService.register");
    throw appError;
  }
}
```

**ç« èŠ‚æ¥æº**
- [authService.ts](file://src/services/authService.ts#L15-L141)

### Pinia Auth Store åˆ†æ

Pinia Auth Store æä¾›äº†å“åº”å¼çš„çŠ¶æ€ç®¡ç†ï¼š

```mermaid
stateDiagram-v2
[*] --> Uninitialized
Uninitialized --> Initializing : initialize()
Initializing --> Loading : å¼€å§‹åŠ è½½ç”¨æˆ·èµ„æ–™
Loading --> Loaded : åŠ è½½æˆåŠŸ
Loading --> Error : åŠ è½½å¤±è´¥
Loaded --> Authenticating : onAuthStateChange
Authenticating --> Authenticated : ç™»å½•æˆåŠŸ
Authenticating --> Unauthenticated : ç™»å‡º
Authenticated --> Loading : ç”¨æˆ·èµ„æ–™æ›´æ–°
Unauthenticated --> Loading : é‡æ–°ç™»å½•
Error --> Loading : é‡è¯•
Authenticated --> Deleting : deleteAccount()
Deleting --> Unauthenticated : åˆ é™¤å®Œæˆ
```

**å›¾è¡¨æ¥æº**
- [auth.ts](file://src/stores/auth.ts#L73-L113)

#### çŠ¶æ€ç®¡ç†å®ç°

Store çš„æ ¸å¿ƒçŠ¶æ€ç®¡ç†é€»è¾‘ï¼š

```typescript
function initialize() {
  if (initialized.value) return;

  loading.value = true;
  console.log("ğŸ” åˆå§‹åŒ–Supabaseè®¤è¯ç›‘å¬...");

  const { data: { subscription } } = supabase.auth.onAuthStateChange(async (event, session) => {
    console.log(`ğŸ”‘ è®¤è¯çŠ¶æ€å˜æ›´: ${event}`, session);
    
    if (session?.user) {
      console.log("ğŸ”„ è·å–ç”¨æˆ·èµ„æ–™...");
      const profile = await fetchUserProfile(session.user.id);
      
      if (profile) {
        user.value = {
          ...session.user,
          username: profile.username || "æœªè®¾ç½®ç”¨æˆ·å",
          avatar_url: profile.avatar_url || "",
          role: profile.role || "user",
        };
        console.log("âœ… ç”¨æˆ·èµ„æ–™åŠ è½½å®Œæˆ", user.value);
      } else {
        user.value = {
          ...session.user,
          username: session.user.email || "æ–°ç”¨æˆ·",
          avatar_url: "",
          role: "user",
        };
        console.log("âš ï¸ ä½¿ç”¨åŸºç¡€ç”¨æˆ·ä¿¡æ¯", user.value);
      }
    } else {
      user.value = null;
      console.log("ğŸšª ç”¨æˆ·å·²ç™»å‡º");
    }
    
    initialized.value = true;
    loading.value = false;
  });

  // æ·»åŠ å¸è½½æ—¶æ¸…ç†
  onScopeDispose(() => {
    subscription?.unsubscribe();
  });
}
```

**ç« èŠ‚æ¥æº**
- [auth.ts](file://src/stores/auth.ts#L73-L113)

### ç¬¬ä¸‰æ–¹ç™»å½•é›†æˆ

ç³»ç»Ÿæ”¯æŒGoogleå’ŒGitHub OAuthç™»å½•ï¼š

```mermaid
flowchart TD
A[ç”¨æˆ·é€‰æ‹©ç¬¬ä¸‰æ–¹ç™»å½•] --> B{é€‰æ‹©æä¾›å•†}
B --> |Google| C[è·³è½¬åˆ°Googleæˆæƒé¡µé¢]
B --> |GitHub| D[è·³è½¬åˆ°GitHubæˆæƒé¡µé¢]
C --> E[ç”¨æˆ·æˆæƒ]
D --> E
E --> F[å›è°ƒåˆ°åº”ç”¨]
F --> G[éªŒè¯æˆæƒç ]
G --> H{éªŒè¯æˆåŠŸ?}
H --> |æ˜¯| I[åˆ›å»ºæˆ–æ›´æ–°ç”¨æˆ·]
H --> |å¦| J[æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯]
I --> K[åˆå§‹åŒ–ç”¨æˆ·çŠ¶æ€]
K --> L[é‡å®šå‘åˆ°é¦–é¡µ]
J --> M[ç”¨æˆ·é‡è¯•]
M --> A
```

**å›¾è¡¨æ¥æº**
- [authService.ts](file://src/services/authService.ts#L249-L276)

**ç« èŠ‚æ¥æº**
- [authService.ts](file://src/services/authService.ts#L249-L276)

### JWTä»¤ç‰Œå¤„ç†

è®¤è¯æœåŠ¡é€šè¿‡Supabaseè‡ªåŠ¨å¤„ç†JWTä»¤ç‰Œçš„ç”Ÿæˆã€å­˜å‚¨å’Œåˆ·æ–°ï¼š

- **ä»¤ç‰Œç”Ÿæˆ**ï¼šç™»å½•æˆåŠŸåè‡ªåŠ¨è·å–è®¿é—®ä»¤ç‰Œå’Œåˆ·æ–°ä»¤ç‰Œ
- **è‡ªåŠ¨åˆ·æ–°**ï¼šç³»ç»Ÿä¼šè‡ªåŠ¨å¤„ç†ä»¤ç‰Œè¿‡æœŸå’Œåˆ·æ–°
- **å®‰å…¨å­˜å‚¨**ï¼šä»¤ç‰Œå®‰å…¨å­˜å‚¨åœ¨æµè§ˆå™¨ä¸­
- **è¿‡æœŸå¤„ç†**ï¼šè‡ªåŠ¨æ£€æµ‹ä»¤ç‰Œè¿‡æœŸå¹¶è§¦å‘åˆ·æ–°æœºåˆ¶

### å®‰å…¨é˜²æŠ¤æªæ–½

#### CSRFé˜²æŠ¤

ç³»ç»Ÿé€šè¿‡ä»¥ä¸‹æ–¹å¼é˜²èŒƒCSRFæ”»å‡»ï¼š

- **SameSite Cookie**ï¼šè®¾ç½®é€‚å½“çš„Cookie SameSiteå±æ€§
- **OriginéªŒè¯**ï¼šéªŒè¯è¯·æ±‚çš„Originå¤´
- **Refereræ£€æŸ¥**ï¼šæ£€æŸ¥Refererå¤´çš„æœ‰æ•ˆæ€§
- **TokenéªŒè¯**ï¼šä½¿ç”¨CSRF Tokenè¿›è¡ŒåŒé‡éªŒè¯

#### XSSé˜²æŠ¤

XSSé˜²æŠ¤æªæ–½åŒ…æ‹¬ï¼š

- **å†…å®¹å®‰å…¨ç­–ç•¥**ï¼šè®¾ç½®ä¸¥æ ¼çš„CSPå¤´
- **è¾“å…¥éªŒè¯**ï¼šå¯¹æ‰€æœ‰ç”¨æˆ·è¾“å…¥è¿›è¡Œä¸¥æ ¼éªŒè¯
- **è¾“å‡ºç¼–ç **ï¼šå¯¹HTMLè¾“å‡ºè¿›è¡Œé€‚å½“ç¼–ç 
- **Sanitization**ï¼šä½¿ç”¨DOM Purifyç­‰åº“æ¸…ç†HTMLå†…å®¹

#### é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

é”™è¯¯å¤„ç†æœºåˆ¶ç¡®ä¿äº†ç³»ç»Ÿçš„å®‰å…¨æ€§å’Œå¯ç»´æŠ¤æ€§ï¼š

```typescript
// ç»Ÿä¸€é”™è¯¯å¤„ç†
static handleApiError(error: unknown): AppError {
  if (isAxiosError(error)) {
    const status = error.response?.status;
    switch (status) {
      case 401:
        return this.createError("UNAUTHORIZED", "æœªæˆæƒè®¿é—®ï¼Œè¯·é‡æ–°ç™»å½•", data);
      case 403:
        return this.createError("FORBIDDEN", "æƒé™ä¸è¶³ï¼Œæ— æ³•è®¿é—®", data);
      // ... å…¶ä»–é”™è¯¯å¤„ç†
    }
  }
  // ... å…¶ä»–é”™è¯¯ç±»å‹å¤„ç†
}
```

**ç« èŠ‚æ¥æº**
- [errorHandler.ts](file://src/utils/errorHandler.ts#L50-L120)

## ä¾èµ–å…³ç³»åˆ†æ

è®¤è¯æœåŠ¡çš„ä¾èµ–å…³ç³»å±•ç°äº†æ¸…æ™°çš„åˆ†å±‚æ¶æ„ï¼š

```mermaid
graph LR
subgraph "å¤–éƒ¨ä¾èµ–"
A[Supabase JS SDK]
B[Pinia]
C[Vue 3]
D[TypeScript]
end
subgraph "å†…éƒ¨æ¨¡å—"
E[AuthService]
F[Auth Store]
G[Error Handler]
H[User Service]
I[Supabase Client]
end
subgraph "ç±»å‹å®šä¹‰"
J[è®¤è¯æ¥å£ç±»å‹]
K[ç”¨æˆ·ç±»å‹]
L[ä¼šè¯ç±»å‹]
end
E --> A
E --> H
E --> G
F --> B
F --> A
F --> I
G --> J
H --> I
I --> A
E -.-> J
F -.-> K
F -.-> L
```

**å›¾è¡¨æ¥æº**
- [authService.ts](file://src/services/authService.ts#L1-L10)
- [auth.ts](file://src/stores/auth.ts#L1-L10)

**ç« èŠ‚æ¥æº**
- [authService.ts](file://src/services/authService.ts#L1-L10)
- [auth.ts](file://src/stores/auth.ts#L1-L10)

## æ€§èƒ½è€ƒè™‘

### ä¼šè¯ç®¡ç†ä¼˜åŒ–

- **è‡ªåŠ¨åˆ·æ–°**ï¼šæ™ºèƒ½çš„ä»¤ç‰Œè‡ªåŠ¨åˆ·æ–°æœºåˆ¶ï¼Œå‡å°‘ç”¨æˆ·æ‰‹åŠ¨åˆ·æ–°çš„é¢‘ç‡
- **ç¼“å­˜ç­–ç•¥**ï¼šåˆç†ä½¿ç”¨æµè§ˆå™¨ç¼“å­˜å’Œå†…å­˜ç¼“å­˜
- **å¹¶å‘æ§åˆ¶**ï¼šé™åˆ¶å¹¶å‘çš„è®¤è¯è¯·æ±‚æ•°é‡
- **è¶…æ—¶å¤„ç†**ï¼šè®¾ç½®åˆç†çš„è¯·æ±‚è¶…æ—¶æ—¶é—´

### é”™è¯¯æ¢å¤æœºåˆ¶

- **æŒ‡æ•°é€€é¿**ï¼šå®ç°æŒ‡æ•°é€€é¿ç®—æ³•å¤„ç†ä¸´æ—¶æ€§é”™è¯¯
- **é‡è¯•æœºåˆ¶**ï¼šè‡ªåŠ¨é‡è¯•å¤±è´¥çš„æ“ä½œ
- **é™çº§ç­–ç•¥**ï¼šåœ¨ç½‘ç»œå¼‚å¸¸æ—¶æä¾›åŸºæœ¬åŠŸèƒ½

### ç›‘æ§å’ŒæŒ‡æ ‡

- **æ€§èƒ½ç›‘æ§**ï¼šè·Ÿè¸ªè®¤è¯æ“ä½œçš„å“åº”æ—¶é—´
- **é”™è¯¯ç‡ç»Ÿè®¡**ï¼šç›‘æ§è®¤è¯ç›¸å…³çš„é”™è¯¯ç‡
- **ç”¨æˆ·è¡Œä¸ºåˆ†æ**ï¼šåˆ†æç”¨æˆ·è®¤è¯è¡Œä¸ºæ¨¡å¼

## æ•…éšœæ’é™¤æŒ‡å—

### å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

#### ç™»å½•å¤±è´¥

**é—®é¢˜ç—‡çŠ¶**ï¼šç”¨æˆ·æ— æ³•ç™»å½•ï¼Œæ”¶åˆ°"ç™»å½•å¤±è´¥"é”™è¯¯

**å¯èƒ½åŸå› **ï¼š
- ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯
- è´¦æˆ·è¢«é”å®šæˆ–ç¦ç”¨
- ç½‘ç»œè¿æ¥é—®é¢˜
- SupabaseæœåŠ¡å¼‚å¸¸

**è§£å†³æ–¹æ¡ˆ**ï¼š
```typescript
// æ£€æŸ¥ç½‘ç»œè¿æ¥
try {
  const { data, error } = await supabase.auth.signInWithPassword(credentials);
  if (error) {
    // å¤„ç†å…·ä½“é”™è¯¯ç±»å‹
    if (error.status === 400) {
      // å‚æ•°é”™è¯¯
    } else if (error.status === 401) {
      // è®¤è¯å¤±è´¥
    }
  }
} catch (networkError) {
  // å¤„ç†ç½‘ç»œé”™è¯¯
}
```

#### ä¼šè¯è¿‡æœŸ

**é—®é¢˜ç—‡çŠ¶**ï¼šç”¨æˆ·åœ¨æ“ä½œè¿‡ç¨‹ä¸­çªç„¶è¢«ç™»å‡º

**å¯èƒ½åŸå› **ï¼š
- ä»¤ç‰Œè¿‡æœŸ
- æµè§ˆå™¨Cookieè¢«æ¸…é™¤
- å¤šè®¾å¤‡ç™»å½•å†²çª

**è§£å†³æ–¹æ¡ˆ**ï¼š
- å®ç°è‡ªåŠ¨é‡æ–°ç™»å½•æœºåˆ¶
- æ˜¾ç¤ºå‹å¥½çš„è¿‡æœŸæç¤º
- æä¾›æ‰‹åŠ¨é‡æ–°ç™»å½•é€‰é¡¹

#### ç¬¬ä¸‰æ–¹ç™»å½•é—®é¢˜

**é—®é¢˜ç—‡çŠ¶**ï¼šç¬¬ä¸‰æ–¹ç™»å½•å¤±è´¥æˆ–å›è°ƒå¼‚å¸¸

**å¯èƒ½åŸå› **ï¼š
- OAuthé…ç½®é”™è¯¯
- å›è°ƒURLä¸åŒ¹é…
- ç½‘ç»œä»£ç†é—®é¢˜

**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥OAuthåº”ç”¨é…ç½®
- éªŒè¯å›è°ƒURLè®¾ç½®
- æµ‹è¯•ç½‘ç»œè¿é€šæ€§

**ç« èŠ‚æ¥æº**
- [authService.ts](file://src/services/authService.ts#L15-L48)
- [errorHandler.ts](file://src/utils/errorHandler.ts#L50-L120)

## ç»“è®º

Advanced Tools Navigationçš„è®¤è¯æœåŠ¡å±•ç°äº†ç°ä»£Webåº”ç”¨è®¤è¯ç³»ç»Ÿçš„æœ€ä½³å®è·µã€‚é€šè¿‡ç²¾å¿ƒè®¾è®¡çš„æ¶æ„ã€å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶å’Œå…¨é¢çš„å®‰å…¨é˜²æŠ¤æªæ–½ï¼Œè¯¥ç³»ç»Ÿä¸ºç”¨æˆ·æä¾›äº†å®‰å…¨ã€å¯é ä¸”æ˜“ç”¨çš„è®¤è¯ä½“éªŒã€‚

### ä¸»è¦ä¼˜åŠ¿

1. **æ¨¡å—åŒ–è®¾è®¡**ï¼šæ¸…æ™°çš„èŒè´£åˆ†ç¦»å’Œæ¨¡å—åŒ–æ¶æ„
2. **ç±»å‹å®‰å…¨**ï¼šå®Œæ•´çš„TypeScriptç±»å‹å®šä¹‰
3. **é”™è¯¯å¤„ç†**ï¼šç»Ÿä¸€çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•æœºåˆ¶
4. **å®‰å…¨é˜²æŠ¤**ï¼šå¤šå±‚æ¬¡çš„å®‰å…¨é˜²æŠ¤æªæ–½
5. **æ‰©å±•æ€§**ï¼šè‰¯å¥½çš„æ‰©å±•æ€§å’Œç»´æŠ¤æ€§

### æœ€ä½³å®è·µå»ºè®®

1. **å®šæœŸæ›´æ–°ä¾èµ–**ï¼šä¿æŒSupabase SDKå’Œå…¶ä»–ä¾èµ–çš„æœ€æ–°ç‰ˆæœ¬
2. **ç›‘æ§ç³»ç»Ÿå¥åº·**ï¼šå»ºç«‹å®Œå–„çš„ç›‘æ§å’Œå‘Šè­¦æœºåˆ¶
3. **å®‰å…¨å®¡è®¡**ï¼šå®šæœŸè¿›è¡Œå®‰å…¨å®¡è®¡å’Œæ¼æ´æ‰«æ
4. **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**ï¼šæŒç»­æ”¹è¿›è®¤è¯æµç¨‹çš„ç”¨æˆ·ä½“éªŒ
5. **æ–‡æ¡£ç»´æŠ¤**ï¼šåŠæ—¶æ›´æ–°æŠ€æœ¯æ–‡æ¡£å’Œå¼€å‘æŒ‡å—

è¯¥è®¤è¯æœåŠ¡ä¸ºæ•´ä¸ªåº”ç”¨æä¾›äº†åšå®çš„å®‰å…¨åŸºç¡€ï¼Œç¡®ä¿äº†ç”¨æˆ·æ•°æ®çš„å®‰å…¨æ€§å’Œç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚é€šè¿‡éµå¾ªæœ¬æ–‡æ¡£ä¸­çš„æŒ‡å¯¼åŸåˆ™å’Œæœ€ä½³å®è·µï¼Œå¼€å‘è€…å¯ä»¥æœ‰æ•ˆåœ°ç»´æŠ¤å’Œæ‰©å±•è¿™ä¸ªè®¤è¯ç³»ç»Ÿã€‚