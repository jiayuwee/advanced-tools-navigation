{"version":3,"file":"EnhancedSearchBox-dSX-Wrso.js","sources":["../../node_modules/lucide-vue-next/dist/esm/icons/tag.js","../../src/services/searchService.ts","../../src/components/search/EnhancedSearchBox.vue"],"sourcesContent":["/**\n * @license lucide-vue-next v0.294.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Tag = createLucideIcon(\"TagIcon\", [\n  [\n    \"path\",\n    {\n      d: \"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z\",\n      key: \"14b2ls\"\n    }\n  ],\n  [\"path\", { d: \"M7 7h.01\", key: \"7u93v4\" }]\n]);\n\nexport { Tag as default };\n//# sourceMappingURL=tag.js.map\n","// @ts-nocheck\r\nimport { supabase, TABLES } from \"@/lib/supabaseClient\";\r\nimport { databaseService } from \"./databaseService\";\r\nimport type { Tool, Product, Category } from \"@/types\";\r\n\r\nexport interface SearchOptions {\r\n  query: string;\r\n  type?: \"all\" | \"tools\" | \"products\" | \"categories\";\r\n  category?: string;\r\n  tags?: string[];\r\n  priceRange?: [number, number];\r\n  sortBy?: \"relevance\" | \"name\" | \"created_at\" | \"click_count\" | \"price\";\r\n  sortOrder?: \"asc\" | \"desc\";\r\n  limit?: number;\r\n  offset?: number;\r\n  includeInactive?: boolean;\r\n}\r\n\r\nexport interface SearchResult<T> {\r\n  items: T[];\r\n  total: number;\r\n  query: string;\r\n  suggestions: string[];\r\n  facets: SearchFacets;\r\n  searchTime: number;\r\n}\r\n\r\nexport interface SearchFacets {\r\n  categories: { name: string; count: number }[];\r\n  tags: { name: string; count: number }[];\r\n  priceRanges: { range: string; count: number }[];\r\n}\r\n\r\nexport interface SearchSuggestion {\r\n  text: string;\r\n  type: \"query\" | \"category\" | \"tag\" | \"tool\" | \"product\";\r\n  count?: number;\r\n}\r\n\r\nexport interface SearchHistory {\r\n  id: string;\r\n  query: string;\r\n  type: string;\r\n  timestamp: Date;\r\n  results_count: number;\r\n}\r\n\r\nclass SearchService {\r\n  private searchHistory: SearchHistory[] = [];\r\n  private popularQueries: Map<string, number> = new Map();\r\n\r\n  // 主搜索方法\r\n  async search<T>(options: SearchOptions): Promise<SearchResult<T>> {\r\n    const startTime = Date.now();\r\n    const { query, type = \"all\", limit = 20, offset = 0 } = options;\r\n\r\n    try {\r\n      let results: T[] = [];\r\n      let total = 0;\r\n      let facets: SearchFacets = {\r\n        categories: [],\r\n        tags: [],\r\n        priceRanges: [],\r\n      };\r\n\r\n      // 记录搜索历史\r\n      this.addToHistory(query, type);\r\n\r\n      // 根据搜索类型执行不同的搜索策略\r\n      switch (type) {\r\n        case \"tools\":\r\n          const toolResults = await this.searchTools(options);\r\n          results = toolResults.items as T[];\r\n          total = toolResults.total;\r\n          facets = toolResults.facets;\r\n          break;\r\n\r\n        case \"products\":\r\n          const productResults = await this.searchProducts(options);\r\n          results = productResults.items as T[];\r\n          total = productResults.total;\r\n          facets = productResults.facets;\r\n          break;\r\n\r\n        case \"categories\":\r\n          const categoryResults = await this.searchCategories(options);\r\n          results = categoryResults.items as T[];\r\n          total = categoryResults.total;\r\n          break;\r\n\r\n        case \"all\":\r\n        default:\r\n          const allResults = await this.searchAll(options);\r\n          results = allResults.items as T[];\r\n          total = allResults.total;\r\n          facets = allResults.facets;\r\n          break;\r\n      }\r\n\r\n      // 生成搜索建议\r\n      const suggestions = await this.generateSuggestions(query, type);\r\n\r\n      const searchTime = Date.now() - startTime;\r\n\r\n      return {\r\n        items: results,\r\n        total,\r\n        query,\r\n        suggestions,\r\n        facets,\r\n        searchTime,\r\n      };\r\n    } catch (error) {\r\n      console.error(\"搜索失败:\", error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  // 搜索工具\r\n  private async searchTools(options: SearchOptions): Promise<{\r\n    items: Tool[];\r\n    total: number;\r\n    facets: SearchFacets;\r\n  }> {\r\n    const {\r\n      query,\r\n      category,\r\n      tags,\r\n      sortBy = \"relevance\",\r\n      sortOrder = \"desc\",\r\n      limit = 20,\r\n      offset = 0,\r\n    } = options;\r\n\r\n    let queryBuilder = supabase.from(TABLES.TOOLS).select(\r\n      `\r\n        *,\r\n        categories!inner(name, icon, color),\r\n        tool_tags!inner(tags!inner(name, color))\r\n      `,\r\n      { count: \"exact\" },\r\n    );\r\n\r\n    // 全文搜索\r\n    if (query) {\r\n      queryBuilder = queryBuilder.or(`\r\n        name.ilike.%${query}%,\r\n        description.ilike.%${query}%,\r\n        meta_title.ilike.%${query}%,\r\n        meta_description.ilike.%${query}%\r\n      `);\r\n    }\r\n\r\n    // 分类筛选\r\n    if (category) {\r\n      queryBuilder = queryBuilder.eq(\"category_id\", category);\r\n    }\r\n\r\n    // 标签筛选\r\n    if (tags && tags.length > 0) {\r\n      queryBuilder = queryBuilder.in(\"tool_tags.tag_id\", tags);\r\n    }\r\n\r\n    // 只显示活跃的工具\r\n    queryBuilder = queryBuilder.eq(\"status\", \"active\");\r\n\r\n    // 排序\r\n    if (sortBy === \"relevance\" && query) {\r\n      // 相关性排序：优先显示名称匹配的结果\r\n      queryBuilder = queryBuilder.order(\"is_featured\", { ascending: false });\r\n      queryBuilder = queryBuilder.order(\"click_count\", { ascending: false });\r\n    } else {\r\n      queryBuilder = queryBuilder.order(sortBy, {\r\n        ascending: sortOrder === \"asc\",\r\n      });\r\n    }\r\n\r\n    // 分页\r\n    queryBuilder = queryBuilder.range(offset, offset + limit - 1);\r\n\r\n    const { data, error, count } = await queryBuilder;\r\n\r\n    if (error) throw error;\r\n\r\n    // 生成分面数据\r\n    const facets = await this.generateToolsFacets(query, category, tags);\r\n\r\n    return {\r\n      items: data || [],\r\n      total: count || 0,\r\n      facets,\r\n    };\r\n  }\r\n\r\n  // 搜索产品\r\n  private async searchProducts(options: SearchOptions): Promise<{\r\n    items: Product[];\r\n    total: number;\r\n    facets: SearchFacets;\r\n  }> {\r\n    const {\r\n      query,\r\n      category,\r\n      priceRange,\r\n      sortBy = \"relevance\",\r\n      sortOrder = \"desc\",\r\n      limit = 20,\r\n      offset = 0,\r\n    } = options;\r\n\r\n    let queryBuilder = supabase.from(TABLES.PRODUCTS).select(\r\n      `\r\n        *,\r\n        product_categories!inner(name, icon, color)\r\n      `,\r\n      { count: \"exact\" },\r\n    );\r\n\r\n    // 全文搜索\r\n    if (query) {\r\n      queryBuilder = queryBuilder.or(`\r\n        name.ilike.%${query}%,\r\n        description.ilike.%${query}%,\r\n        short_description.ilike.%${query}%,\r\n        meta_title.ilike.%${query}%,\r\n        meta_description.ilike.%${query}%\r\n      `);\r\n    }\r\n\r\n    // 分类筛选\r\n    if (category) {\r\n      queryBuilder = queryBuilder.eq(\"category_id\", category);\r\n    }\r\n\r\n    // 价格范围筛选\r\n    if (priceRange) {\r\n      queryBuilder = queryBuilder\r\n        .gte(\"price\", priceRange[0])\r\n        .lte(\"price\", priceRange[1]);\r\n    }\r\n\r\n    // 只显示活跃的产品\r\n    queryBuilder = queryBuilder.eq(\"status\", \"active\");\r\n\r\n    // 排序\r\n    if (sortBy === \"relevance\" && query) {\r\n      queryBuilder = queryBuilder.order(\"is_featured\", { ascending: false });\r\n    } else {\r\n      queryBuilder = queryBuilder.order(sortBy, {\r\n        ascending: sortOrder === \"asc\",\r\n      });\r\n    }\r\n\r\n    // 分页\r\n    queryBuilder = queryBuilder.range(offset, offset + limit - 1);\r\n\r\n    const { data, error, count } = await queryBuilder;\r\n\r\n    if (error) throw error;\r\n\r\n    // 生成分面数据\r\n    const facets = await this.generateProductsFacets(\r\n      query,\r\n      category,\r\n      priceRange,\r\n    );\r\n\r\n    return {\r\n      items: data || [],\r\n      total: count || 0,\r\n      facets,\r\n    };\r\n  }\r\n\r\n  // 搜索分类\r\n  private async searchCategories(options: SearchOptions): Promise<{\r\n    items: Category[];\r\n    total: number;\r\n  }> {\r\n    const { query, limit = 20, offset = 0 } = options;\r\n\r\n    let queryBuilder = supabase\r\n      .from(TABLES.CATEGORIES)\r\n      .select(\"*\", { count: \"exact\" });\r\n\r\n    if (query) {\r\n      queryBuilder = queryBuilder.or(`\r\n        name.ilike.%${query}%,\r\n        description.ilike.%${query}%\r\n      `);\r\n    }\r\n\r\n    queryBuilder = queryBuilder\r\n      .eq(\"is_active\", true)\r\n      .order(\"sort_order\", { ascending: true })\r\n      .range(offset, offset + limit - 1);\r\n\r\n    const { data, error, count } = await queryBuilder;\r\n\r\n    if (error) throw error;\r\n\r\n    return {\r\n      items: data || [],\r\n      total: count || 0,\r\n    };\r\n  }\r\n\r\n  // 综合搜索\r\n  private async searchAll(options: SearchOptions): Promise<{\r\n    items: any[];\r\n    total: number;\r\n    facets: SearchFacets;\r\n  }> {\r\n    const { limit = 20 } = options;\r\n\r\n    // 并行搜索各个类型\r\n    const [toolResults, productResults, categoryResults] = await Promise.all([\r\n      this.searchTools({ ...options, limit: Math.ceil(limit / 3) }),\r\n      this.searchProducts({ ...options, limit: Math.ceil(limit / 3) }),\r\n      this.searchCategories({ ...options, limit: Math.ceil(limit / 3) }),\r\n    ]);\r\n\r\n    // 合并结果\r\n    const items = [\r\n      ...toolResults.items.map((item) => ({ ...item, _type: \"tool\" })),\r\n      ...productResults.items.map((item) => ({ ...item, _type: \"product\" })),\r\n      ...categoryResults.items.map((item) => ({ ...item, _type: \"category\" })),\r\n    ];\r\n\r\n    const total =\r\n      toolResults.total + productResults.total + categoryResults.total;\r\n\r\n    // 合并分面数据\r\n    const facets: SearchFacets = {\r\n      categories: [\r\n        ...toolResults.facets.categories,\r\n        ...productResults.facets.categories,\r\n      ],\r\n      tags: toolResults.facets.tags,\r\n      priceRanges: productResults.facets.priceRanges,\r\n    };\r\n\r\n    return { items, total, facets };\r\n  }\r\n\r\n  // 生成工具分面数据\r\n  private async generateToolsFacets(\r\n    query?: string,\r\n    selectedCategory?: string,\r\n    selectedTags?: string[],\r\n  ): Promise<SearchFacets> {\r\n    // 获取分类分面\r\n    const categoriesQuery = supabase\r\n      .from(TABLES.CATEGORIES)\r\n      .select(\r\n        `\r\n        id, name,\r\n        tools!inner(id)\r\n      `,\r\n        { count: \"exact\" },\r\n      )\r\n      .eq(\"is_active\", true);\r\n\r\n    if (query) {\r\n      categoriesQuery.or(`\r\n        tools.name.ilike.%${query}%,\r\n        tools.description.ilike.%${query}%\r\n      `);\r\n    }\r\n\r\n    const { data: categoriesData } = await categoriesQuery;\r\n\r\n    const categories = (categoriesData || []).map((cat) => ({\r\n      name: cat.name,\r\n      count: cat.tools?.length || 0,\r\n    }));\r\n\r\n    // 获取标签分面\r\n    const tagsQuery = supabase.from(TABLES.TAGS).select(\r\n      `\r\n        id, name,\r\n        tool_tags!inner(tools!inner(id))\r\n      `,\r\n      { count: \"exact\" },\r\n    );\r\n\r\n    if (query) {\r\n      tagsQuery.or(`\r\n        tool_tags.tools.name.ilike.%${query}%,\r\n        tool_tags.tools.description.ilike.%${query}%\r\n      `);\r\n    }\r\n\r\n    const { data: tagsData } = await tagsQuery;\r\n\r\n    const tags = (tagsData || []).map((tag) => ({\r\n      name: tag.name,\r\n      count: tag.tool_tags?.length || 0,\r\n    }));\r\n\r\n    return {\r\n      categories,\r\n      tags,\r\n      priceRanges: [],\r\n    };\r\n  }\r\n\r\n  // 生成产品分面数据\r\n  private async generateProductsFacets(\r\n    query?: string,\r\n    selectedCategory?: string,\r\n    selectedPriceRange?: [number, number],\r\n  ): Promise<SearchFacets> {\r\n    // 获取分类分面\r\n    const categoriesQuery = supabase.from(TABLES.PRODUCT_CATEGORIES).select(\r\n      `\r\n        id, name,\r\n        products!inner(id)\r\n      `,\r\n      { count: \"exact\" },\r\n    );\r\n\r\n    if (query) {\r\n      categoriesQuery.or(`\r\n        products.name.ilike.%${query}%,\r\n        products.description.ilike.%${query}%\r\n      `);\r\n    }\r\n\r\n    const { data: categoriesData } = await categoriesQuery;\r\n\r\n    const categories = (categoriesData || []).map((cat) => ({\r\n      name: cat.name,\r\n      count: cat.products?.length || 0,\r\n    }));\r\n\r\n    // 获取价格范围分面\r\n    const priceRanges = [\r\n      { range: \"0-50\", count: 0 },\r\n      { range: \"50-100\", count: 0 },\r\n      { range: \"100-500\", count: 0 },\r\n      { range: \"500+\", count: 0 },\r\n    ];\r\n\r\n    // 这里可以添加实际的价格范围统计查询\r\n\r\n    return {\r\n      categories,\r\n      tags: [],\r\n      priceRanges,\r\n    };\r\n  }\r\n\r\n  // 生成搜索建议\r\n  private async generateSuggestions(\r\n    query: string,\r\n    type: string,\r\n  ): Promise<string[]> {\r\n    if (!query || query.length < 2) return [];\r\n\r\n    const suggestions: string[] = [];\r\n\r\n    try {\r\n      // 从工具名称生成建议\r\n      const { data: toolSuggestions } = await supabase\r\n        .from(TABLES.TOOLS)\r\n        .select(\"name\")\r\n        .ilike(\"name\", `%${query}%`)\r\n        .eq(\"status\", \"active\")\r\n        .limit(5);\r\n\r\n      toolSuggestions?.forEach((tool) => {\r\n        if (!suggestions.includes(tool.name)) {\r\n          suggestions.push(tool.name);\r\n        }\r\n      });\r\n\r\n      // 从产品名称生成建议\r\n      const { data: productSuggestions } = await supabase\r\n        .from(TABLES.PRODUCTS)\r\n        .select(\"name\")\r\n        .ilike(\"name\", `%${query}%`)\r\n        .eq(\"status\", \"active\")\r\n        .limit(5);\r\n\r\n      productSuggestions?.forEach((product) => {\r\n        if (!suggestions.includes(product.name)) {\r\n          suggestions.push(product.name);\r\n        }\r\n      });\r\n\r\n      // 从分类名称生成建议\r\n      const { data: categorySuggestions } = await supabase\r\n        .from(TABLES.CATEGORIES)\r\n        .select(\"name\")\r\n        .ilike(\"name\", `%${query}%`)\r\n        .eq(\"is_active\", true)\r\n        .limit(3);\r\n\r\n      categorySuggestions?.forEach((category) => {\r\n        if (!suggestions.includes(category.name)) {\r\n          suggestions.push(category.name);\r\n        }\r\n      });\r\n    } catch (error) {\r\n      console.error(\"生成搜索建议失败:\", error);\r\n    }\r\n\r\n    return suggestions.slice(0, 8);\r\n  }\r\n\r\n  // 获取热门搜索\r\n  async getPopularSearches(limit: number = 10): Promise<string[]> {\r\n    const popular = Array.from(this.popularQueries.entries())\r\n      .sort((a, b) => b[1] - a[1])\r\n      .slice(0, limit)\r\n      .map(([query]) => query);\r\n\r\n    return popular;\r\n  }\r\n\r\n  // 获取搜索历史\r\n  getSearchHistory(limit: number = 10): SearchHistory[] {\r\n    return this.searchHistory\r\n      .sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime())\r\n      .slice(0, limit);\r\n  }\r\n\r\n  // 清除搜索历史\r\n  clearSearchHistory(): void {\r\n    this.searchHistory = [];\r\n    localStorage.removeItem(\"search_history\");\r\n  }\r\n\r\n  // 保存搜索历史到本地存储\r\n  private saveHistoryToStorage(): void {\r\n    try {\r\n      localStorage.setItem(\r\n        \"search_history\",\r\n        JSON.stringify(this.searchHistory),\r\n      );\r\n    } catch (error) {\r\n      console.error(\"保存搜索历史失败:\", error);\r\n    }\r\n  }\r\n\r\n  // 从本地存储加载搜索历史\r\n  private loadHistoryFromStorage(): void {\r\n    try {\r\n      const stored = localStorage.getItem(\"search_history\");\r\n      if (stored) {\r\n        const parsed = JSON.parse(stored);\r\n        this.searchHistory = parsed.map((item: any) => ({\r\n          ...item,\r\n          timestamp: new Date(item.timestamp),\r\n        }));\r\n      }\r\n    } catch (error) {\r\n      console.error(\"加载搜索历史失败:\", error);\r\n      this.searchHistory = [];\r\n    }\r\n  }\r\n\r\n  // 添加到搜索历史\r\n  private addToHistory(query: string, type: string): void {\r\n    const historyItem: SearchHistory = {\r\n      id: Date.now().toString(),\r\n      query,\r\n      type,\r\n      timestamp: new Date(),\r\n      results_count: 0,\r\n    };\r\n\r\n    // 避免重复\r\n    this.searchHistory = this.searchHistory.filter(\r\n      (item) => item.query !== query || item.type !== type,\r\n    );\r\n\r\n    this.searchHistory.unshift(historyItem);\r\n\r\n    // 限制历史记录数量\r\n    if (this.searchHistory.length > 50) {\r\n      this.searchHistory = this.searchHistory.slice(0, 50);\r\n    }\r\n\r\n    // 更新热门搜索\r\n    const currentCount = this.popularQueries.get(query) || 0;\r\n    this.popularQueries.set(query, currentCount + 1);\r\n  }\r\n\r\n  // 智能搜索建议\r\n  async getSmartSuggestions(query: string): Promise<SearchSuggestion[]> {\r\n    const suggestions: SearchSuggestion[] = [];\r\n\r\n    if (!query || query.length < 2) {\r\n      // 返回热门搜索\r\n      const popular = await this.getPopularSearches(5);\r\n      return popular.map((q) => ({\r\n        text: q,\r\n        type: \"query\" as const,\r\n      }));\r\n    }\r\n\r\n    try {\r\n      // 查询建议\r\n      const querySuggestions = await this.generateSuggestions(query, \"all\");\r\n      querySuggestions.forEach((suggestion) => {\r\n        suggestions.push({\r\n          text: suggestion,\r\n          type: \"query\",\r\n        });\r\n      });\r\n\r\n      // 分类建议\r\n      const { data: categories } = await supabase\r\n        .from(TABLES.CATEGORIES)\r\n        .select(\"name\")\r\n        .ilike(\"name\", `%${query}%`)\r\n        .eq(\"is_active\", true)\r\n        .limit(3);\r\n\r\n      categories?.forEach((category) => {\r\n        suggestions.push({\r\n          text: category.name,\r\n          type: \"category\",\r\n        });\r\n      });\r\n\r\n      // 标签建议\r\n      const { data: tags } = await supabase\r\n        .from(TABLES.TAGS)\r\n        .select(\"name\")\r\n        .ilike(\"name\", `%${query}%`)\r\n        .limit(3);\r\n\r\n      tags?.forEach((tag) => {\r\n        suggestions.push({\r\n          text: tag.name,\r\n          type: \"tag\",\r\n        });\r\n      });\r\n    } catch (error) {\r\n      console.error(\"获取智能建议失败:\", error);\r\n    }\r\n\r\n    return suggestions.slice(0, 10);\r\n  }\r\n}\r\n\r\n// 导出单例实例\r\nexport const searchService = new SearchService();\r\nexport default searchService;\r\n","<template>\r\n  <div\r\n    class=\"enhanced-search-box\"\r\n    :class=\"{ 'is-focused': isFocused, 'is-expanded': isExpanded }\"\r\n  >\r\n    <!-- 搜索输入框 -->\r\n    <div class=\"search-input-container\">\r\n      <div class=\"search-input-wrapper\">\r\n        <SearchIcon class=\"search-icon\" />\r\n        <input\r\n          ref=\"searchInput\"\r\n          v-model=\"query\"\r\n          type=\"text\"\r\n          class=\"search-input\"\r\n          :placeholder=\"placeholder\"\r\n          @focus=\"handleFocus\"\r\n          @blur=\"handleBlur\"\r\n          @keydown=\"handleKeydown\"\r\n          @input=\"handleInput\"\r\n        />\r\n        <div class=\"search-actions\">\r\n          <!-- 搜索类型选择 -->\r\n          <select v-model=\"searchType\" class=\"search-type-select\">\r\n            <option value=\"all\">全部</option>\r\n            <option value=\"tools\">工具</option>\r\n            <option value=\"products\">产品</option>\r\n            <option value=\"categories\">分类</option>\r\n          </select>\r\n\r\n          <!-- 清除按钮 -->\r\n          <button\r\n            v-if=\"query\"\r\n            class=\"clear-button\"\r\n            type=\"button\"\r\n            @click=\"clearSearch\"\r\n          >\r\n            <XIcon class=\"icon\" />\r\n          </button>\r\n\r\n          <!-- 高级搜索按钮 -->\r\n          <button\r\n            class=\"advanced-button\"\r\n            :class=\"{ active: showAdvanced }\"\r\n            type=\"button\"\r\n            @click=\"toggleAdvanced\"\r\n          >\r\n            <FilterIcon class=\"icon\" />\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 搜索建议下拉框 -->\r\n      <div\r\n        v-if=\"\r\n          showSuggestions &&\r\n          (suggestions.length > 0 || searchHistory.length > 0)\r\n        \"\r\n        class=\"suggestions-dropdown\"\r\n      >\r\n        <!-- 搜索建议 -->\r\n        <div v-if=\"suggestions.length > 0\" class=\"suggestions-section\">\r\n          <div class=\"suggestions-header\">搜索建议</div>\r\n          <div\r\n            v-for=\"(suggestion, index) in suggestions\"\r\n            :key=\"`suggestion-${index}`\"\r\n            class=\"suggestion-item\"\r\n            :class=\"{ active: selectedIndex === index }\"\r\n            @click=\"selectSuggestion(suggestion.text)\"\r\n            @mouseenter=\"selectedIndex = index\"\r\n          >\r\n            <component\r\n              :is=\"getSuggestionIcon(suggestion.type)\"\r\n              class=\"suggestion-icon\"\r\n            />\r\n            <span class=\"suggestion-text\">{{ suggestion.text }}</span>\r\n            <span class=\"suggestion-type\">{{\r\n              getSuggestionTypeText(suggestion.type)\r\n            }}</span>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 搜索历史 -->\r\n        <div\r\n          v-if=\"searchHistory.length > 0 && !query\"\r\n          class=\"suggestions-section\"\r\n        >\r\n          <div class=\"suggestions-header\">\r\n            <span>最近搜索</span>\r\n            <button class=\"clear-history-button\" @click=\"clearHistory\">\r\n              清除\r\n            </button>\r\n          </div>\r\n          <div\r\n            v-for=\"(history, index) in searchHistory\"\r\n            :key=\"`history-${history.id}`\"\r\n            class=\"suggestion-item history-item\"\r\n            :class=\"{ active: selectedIndex === suggestions.length + index }\"\r\n            @click=\"selectSuggestion(history.query)\"\r\n            @mouseenter=\"selectedIndex = suggestions.length + index\"\r\n          >\r\n            <ClockIcon class=\"suggestion-icon\" />\r\n            <span class=\"suggestion-text\">{{ history.query }}</span>\r\n            <span class=\"suggestion-meta\">{{\r\n              formatTime(history.timestamp)\r\n            }}</span>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 热门搜索 -->\r\n        <div\r\n          v-if=\"popularSearches.length > 0 && !query\"\r\n          class=\"suggestions-section\"\r\n        >\r\n          <div class=\"suggestions-header\">热门搜索</div>\r\n          <div class=\"popular-searches\">\r\n            <button\r\n              v-for=\"popular in popularSearches\"\r\n              :key=\"popular\"\r\n              class=\"popular-search-tag\"\r\n              @click=\"selectSuggestion(popular)\"\r\n            >\r\n              {{ popular }}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 高级搜索面板 -->\r\n    <div v-if=\"showAdvanced\" class=\"advanced-search-panel\">\r\n      <div class=\"advanced-search-content\">\r\n        <div class=\"advanced-row\">\r\n          <div class=\"advanced-group\">\r\n            <label class=\"advanced-label\">分类</label>\r\n            <select v-model=\"filters.category\" class=\"advanced-select\">\r\n              <option value=\"\">所有分类</option>\r\n              <option\r\n                v-for=\"category in categories\"\r\n                :key=\"category.id\"\r\n                :value=\"category.id\"\r\n              >\r\n                {{ category.name }}\r\n              </option>\r\n            </select>\r\n          </div>\r\n\r\n          <div class=\"advanced-group\">\r\n            <label class=\"advanced-label\">排序</label>\r\n            <select v-model=\"filters.sortBy\" class=\"advanced-select\">\r\n              <option value=\"relevance\">相关性</option>\r\n              <option value=\"name\">名称</option>\r\n              <option value=\"created_at\">创建时间</option>\r\n              <option value=\"click_count\">热度</option>\r\n              <option value=\"price\">价格</option>\r\n            </select>\r\n          </div>\r\n\r\n          <div class=\"advanced-group\">\r\n            <label class=\"advanced-label\">顺序</label>\r\n            <select v-model=\"filters.sortOrder\" class=\"advanced-select\">\r\n              <option value=\"desc\">降序</option>\r\n              <option value=\"asc\">升序</option>\r\n            </select>\r\n          </div>\r\n        </div>\r\n\r\n        <div v-if=\"searchType === 'products'\" class=\"advanced-row\">\r\n          <div class=\"advanced-group\">\r\n            <label class=\"advanced-label\">价格范围</label>\r\n            <div class=\"price-range\">\r\n              <input\r\n                v-model.number=\"filters.priceMin\"\r\n                type=\"number\"\r\n                placeholder=\"最低价\"\r\n                class=\"price-input\"\r\n                min=\"0\"\r\n              />\r\n              <span class=\"price-separator\">-</span>\r\n              <input\r\n                v-model.number=\"filters.priceMax\"\r\n                type=\"number\"\r\n                placeholder=\"最高价\"\r\n                class=\"price-input\"\r\n                min=\"0\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"advanced-row\">\r\n          <div class=\"advanced-group full-width\">\r\n            <label class=\"advanced-label\">标签</label>\r\n            <div class=\"tags-input\">\r\n              <div class=\"selected-tags\">\r\n                <span\r\n                  v-for=\"tag in selectedTags\"\r\n                  :key=\"tag.id\"\r\n                  class=\"selected-tag\"\r\n                >\r\n                  {{ tag.name }}\r\n                  <button class=\"remove-tag\" @click=\"removeTag(tag)\">\r\n                    <XIcon class=\"icon\" />\r\n                  </button>\r\n                </span>\r\n              </div>\r\n              <input\r\n                v-model=\"tagQuery\"\r\n                type=\"text\"\r\n                placeholder=\"输入标签名称...\"\r\n                class=\"tag-input\"\r\n                @input=\"searchTags\"\r\n              />\r\n              <div v-if=\"availableTags.length > 0\" class=\"tags-dropdown\">\r\n                <div\r\n                  v-for=\"tag in availableTags\"\r\n                  :key=\"tag.id\"\r\n                  class=\"tag-option\"\r\n                  @click=\"addTag(tag)\"\r\n                >\r\n                  <span\r\n                    class=\"tag-color\"\r\n                    :style=\"{ backgroundColor: tag.color }\"\r\n                  ></span>\r\n                  {{ tag.name }}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"advanced-actions\">\r\n          <button class=\"reset-button\" @click=\"resetFilters\">重置</button>\r\n          <button class=\"apply-button\" @click=\"applyFilters\">应用筛选</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 搜索状态 -->\r\n    <div v-if=\"isSearching\" class=\"search-status\">\r\n      <div class=\"search-loading\">\r\n        <div class=\"loading-spinner\"></div>\r\n        <span>搜索中...</span>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 搜索结果统计 -->\r\n    <div v-if=\"lastSearchResult\" class=\"search-stats\">\r\n      找到 {{ lastSearchResult.total }} 个结果，用时\r\n      {{ lastSearchResult.searchTime }}ms\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed, watch, onMounted, nextTick } from \"vue\";\r\nimport { useRouter } from \"vue-router\";\r\nimport { useDebounceFn } from \"@vueuse/core\";\r\nimport {\r\n  SearchIcon,\r\n  XIcon,\r\n  FilterIcon,\r\n  ClockIcon,\r\n  TagIcon,\r\n  FolderIcon,\r\n  PackageIcon,\r\n  TrendingUpIcon,\r\n} from \"lucide-vue-next\";\r\nimport { searchService } from \"@/services/searchService\";\r\nimport { useCategoriesStore } from \"@/stores/categories\";\r\nimport type {\r\n  SearchResult,\r\n  SearchSuggestion,\r\n  SearchHistory,\r\n} from \"@/services/searchService\";\r\nimport type { Category, Tag } from \"@/types\";\r\n\r\ninterface Props {\r\n  placeholder?: string;\r\n  autoFocus?: boolean;\r\n  showAdvanced?: boolean;\r\n  defaultType?: string;\r\n}\r\n\r\ninterface Emits {\r\n  (e: \"search\", result: SearchResult<any>): void;\r\n  (e: \"clear\"): void;\r\n  (e: \"focus\"): void;\r\n  (e: \"blur\"): void;\r\n}\r\n\r\nconst props = withDefaults(defineProps<Props>(), {\r\n  placeholder: \"搜索工具、产品、分类...\",\r\n  autoFocus: false,\r\n  showAdvanced: false,\r\n  defaultType: \"all\",\r\n});\r\n\r\nconst emit = defineEmits<Emits>();\r\n\r\nconst router = useRouter();\r\nconst categoriesStore = useCategoriesStore();\r\n\r\n// 引用\r\nconst searchInput = ref<HTMLInputElement>();\r\n\r\n// 状态\r\nconst query = ref(\"\");\r\nconst searchType = ref(props.defaultType);\r\nconst isFocused = ref(false);\r\nconst isExpanded = ref(false);\r\nconst showSuggestions = ref(false);\r\nconst showAdvanced = ref(props.showAdvanced);\r\nconst isSearching = ref(false);\r\nconst selectedIndex = ref(-1);\r\n\r\n// 搜索建议\r\nconst suggestions = ref<SearchSuggestion[]>([]);\r\nconst searchHistory = ref<SearchHistory[]>([]);\r\nconst popularSearches = ref<string[]>([]);\r\n\r\n// 高级搜索\r\nconst filters = ref({\r\n  category: \"\",\r\n  sortBy: \"relevance\",\r\n  sortOrder: \"desc\",\r\n  priceMin: null as number | null,\r\n  priceMax: null as number | null,\r\n});\r\n\r\n// 标签相关\r\nconst selectedTags = ref<Tag[]>([]);\r\nconst tagQuery = ref(\"\");\r\nconst availableTags = ref<Tag[]>([]);\r\n\r\n// 搜索结果\r\nconst lastSearchResult = ref<SearchResult<any> | null>(null);\r\n\r\n// 计算属性\r\nconst categories = computed(() => categoriesStore.categories);\r\n\r\nconst allSuggestions = computed(() => [\r\n  ...suggestions.value,\r\n  ...searchHistory.value.map((h) => ({\r\n    text: h.query,\r\n    type: \"query\" as const,\r\n  })),\r\n]);\r\n\r\n// 方法\r\nconst handleFocus = () => {\r\n  isFocused.value = true;\r\n  isExpanded.value = true;\r\n  showSuggestions.value = true;\r\n  emit(\"focus\");\r\n  loadSuggestions();\r\n};\r\n\r\nconst handleBlur = () => {\r\n  // 延迟隐藏，允许点击建议\r\n  setTimeout(() => {\r\n    isFocused.value = false;\r\n    showSuggestions.value = false;\r\n    selectedIndex.value = -1;\r\n  }, 200);\r\n  emit(\"blur\");\r\n};\r\n\r\nconst handleInput = () => {\r\n  selectedIndex.value = -1;\r\n  debouncedLoadSuggestions();\r\n};\r\n\r\nconst handleKeydown = (event: KeyboardEvent) => {\r\n  switch (event.key) {\r\n    case \"ArrowDown\":\r\n      event.preventDefault();\r\n      selectedIndex.value = Math.min(\r\n        selectedIndex.value + 1,\r\n        allSuggestions.value.length - 1,\r\n      );\r\n      break;\r\n    case \"ArrowUp\":\r\n      event.preventDefault();\r\n      selectedIndex.value = Math.max(selectedIndex.value - 1, -1);\r\n      break;\r\n    case \"Enter\":\r\n      event.preventDefault();\r\n      if (selectedIndex.value >= 0) {\r\n        selectSuggestion(allSuggestions.value[selectedIndex.value].text);\r\n      } else {\r\n        performSearch();\r\n      }\r\n      break;\r\n    case \"Escape\":\r\n      searchInput.value?.blur();\r\n      break;\r\n  }\r\n};\r\n\r\nconst loadSuggestions = async () => {\r\n  try {\r\n    if (query.value) {\r\n      suggestions.value = await searchService.getSmartSuggestions(query.value);\r\n    } else {\r\n      suggestions.value = [];\r\n      searchHistory.value = searchService.getSearchHistory(5);\r\n      popularSearches.value = await searchService.getPopularSearches(8);\r\n    }\r\n  } catch (error) {\r\n    console.error(\"加载搜索建议失败:\", error);\r\n  }\r\n};\r\n\r\nconst debouncedLoadSuggestions = useDebounceFn(loadSuggestions, 300);\r\n\r\nconst selectSuggestion = (text: string) => {\r\n  query.value = text;\r\n  showSuggestions.value = false;\r\n  performSearch();\r\n};\r\n\r\nconst performSearch = async () => {\r\n  if (!query.value.trim()) return;\r\n\r\n  try {\r\n    isSearching.value = true;\r\n\r\n    const searchOptions = {\r\n      query: query.value.trim(),\r\n      type: searchType.value as any,\r\n      category: filters.value.category || undefined,\r\n      tags: selectedTags.value.map((tag) => tag.id),\r\n      priceRange:\r\n        filters.value.priceMin && filters.value.priceMax\r\n          ? ([filters.value.priceMin, filters.value.priceMax] as [\r\n              number,\r\n              number,\r\n            ])\r\n          : undefined,\r\n      sortBy: filters.value.sortBy as any,\r\n      sortOrder: filters.value.sortOrder as any,\r\n      limit: 20,\r\n    };\r\n\r\n    const result = await searchService.search(searchOptions);\r\n    lastSearchResult.value = result;\r\n    emit(\"search\", result);\r\n\r\n    // 导航到搜索结果页面\r\n    router.push({\r\n      name: \"SearchResults\",\r\n      query: {\r\n        q: query.value,\r\n        type: searchType.value,\r\n        ...filters.value,\r\n      },\r\n    });\r\n  } catch (error) {\r\n    console.error(\"搜索失败:\", error);\r\n  } finally {\r\n    isSearching.value = false;\r\n  }\r\n};\r\n\r\nconst clearSearch = () => {\r\n  query.value = \"\";\r\n  lastSearchResult.value = null;\r\n  emit(\"clear\");\r\n  searchInput.value?.focus();\r\n};\r\n\r\nconst clearHistory = () => {\r\n  searchService.clearSearchHistory();\r\n  searchHistory.value = [];\r\n};\r\n\r\nconst toggleAdvanced = () => {\r\n  showAdvanced.value = !showAdvanced.value;\r\n  isExpanded.value = showAdvanced.value;\r\n};\r\n\r\nconst resetFilters = () => {\r\n  filters.value = {\r\n    category: \"\",\r\n    sortBy: \"relevance\",\r\n    sortOrder: \"desc\",\r\n    priceMin: null,\r\n    priceMax: null,\r\n  };\r\n  selectedTags.value = [];\r\n};\r\n\r\nconst applyFilters = () => {\r\n  if (query.value) {\r\n    performSearch();\r\n  }\r\n};\r\n\r\n// 标签相关方法\r\nconst searchTags = async () => {\r\n  if (!tagQuery.value) {\r\n    availableTags.value = [];\r\n    return;\r\n  }\r\n\r\n  try {\r\n    // 这里应该调用标签搜索API\r\n    // const tags = await tagService.searchTags(tagQuery.value)\r\n    // availableTags.value = tags.filter(tag => !selectedTags.value.find(t => t.id === tag.id))\r\n  } catch (error) {\r\n    console.error(\"搜索标签失败:\", error);\r\n  }\r\n};\r\n\r\nconst addTag = (tag: Tag) => {\r\n  if (!selectedTags.value.find((t) => t.id === tag.id)) {\r\n    selectedTags.value.push(tag);\r\n  }\r\n  tagQuery.value = \"\";\r\n  availableTags.value = [];\r\n};\r\n\r\nconst removeTag = (tag: Tag) => {\r\n  selectedTags.value = selectedTags.value.filter((t) => t.id !== tag.id);\r\n};\r\n\r\n// 工具方法\r\nconst getSuggestionIcon = (type: string) => {\r\n  switch (type) {\r\n    case \"category\":\r\n      return FolderIcon;\r\n    case \"tag\":\r\n      return TagIcon;\r\n    case \"tool\":\r\n      return PackageIcon;\r\n    case \"product\":\r\n      return PackageIcon;\r\n    default:\r\n      return TrendingUpIcon;\r\n  }\r\n};\r\n\r\nconst getSuggestionTypeText = (type: string) => {\r\n  switch (type) {\r\n    case \"category\":\r\n      return \"分类\";\r\n    case \"tag\":\r\n      return \"标签\";\r\n    case \"tool\":\r\n      return \"工具\";\r\n    case \"product\":\r\n      return \"产品\";\r\n    default:\r\n      return \"搜索\";\r\n  }\r\n};\r\n\r\nconst formatTime = (date: Date) => {\r\n  const now = new Date();\r\n  const diff = now.getTime() - date.getTime();\r\n  const minutes = Math.floor(diff / 60000);\r\n  const hours = Math.floor(diff / 3600000);\r\n  const days = Math.floor(diff / 86400000);\r\n\r\n  if (minutes < 1) return \"刚刚\";\r\n  if (minutes < 60) return `${minutes}分钟前`;\r\n  if (hours < 24) return `${hours}小时前`;\r\n  return `${days}天前`;\r\n};\r\n\r\n// 生命周期\r\nonMounted(async () => {\r\n  if (props.autoFocus) {\r\n    await nextTick();\r\n    searchInput.value?.focus();\r\n  }\r\n\r\n  // 加载分类数据\r\n  if (categoriesStore.categories.length === 0) {\r\n    await categoriesStore.initialize();\r\n  }\r\n});\r\n\r\n// 监听器\r\nwatch(query, () => {\r\n  if (!query.value) {\r\n    lastSearchResult.value = null;\r\n  }\r\n});\r\n\r\n// 暴露方法\r\ndefineExpose({\r\n  focus: () => searchInput.value?.focus(),\r\n  clear: clearSearch,\r\n  search: performSearch,\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n.enhanced-search-box {\r\n  position: relative;\r\n  width: 100%;\r\n  max-width: 600px;\r\n  margin: 0 auto;\r\n}\r\n\r\n.search-input-container {\r\n  position: relative;\r\n}\r\n\r\n.search-input-wrapper {\r\n  display: flex;\r\n  align-items: center;\r\n  background: white;\r\n  border: 2px solid #e2e8f0;\r\n  border-radius: 12px;\r\n  padding: 0.75rem 1rem;\r\n  transition: all 0.2s ease;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.enhanced-search-box.is-focused .search-input-wrapper {\r\n  border-color: #3b82f6;\r\n  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\r\n}\r\n\r\n.search-icon {\r\n  width: 1.25rem;\r\n  height: 1.25rem;\r\n  color: #64748b;\r\n  margin-right: 0.75rem;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.search-input {\r\n  flex: 1;\r\n  border: none;\r\n  outline: none;\r\n  font-size: 1rem;\r\n  color: #1e293b;\r\n  background: transparent;\r\n}\r\n\r\n.search-input::placeholder {\r\n  color: #94a3b8;\r\n}\r\n\r\n.search-actions {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n  margin-left: 0.75rem;\r\n}\r\n\r\n.search-type-select {\r\n  padding: 0.25rem 0.5rem;\r\n  border: 1px solid #e2e8f0;\r\n  border-radius: 6px;\r\n  font-size: 0.875rem;\r\n  color: #64748b;\r\n  background: white;\r\n  cursor: pointer;\r\n}\r\n\r\n.clear-button,\r\n.advanced-button {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 2rem;\r\n  height: 2rem;\r\n  border: none;\r\n  border-radius: 6px;\r\n  background: transparent;\r\n  color: #64748b;\r\n  cursor: pointer;\r\n  transition: all 0.2s ease;\r\n}\r\n\r\n.clear-button:hover,\r\n.advanced-button:hover {\r\n  background: #f1f5f9;\r\n  color: #475569;\r\n}\r\n\r\n.advanced-button.active {\r\n  background: #3b82f6;\r\n  color: white;\r\n}\r\n\r\n.suggestions-dropdown {\r\n  position: absolute;\r\n  top: 100%;\r\n  left: 0;\r\n  right: 0;\r\n  background: white;\r\n  border: 1px solid #e2e8f0;\r\n  border-radius: 8px;\r\n  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);\r\n  z-index: 1000;\r\n  max-height: 400px;\r\n  overflow-y: auto;\r\n  margin-top: 0.5rem;\r\n}\r\n\r\n.suggestions-section {\r\n  padding: 0.75rem 0;\r\n}\r\n\r\n.suggestions-section:not(:last-child) {\r\n  border-bottom: 1px solid #f1f5f9;\r\n}\r\n\r\n.suggestions-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 0 1rem 0.5rem;\r\n  font-size: 0.75rem;\r\n  font-weight: 600;\r\n  color: #64748b;\r\n  text-transform: uppercase;\r\n  letter-spacing: 0.05em;\r\n}\r\n\r\n.clear-history-button {\r\n  background: none;\r\n  border: none;\r\n  color: #3b82f6;\r\n  cursor: pointer;\r\n  font-size: 0.75rem;\r\n  text-transform: none;\r\n  letter-spacing: normal;\r\n}\r\n\r\n.suggestion-item {\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 0.75rem 1rem;\r\n  cursor: pointer;\r\n  transition: background-color 0.2s ease;\r\n}\r\n\r\n.suggestion-item:hover,\r\n.suggestion-item.active {\r\n  background: #f8fafc;\r\n}\r\n\r\n.suggestion-icon {\r\n  width: 1rem;\r\n  height: 1rem;\r\n  color: #64748b;\r\n  margin-right: 0.75rem;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.suggestion-text {\r\n  flex: 1;\r\n  color: #1e293b;\r\n  font-size: 0.875rem;\r\n}\r\n\r\n.suggestion-type,\r\n.suggestion-meta {\r\n  font-size: 0.75rem;\r\n  color: #94a3b8;\r\n}\r\n\r\n.popular-searches {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 0.5rem;\r\n  padding: 0 1rem;\r\n}\r\n\r\n.popular-search-tag {\r\n  padding: 0.25rem 0.75rem;\r\n  background: #f1f5f9;\r\n  border: none;\r\n  border-radius: 16px;\r\n  font-size: 0.75rem;\r\n  color: #475569;\r\n  cursor: pointer;\r\n  transition: all 0.2s ease;\r\n}\r\n\r\n.popular-search-tag:hover {\r\n  background: #e2e8f0;\r\n}\r\n\r\n.advanced-search-panel {\r\n  margin-top: 1rem;\r\n  background: white;\r\n  border: 1px solid #e2e8f0;\r\n  border-radius: 8px;\r\n  padding: 1.5rem;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.advanced-row {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\r\n  gap: 1rem;\r\n  margin-bottom: 1rem;\r\n}\r\n\r\n.advanced-row:last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n.advanced-group {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.advanced-group.full-width {\r\n  grid-column: 1 / -1;\r\n}\r\n\r\n.advanced-label {\r\n  font-size: 0.875rem;\r\n  font-weight: 500;\r\n  color: #374151;\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\n.advanced-select,\r\n.price-input,\r\n.tag-input {\r\n  padding: 0.5rem 0.75rem;\r\n  border: 1px solid #d1d5db;\r\n  border-radius: 6px;\r\n  font-size: 0.875rem;\r\n  transition: border-color 0.2s ease;\r\n}\r\n\r\n.advanced-select:focus,\r\n.price-input:focus,\r\n.tag-input:focus {\r\n  outline: none;\r\n  border-color: #3b82f6;\r\n  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\r\n}\r\n\r\n.price-range {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n}\r\n\r\n.price-separator {\r\n  color: #64748b;\r\n  font-weight: 500;\r\n}\r\n\r\n.tags-input {\r\n  position: relative;\r\n}\r\n\r\n.selected-tags {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 0.5rem;\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\n.selected-tag {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.25rem;\r\n  padding: 0.25rem 0.5rem;\r\n  background: #dbeafe;\r\n  color: #1e40af;\r\n  border-radius: 4px;\r\n  font-size: 0.75rem;\r\n}\r\n\r\n.remove-tag {\r\n  background: none;\r\n  border: none;\r\n  color: #1e40af;\r\n  cursor: pointer;\r\n  padding: 0;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.tags-dropdown {\r\n  position: absolute;\r\n  top: 100%;\r\n  left: 0;\r\n  right: 0;\r\n  background: white;\r\n  border: 1px solid #e2e8f0;\r\n  border-radius: 6px;\r\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\r\n  z-index: 100;\r\n  max-height: 200px;\r\n  overflow-y: auto;\r\n}\r\n\r\n.tag-option {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n  padding: 0.5rem 0.75rem;\r\n  cursor: pointer;\r\n  transition: background-color 0.2s ease;\r\n}\r\n\r\n.tag-option:hover {\r\n  background: #f8fafc;\r\n}\r\n\r\n.tag-color {\r\n  width: 0.75rem;\r\n  height: 0.75rem;\r\n  border-radius: 50%;\r\n}\r\n\r\n.advanced-actions {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  gap: 0.75rem;\r\n  margin-top: 1.5rem;\r\n  padding-top: 1.5rem;\r\n  border-top: 1px solid #f1f5f9;\r\n}\r\n\r\n.reset-button,\r\n.apply-button {\r\n  padding: 0.5rem 1rem;\r\n  border-radius: 6px;\r\n  font-size: 0.875rem;\r\n  font-weight: 500;\r\n  cursor: pointer;\r\n  transition: all 0.2s ease;\r\n}\r\n\r\n.reset-button {\r\n  background: transparent;\r\n  border: 1px solid #d1d5db;\r\n  color: #374151;\r\n}\r\n\r\n.reset-button:hover {\r\n  background: #f9fafb;\r\n}\r\n\r\n.apply-button {\r\n  background: #3b82f6;\r\n  border: 1px solid #3b82f6;\r\n  color: white;\r\n}\r\n\r\n.apply-button:hover {\r\n  background: #2563eb;\r\n}\r\n\r\n.search-status {\r\n  margin-top: 1rem;\r\n  padding: 1rem;\r\n  background: #f8fafc;\r\n  border-radius: 8px;\r\n  text-align: center;\r\n}\r\n\r\n.search-loading {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 0.75rem;\r\n  color: #64748b;\r\n  font-size: 0.875rem;\r\n}\r\n\r\n.loading-spinner {\r\n  width: 1rem;\r\n  height: 1rem;\r\n  border: 2px solid #e2e8f0;\r\n  border-top: 2px solid #3b82f6;\r\n  border-radius: 50%;\r\n  animation: spin 1s linear infinite;\r\n}\r\n\r\n@keyframes spin {\r\n  to {\r\n    transform: rotate(360deg);\r\n  }\r\n}\r\n\r\n.search-stats {\r\n  margin-top: 0.5rem;\r\n  padding: 0.5rem 1rem;\r\n  background: #f0f9ff;\r\n  border-radius: 6px;\r\n  font-size: 0.75rem;\r\n  color: #0369a1;\r\n  text-align: center;\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .advanced-row {\r\n    grid-template-columns: 1fr;\r\n  }\r\n\r\n  .search-actions {\r\n    flex-direction: column;\r\n    gap: 0.25rem;\r\n  }\r\n\r\n  .advanced-actions {\r\n    flex-direction: column;\r\n  }\r\n}\r\n</style>\r\n"],"names":["Tag","createLucideIcon","d","key","searchService","SearchService","constructor","__publicField","this","Map","search","options","startTime","Date","now","query","type","limit","offset","results","total","facets","categories","tags","priceRanges","addToHistory","toolResults","searchTools","items","productResults","searchProducts","categoryResults","searchCategories","allResults","searchAll","suggestions","generateSuggestions","searchTime","error","console","category","sortBy","sortOrder","queryBuilder","supabase","from","TABLES","TOOLS","select","count","or","eq","length","in","order","ascending","range","data","generateToolsFacets","priceRange","PRODUCTS","gte","lte","generateProductsFacets","CATEGORIES","Promise","all","Math","ceil","map","item","_type","selectedCategory","selectedTags","categoriesQuery","categoriesData","cat","name","_a","tools","tagsQuery","TAGS","tagsData","tag","tool_tags","selectedPriceRange","PRODUCT_CATEGORIES","products","toolSuggestions","ilike","forEach","tool","includes","push","productSuggestions","product","categorySuggestions","slice","getPopularSearches","Array","popularQueries","entries","sort","a","b","getSearchHistory","searchHistory","timestamp","getTime","clearSearchHistory","localStorage","removeItem","saveHistoryToStorage","setItem","JSON","stringify","loadHistoryFromStorage","stored","getItem","parsed","parse","historyItem","id","toString","results_count","filter","unshift","currentCount","get","set","getSmartSuggestions","q","text","suggestion","props","__props","emit","__emit","router","useRouter","categoriesStore","useCategoriesStore","searchInput","ref","searchType","defaultType","isFocused","isExpanded","showSuggestions","showAdvanced","isSearching","selectedIndex","popularSearches","filters","priceMin","priceMax","tagQuery","availableTags","lastSearchResult","computed","allSuggestions","value","h","handleFocus","loadSuggestions","handleBlur","setTimeout","handleInput","debouncedLoadSuggestions","handleKeydown","event","preventDefault","min","max","selectSuggestion","performSearch","blur","async","useDebounceFn","trim","searchOptions","result","clearSearch","focus","clearHistory","toggleAdvanced","resetFilters","applyFilters","searchTags","getSuggestionIcon","FolderIcon","TagIcon","PackageIcon","TrendingUpIcon","getSuggestionTypeText","formatTime","date","diff","minutes","floor","hours","days","onMounted","autoFocus","nextTick","initialize","watch","__expose","clear","_createElementBlock","class","_normalizeClass","_createElementVNode","_hoisted_1","_hoisted_2","_createVNode","_unref","SearchIcon","$event","placeholder","onFocus","onBlur","onKeydown","onInput","_hoisted_4","onClick","XIcon","active","FilterIcon","_openBlock","_hoisted_5","_hoisted_6","_cache","_Fragment","_renderList","index","onMouseenter","_createBlock","_resolveDynamicComponent","_hoisted_8","_toDisplayString","_hoisted_9","_hoisted_10","history","ClockIcon","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","popular","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_vModelSelect","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","number","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","t","removeTag","_hoisted_32","find","addTag","style","_normalizeStyle","backgroundColor","color","_hoisted_34","_hoisted_35"],"mappings":"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","x_google_ignoreList":[0]}