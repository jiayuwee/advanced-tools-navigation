import{d as a,b as s,r as e,c as t,w as l,m as i,t as n,q as o,y as c,u as r,D as d,B as u,F as v,z as p,v as m,C as f,E as _,x as y,A as h,o as g,G as b,I as k,P as w}from"./vendor-C7R90qIp.js";import{e as x,X as C,h as D,g as M,m as U,_ as S,U as I,S as j,n as T}from"./index-DUEiWbog.js";import{H as L}from"./heart-zzT1MuiQ.js";import{D as V}from"./dollar-sign-Dghd6Re2.js";import{A as Z}from"./activity-DkjlO4-X.js";import{L as q}from"./loader-2-D74AwSgC.js";import{P as O}from"./pen-square-DIYEOrcu.js";import{S as P}from"./shopping-bag-DT3X0cxC.js";import{R as z}from"./refresh-cw-CcYtEXg4.js";import{D as A}from"./download-CKQmd1_0.js";import{S as B}from"./shield-BVfdVRYy.js";import{E as F}from"./eye-tRowYuDp.js";
/**
 * @license lucide-vue-next v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=x("BanIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]),Y=x("LogInIcon",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),$=x("UserCheckIcon",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),E=x("UserPlusIcon",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),N={class:"modal-header"},G={class:"modal-body"},J={key:0,class:"user-details"},Q={class:"info-section"},R={class:"info-grid"},X={class:"info-item"},K={class:"info-value"},W={class:"info-item"},aa={class:"info-value"},sa={class:"info-item"},ea={class:"info-value"},ta={class:"info-item"},la={class:"info-item"},ia={class:"info-item"},na={class:"info-value"},oa={class:"info-item"},ca={class:"info-value"},ra={class:"info-item"},da={key:0,class:"info-section"},ua={class:"info-grid"},va={class:"info-item"},pa={class:"info-value"},ma={class:"info-item"},fa={class:"avatar-container"},_a=["src","alt"],ya={key:1,class:"avatar-placeholder"},ha={class:"info-item"},ga={class:"info-value"},ba={class:"info-item"},ka={class:"info-value"},wa=["href"],xa={key:1},Ca={class:"info-item"},Da={class:"info-value"},Ma={class:"info-section"},Ua={class:"stats-grid"},Sa={class:"stat-card"},Ia={class:"stat-icon"},ja={class:"stat-content"},Ta={class:"stat-value"},La={class:"stat-card"},Va={class:"stat-icon"},Za={class:"stat-content"},qa={class:"stat-value"},Oa={class:"stat-card"},Pa={class:"stat-icon"},za={class:"stat-content"},Aa={class:"stat-value"},Ba={class:"stat-card"},Fa={class:"stat-icon"},Ha={class:"stat-content"},Ya={class:"stat-value"},$a={class:"info-section"},Ea={class:"activity-list"},Na={key:0,class:"no-activity"},Ga={class:"activity-icon"},Ja={class:"activity-content"},Qa={class:"activity-description"},Ra={class:"activity-time"},Xa={key:1,class:"loading-state"},Ka={class:"modal-footer"},Wa=S(a({__name:"UserDetailModal",props:{isVisible:{type:Boolean},user:{}},emits:["close","edit"],setup(a,{emit:g}){const b=a,k=g,w=s({favorites:0,orders:0,totalSpent:0,loginCount:0}),x=e([]);t(()=>b.isVisible&&!b.user),l(()=>b.user,a=>{a&&(j(a.id),T(a.id))},{immediate:!0});const S=()=>{k("close")},I=()=>{b.user&&k("edit",b.user)},j=async a=>{try{w.favorites=Math.floor(50*Math.random()),w.orders=Math.floor(20*Math.random()),w.totalSpent=Math.floor(1e4*Math.random()),w.loginCount=Math.floor(100*Math.random())}catch(s){console.error("加载用户统计失败:",s)}},T=async a=>{try{x.value=[{id:"1",type:"login",description:"用户登录系统",created_at:(new Date).toISOString()},{id:"2",type:"order",description:"创建了新订单",created_at:new Date(Date.now()-864e5).toISOString()},{id:"3",type:"favorite",description:"收藏了工具",created_at:new Date(Date.now()-1728e5).toISOString()}]}catch(s){console.error("加载用户活动失败:",s)}},z=a=>a?new Date(a).toLocaleString("zh-CN"):"未知",A=a=>({admin:"管理员",user:"普通用户",vip:"VIP用户"}[a]||a),B=a=>({active:"活跃",inactive:"非活跃",banned:"已封禁",pending:"待激活"}[a]||a),F=a=>{const s={login:Y,order:P,favorite:U,default:Z};return s[a]||s.default};return(a,s)=>{return a.isVisible?(h(),i("div",{key:0,class:"modal-overlay",onClick:S},[o("div",{class:"modal-content",onClick:s[0]||(s[0]=y(()=>{},["stop"]))},[o("div",N,[s[1]||(s[1]=o("h2",{class:"modal-title"},"用户详情",-1)),o("button",{class:"close-button",onClick:S},[c(r(C))])]),o("div",G,[a.user?(h(),i("div",J,[o("div",Q,[s[10]||(s[10]=o("h3",{class:"section-title"},"基本信息",-1)),o("div",R,[o("div",X,[s[2]||(s[2]=o("span",{class:"info-label"},"用户ID:",-1)),o("span",K,d(a.user.id),1)]),o("div",W,[s[3]||(s[3]=o("span",{class:"info-label"},"用户名:",-1)),o("span",aa,d(a.user.username||"未设置"),1)]),o("div",sa,[s[4]||(s[4]=o("span",{class:"info-label"},"邮箱:",-1)),o("span",ea,d(a.user.email),1)]),o("div",ta,[s[5]||(s[5]=o("span",{class:"info-label"},"角色:",-1)),o("span",{class:u(["info-value",(t=a.user.role,{admin:"text-red-600 font-semibold",vip:"text-purple-600 font-semibold",user:"text-blue-600"}[t]||"text-gray-600")])},d(A(a.user.role)),3)]),o("div",la,[s[6]||(s[6]=o("span",{class:"info-label"},"状态:",-1)),o("span",{class:u(["info-value",(e=a.user.status,{active:"text-green-600",inactive:"text-gray-600",banned:"text-red-600",pending:"text-yellow-600"}[e]||"text-gray-600")])},d(B(a.user.status)),3)]),o("div",ia,[s[7]||(s[7]=o("span",{class:"info-label"},"注册时间:",-1)),o("span",na,d(z(a.user.created_at)),1)]),o("div",oa,[s[8]||(s[8]=o("span",{class:"info-label"},"最后登录:",-1)),o("span",ca,d(z(a.user.last_sign_in_at)),1)]),o("div",ra,[s[9]||(s[9]=o("span",{class:"info-label"},"邮箱验证:",-1)),o("span",{class:u(["info-value",a.user.email_confirmed_at?"text-green-600":"text-red-600"])},d(a.user.email_confirmed_at?"已验证":"未验证"),3)])])]),a.user.user_profiles?(h(),i("div",da,[s[16]||(s[16]=o("h3",{class:"section-title"},"个人资料",-1)),o("div",ua,[o("div",va,[s[11]||(s[11]=o("span",{class:"info-label"},"显示名称:",-1)),o("span",pa,d(a.user.user_profiles.display_name||"未设置"),1)]),o("div",ma,[s[12]||(s[12]=o("span",{class:"info-label"},"头像:",-1)),o("div",fa,[a.user.user_profiles.avatar_url?(h(),i("img",{key:0,src:a.user.user_profiles.avatar_url,alt:a.user.user_profiles.display_name||a.user.username,class:"user-avatar"},null,8,_a)):(h(),i("div",ya,[c(r(D))]))])]),o("div",ha,[s[13]||(s[13]=o("span",{class:"info-label"},"个人简介:",-1)),o("span",ga,d(a.user.user_profiles.bio||"未设置"),1)]),o("div",ba,[s[14]||(s[14]=o("span",{class:"info-label"},"网站:",-1)),o("span",ka,[a.user.user_profiles.website?(h(),i("a",{key:0,href:a.user.user_profiles.website,target:"_blank",class:"link"},d(a.user.user_profiles.website),9,wa)):(h(),i("span",xa,"未设置"))])]),o("div",Ca,[s[15]||(s[15]=o("span",{class:"info-label"},"位置:",-1)),o("span",Da,d(a.user.user_profiles.location||"未设置"),1)])])])):n("",!0),o("div",Ma,[s[21]||(s[21]=o("h3",{class:"section-title"},"活动统计",-1)),o("div",Ua,[o("div",Sa,[o("div",Ia,[c(r(L))]),o("div",ja,[o("div",Ta,d(w.favorites||0),1),s[17]||(s[17]=o("div",{class:"stat-label"},"收藏工具",-1))])]),o("div",La,[o("div",Va,[c(r(M))]),o("div",Za,[o("div",qa,d(w.orders||0),1),s[18]||(s[18]=o("div",{class:"stat-label"},"订单数量",-1))])]),o("div",Oa,[o("div",Pa,[c(r(V))]),o("div",za,[o("div",Aa,"¥"+d(w.totalSpent||0),1),s[19]||(s[19]=o("div",{class:"stat-label"},"总消费",-1))])]),o("div",Ba,[o("div",Fa,[c(r(Z))]),o("div",Ha,[o("div",Ya,d(w.loginCount||0),1),s[20]||(s[20]=o("div",{class:"stat-label"},"登录次数",-1))])])])]),o("div",$a,[s[22]||(s[22]=o("h3",{class:"section-title"},"最近活动",-1)),o("div",Ea,[0===x.value.length?(h(),i("div",Na," 暂无活动记录 ")):(h(!0),i(v,{key:1},p(x.value,a=>(h(),i("div",{key:a.id,class:"activity-item"},[o("div",Ga,[(h(),m(f(F(a.type))))]),o("div",Ja,[o("div",Qa,d(a.description),1),o("div",Ra,d(z(a.created_at)),1)])]))),128))])])])):(h(),i("div",Xa,[c(r(q),{class:"animate-spin"}),s[23]||(s[23]=o("span",null,"加载用户信息中...",-1))]))]),o("div",Ka,[o("button",{class:"btn btn-secondary",onClick:S},"关闭"),o("button",{class:"btn btn-primary",onClick:I},[c(r(O)),s[24]||(s[24]=_(" 编辑用户 "))])])])])):n("",!0);var e,t}}}),[["__scopeId","data-v-bb487958"]]),as={class:"user-management-view"},ss={class:"page-header"},es={class:"header-actions"},ts={class:"stats-grid"},ls={class:"stat-card"},is={class:"stat-icon"},ns={class:"stat-content"},os={class:"stat-card"},cs={class:"stat-icon active"},rs={class:"stat-content"},ds={class:"stat-card"},us={class:"stat-icon admin"},vs={class:"stat-content"},ps={class:"stat-card"},ms={class:"stat-icon new"},fs={class:"stat-content"},_s={class:"filters-section"},ys={class:"search-box"},hs={class:"filter-controls"},gs={class:"users-table-container"},bs={key:0,class:"loading-state"},ks={key:1,class:"users-table"},ws={class:"user-info"},xs={class:"user-avatar"},Cs=["src","alt"],Ds={class:"user-details"},Ms={key:0,class:"username"},Us={class:"actions"},Ss=["onClick"],Is=["onClick"],js=["onClick"],Ts={class:"pagination"},Ls=["disabled"],Vs={class:"pagination-info"},Zs=["disabled"],qs=S(a({__name:"UserManagementView",setup(a){const l=e(!1),f=e([]),y=e(null),x=e(1),C=e(10),M=s({search:"",role:"",status:"",sort:"created_at_desc"}),U=t(()=>({totalUsers:f.value.length,activeUsers:f.value.filter(a=>a.is_active).length,adminUsers:f.value.filter(a=>"admin"===a.role||"super_admin"===a.role).length,newUsersThisMonth:f.value.filter(a=>{const s=new Date(a.created_at),e=new Date;return s.getMonth()===e.getMonth()&&s.getFullYear()===e.getFullYear()}).length})),S=t(()=>{let a=[...f.value];if(M.search){const s=M.search.toLowerCase();a=a.filter(a=>{var e,t;return a.email.toLowerCase().includes(s)||(null==(e=a.full_name)?void 0:e.toLowerCase().includes(s))||(null==(t=a.username)?void 0:t.toLowerCase().includes(s))})}if(M.role&&(a=a.filter(a=>a.role===M.role)),M.status){const s="active"===M.status;a=a.filter(a=>a.is_active===s)}return a.sort((a,s)=>{switch(M.sort){case"created_at_desc":return new Date(s.created_at).getTime()-new Date(a.created_at).getTime();case"created_at_asc":return new Date(a.created_at).getTime()-new Date(s.created_at).getTime();case"last_login_desc":return a.last_login_at?s.last_login_at?new Date(s.last_login_at).getTime()-new Date(a.last_login_at).getTime():-1:1;case"name_asc":return(a.full_name||a.email).localeCompare(s.full_name||s.email);default:return 0}}),a}),L=t(()=>Math.ceil(S.value.length/C.value)),V=t(()=>{const a=(x.value-1)*C.value,s=a+C.value;return S.value.slice(a,s)}),Z=async()=>{try{l.value=!0,f.value=[{id:"1",email:"admin@example.com",full_name:"系统管理员",username:"admin",role:"super_admin",is_active:!0,created_at:"2024-01-01T00:00:00Z",last_login_at:"2024-06-30T12:00:00Z"},{id:"2",email:"user@example.com",full_name:"普通用户",username:"user1",role:"user",is_active:!0,created_at:"2024-06-01T00:00:00Z",last_login_at:"2024-06-29T10:00:00Z"}]}catch(a){console.error("加载用户数据失败:",a)}finally{l.value=!1}},P=()=>{Z()},Y=()=>{console.log("导出用户数据")},N=a=>{const s=f.value.findIndex(s=>s.id===a.id);-1!==s&&(f.value[s]=a)},G=a=>{switch(a){case"super_admin":return"超级管理员";case"admin":return"管理员";case"user":return"普通用户";default:return"未知"}},J=a=>new Date(a).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});return g(()=>{Z()}),(a,s)=>(h(),i("div",as,[o("div",ss,[s[9]||(s[9]=o("div",null,[o("h1",null,"用户管理"),o("p",null,"管理系统用户，查看用户信息和活动状态")],-1)),o("div",es,[o("button",{class:"btn btn-secondary",onClick:P},[c(r(z),{class:"icon"}),s[7]||(s[7]=_(" 刷新 "))]),o("button",{class:"btn btn-primary",onClick:Y},[c(r(A),{class:"icon"}),s[8]||(s[8]=_(" 导出用户 "))])])]),o("div",ts,[o("div",ls,[o("div",is,[c(r(I))]),o("div",ns,[o("h3",null,d(U.value.totalUsers),1),s[10]||(s[10]=o("p",null,"总用户数",-1))])]),o("div",os,[o("div",cs,[c(r($))]),o("div",rs,[o("h3",null,d(U.value.activeUsers),1),s[11]||(s[11]=o("p",null,"活跃用户",-1))])]),o("div",ds,[o("div",us,[c(r(B))]),o("div",vs,[o("h3",null,d(U.value.adminUsers),1),s[12]||(s[12]=o("p",null,"管理员",-1))])]),o("div",ps,[o("div",ms,[c(r(E))]),o("div",fs,[o("h3",null,d(U.value.newUsersThisMonth),1),s[13]||(s[13]=o("p",null,"本月新增",-1))])])]),o("div",_s,[o("div",ys,[c(r(j),{class:"search-icon"}),b(o("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>M.search=a),type:"text",placeholder:"搜索用户名、邮箱...",class:"search-input"},null,512),[[k,M.search]])]),o("div",hs,[b(o("select",{"onUpdate:modelValue":s[1]||(s[1]=a=>M.role=a),class:"filter-select"},s[14]||(s[14]=[o("option",{value:""},"所有角色",-1),o("option",{value:"user"},"普通用户",-1),o("option",{value:"admin"},"管理员",-1),o("option",{value:"super_admin"},"超级管理员",-1)]),512),[[w,M.role]]),b(o("select",{"onUpdate:modelValue":s[2]||(s[2]=a=>M.status=a),class:"filter-select"},s[15]||(s[15]=[o("option",{value:""},"所有状态",-1),o("option",{value:"active"},"活跃",-1),o("option",{value:"inactive"},"非活跃",-1)]),512),[[w,M.status]]),b(o("select",{"onUpdate:modelValue":s[3]||(s[3]=a=>M.sort=a),class:"filter-select"},s[16]||(s[16]=[o("option",{value:"created_at_desc"},"最新注册",-1),o("option",{value:"created_at_asc"},"最早注册",-1),o("option",{value:"last_login_desc"},"最近登录",-1),o("option",{value:"name_asc"},"姓名 A-Z",-1)]),512),[[w,M.sort]])])]),o("div",gs,[l.value?(h(),i("div",bs,[c(r(q),{class:"loading-icon"}),s[17]||(s[17]=o("p",null,"加载用户数据中...",-1))])):(h(),i("table",ks,[s[18]||(s[18]=o("thead",null,[o("tr",null,[o("th",null,"用户信息"),o("th",null,"角色"),o("th",null,"状态"),o("th",null,"注册时间"),o("th",null,"最后登录"),o("th",null,"操作")])],-1)),o("tbody",null,[(h(!0),i(v,null,p(V.value,a=>(h(),i("tr",{key:a.id,class:"user-row"},[o("td",ws,[o("div",xs,[a.avatar_url?(h(),i("img",{key:0,src:a.avatar_url,alt:a.full_name||a.email},null,8,Cs)):(h(),m(r(D),{key:1}))]),o("div",Ds,[o("h4",null,d(a.full_name||"未设置姓名"),1),o("p",null,d(a.email),1),a.username?(h(),i("span",Ms,"@"+d(a.username),1)):n("",!0)])]),o("td",null,[o("span",{class:u(["role-badge",a.role])},d(G(a.role)),3)]),o("td",null,[o("span",{class:u(["status-badge",a.is_active?"active":"inactive"])},d(a.is_active?"活跃":"非活跃"),3)]),o("td",null,d(J(a.created_at)),1),o("td",null,d(a.last_login_at?J(a.last_login_at):"从未登录"),1),o("td",Us,[o("button",{class:"action-btn view",onClick:s=>(a=>{y.value=a})(a)},[c(r(F))],8,Ss),o("button",{class:"action-btn edit",onClick:s=>(a=>{y.value=a})(a)},[c(r(O))],8,Is),"super_admin"!==a.role?(h(),i("button",{key:0,class:u(["action-btn",a.is_active?"disable":"enable"]),onClick:s=>(async a=>{try{a.is_active=!a.is_active,console.log(`用户 ${a.email} 状态已${a.is_active?"激活":"禁用"}`)}catch(s){console.error("切换用户状态失败:",s)}})(a)},[a.is_active?(h(),m(r(H),{key:0})):(h(),m(r(T),{key:1}))],10,js)):n("",!0)])]))),128))])]))]),o("div",Ts,[o("button",{disabled:1===x.value,class:"pagination-btn",onClick:s[4]||(s[4]=a=>x.value--)}," 上一页 ",8,Ls),o("span",Vs," 第 "+d(x.value)+" 页，共 "+d(L.value)+" 页 ",1),o("button",{disabled:x.value===L.value,class:"pagination-btn",onClick:s[5]||(s[5]=a=>x.value++)}," 下一页 ",8,Zs)]),y.value?(h(),m(Wa,{key:0,user:y.value,onClose:s[6]||(s[6]=a=>y.value=null),onUpdated:N},null,8,["user"])):n("",!0)]))}}),[["__scopeId","data-v-c4acf35b"]]);
/**
 * @license lucide-vue-next v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */export{qs as default};
