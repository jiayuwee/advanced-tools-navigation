import{r as e,c as a,d as s,w as t,m as l,B as r,q as c,y as o,u as i,t as n,G as u,P as v,F as d,z as p,D as g,I as h,N as m,E as y,H as f,v as k,A as b,o as C,X as w,x as _}from"./vendor-C7R90qIp.js";import{e as U,u as x,a as S,X as F,m as O,C as L,S as E,_ as j,I as q,E as I,c as V,d as A}from"./index-C3iyAWwk.js";import{T as B}from"./trending-up-D0iuXJ84.js";import{F as T,a as D}from"./folder-D_DduQsO.js";import{G as H,L as R}from"./list-vBPZZXtB.js";import{E as M}from"./eye-C1GTx_f1.js";
/**
 * @license lucide-vue-next v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=U("ArrowDownIcon",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),Q=U("ArrowUpIcon",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),$=U("RotateCcwIcon",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);
/**
 * @license lucide-vue-next v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function G(){const s=x(),t=e(""),l=e({category:"",tags:[],rating:0,isFeatured:!1,hasUrl:!1,sortBy:"name",sortOrder:"asc"}),r=e([]),c=e(!1),o=a(()=>{if(!s.tools.length)return[];c.value=!0;try{let e=((e,a)=>{if(!e.trim())return a.map(e=>({item:e,score:1,matches:[]}));const s=e.toLowerCase().split(/\s+/).filter(e=>e.length>0),t=[];return a.forEach(e=>{let a=0;const l=[],r=[{field:"name",weight:10},{field:"description",weight:5},{field:"tags",weight:3},{field:"categories.name",weight:2}];s.forEach(s=>{var t;r.forEach(({field:t,weight:r})=>{const c=u(e,t);c&&v(c,s)&&(a+=r,l.includes(t)||l.push(t))}),d((null==(t=e.name)?void 0:t.toLowerCase())||"",s)&&(a+=2)}),e.is_featured&&(a+=1),e.average_rating&&e.average_rating>4&&(a+=1),a>0&&t.push({item:e,score:a,matches:l})}),t.sort((e,a)=>a.score-e.score)})(t.value,s.tools);return e=(e=>e.filter(({item:e})=>{if(l.value.category&&e.category_id!==l.value.category)return!1;if(l.value.tags.length>0){const a=e.tags||[];if(!l.value.tags.some(e=>a.some(a=>a.toLowerCase().includes(e.toLowerCase()))))return!1}return!(l.value.rating>0&&(e.average_rating||0)<l.value.rating)&&!(l.value.isFeatured&&!e.is_featured||!(!l.value.hasUrl||e.url&&e.url.trim()))}))(e),e=(e=>e.sort((e,a)=>{const{sortBy:s,sortOrder:t}=l.value;let r=0;switch(s){case"name":r=(e.item.name||"").localeCompare(a.item.name||"");break;case"rating":r=(e.item.average_rating||0)-(a.item.average_rating||0);break;case"clicks":r=(e.item.click_count||0)-(a.item.click_count||0);break;case"created_at":r=new Date(e.item.created_at||0).getTime()-new Date(a.item.created_at||0).getTime();break;default:r=a.score-e.score}return"desc"===t?-r:r}))(e),e}finally{c.value=!1}}),i=a(()=>{if(!t.value.trim())return[];const e=t.value.toLowerCase(),a=new Set;return s.tools.forEach(s=>{var t;(null==(t=s.name)?void 0:t.toLowerCase().includes(e))&&a.add(s.name),s.tags&&s.tags.forEach(s=>{s.toLowerCase().includes(e)&&a.add(s)})}),Array.from(a).slice(0,5)}),n=a(()=>{const e=r.value.reduce((e,a)=>(e[a]=(e[a]||0)+1,e),{});return Object.entries(e).sort(([,e],[,a])=>a-e).slice(0,10).map(([e])=>e)}),u=(e,a)=>a.split(".").reduce((e,a)=>null==e?void 0:e[a],e),v=(e,a)=>Array.isArray(e)?e.some(e=>"string"==typeof e&&e.toLowerCase().includes(a)):"string"==typeof e&&e.toLowerCase().includes(a),d=(e,a)=>{const s=a.length,t=e.length;if(s>t)return!1;if(s===t)return a===e;let l=0;for(let r=0;r<t&&l<s;r++)e[r]===a[l]&&l++;return l===s};return{searchQuery:t,filters:l,searchResults:o,searchSuggestions:i,popularSearches:n,searchHistory:r,isSearching:c,search:e=>{t.value=e,e.trim()&&!r.value.includes(e)&&(r.value.unshift(e),r.value.length>50&&(r.value=r.value.slice(0,50)))},clearSearch:()=>{t.value=""},resetFilters:()=>{l.value={category:"",tags:[],rating:0,isFeatured:!1,hasUrl:!1,sortBy:"name",sortOrder:"asc"}}}}const N={class:"panel-header"},P={class:"panel-content"},W={class:"filter-group"},K=["value"],X={class:"filter-group"},J={class:"tags-container"},Y={class:"popular-tags"},Z=["onClick"],ee={key:0,class:"selected-tags"},ae=["onClick"],se={class:"filter-group"},te={class:"rating-filter"},le={class:"rating-stars"},re={class:"rating-text"},ce={class:"filter-group"},oe={class:"checkbox-group"},ie={class:"checkbox-item"},ne={class:"checkbox-item"},ue={class:"filter-group"},ve={class:"sort-options"},de=["title"],pe={key:0,class:"filter-group"},ge={class:"search-history"},he=["onClick"],me={key:1,class:"filter-group"},ye={class:"popular-searches"},fe=["onClick"],ke={class:"panel-footer"},be=j(s({__name:"AdvancedSearchPanel",props:{isOpen:{type:Boolean},filters:{},searchHistory:{},popularSearches:{}},emits:["close","update:filters","search"],setup(s,{emit:C}){const w=s,_=C,U=x(),j=S(),q=e(""),I=e({...w.filters});t(()=>w.filters,e=>{I.value={...e}},{deep:!0});const V=a(()=>j.categories),A=a(()=>{const e=new Map;return U.tools.forEach(a=>{a.tags&&a.tags.forEach(a=>{e.set(a,(e.get(a)||0)+1)})}),Array.from(e.entries()).sort(([,e],[,a])=>a-e).slice(0,10).map(([e])=>e)}),T=()=>{const e=q.value.trim();e&&!I.value.tags.includes(e)&&(I.value.tags.push(e),q.value="")},D=e=>{I.value.rating=e},H=()=>{I.value.sortOrder="asc"===I.value.sortOrder?"desc":"asc"},R=()=>{I.value={category:"",tags:[],rating:0,isFeatured:!1,hasUrl:!1,sortBy:"name",sortOrder:"asc"},M()},M=()=>{_("update:filters",{...I.value})};return t(I,()=>{M()},{deep:!0}),(e,a)=>{return b(),l("div",{class:r(["advanced-search-panel",{"is-open":e.isOpen}])},[c("div",N,[a[7]||(a[7]=c("h3",null,"高级搜索",-1)),c("button",{class:"close-button",onClick:a[0]||(a[0]=a=>e.$emit("close"))},[o(i(F),{class:"icon"})])]),c("div",P,[c("div",W,[a[9]||(a[9]=c("label",{class:"filter-label"},"分类",-1)),u(c("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>I.value.category=e),class:"filter-select"},[a[8]||(a[8]=c("option",{value:""},"所有分类",-1)),(b(!0),l(d,null,p(V.value,e=>(b(),l("option",{key:e.id,value:e.id},g(e.name),9,K))),128))],512),[[v,I.value.category]])]),c("div",X,[a[12]||(a[12]=c("label",{class:"filter-label"},"标签",-1)),c("div",J,[c("div",Y,[a[10]||(a[10]=c("span",{class:"tags-subtitle"},"热门标签:",-1)),(b(!0),l(d,null,p(A.value,e=>(b(),l("button",{key:e,class:r(["tag-button",{active:I.value.tags.includes(e)}]),onClick:a=>(e=>{const a=I.value.tags.indexOf(e);a>-1?I.value.tags.splice(a,1):I.value.tags.push(e)})(e)},g(e),11,Z))),128))]),u(c("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>q.value=e),placeholder:"输入自定义标签...",class:"tag-input",onKeydown:m(T,["enter"])},null,544),[[h,q.value]]),I.value.tags.length>0?(b(),l("div",ee,[a[11]||(a[11]=c("span",{class:"tags-subtitle"},"已选标签:",-1)),(b(!0),l(d,null,p(I.value.tags,e=>(b(),l("span",{key:e,class:"selected-tag"},[y(g(e)+" ",1),c("button",{class:"tag-remove",onClick:a=>(e=>{const a=I.value.tags.indexOf(e);a>-1&&I.value.tags.splice(a,1)})(e)},"×",8,ae)]))),128))])):n("",!0)])]),c("div",se,[a[13]||(a[13]=c("label",{class:"filter-label"},"最低评分",-1)),c("div",te,[c("div",le,[(b(),l(d,null,p(5,e=>o(i(O),{key:e,class:r([{filled:e<=I.value.rating},"star"]),onClick:a=>D(e)},null,8,["class","onClick"])),64))]),c("span",re,g((s=I.value.rating,["不限","1星以上","2星以上","3星以上","4星以上","5星"][s]||"不限")),1),I.value.rating>0?(b(),l("button",{key:0,class:"clear-rating",onClick:a[3]||(a[3]=e=>D(0))}," 清除 ")):n("",!0)])]),c("div",ce,[a[16]||(a[16]=c("label",{class:"filter-label"},"特殊筛选",-1)),c("div",oe,[c("label",ie,[u(c("input",{"onUpdate:modelValue":a[4]||(a[4]=e=>I.value.isFeatured=e),type:"checkbox"},null,512),[[f,I.value.isFeatured]]),a[14]||(a[14]=c("span",{class:"checkbox-label"},"仅显示特色工具",-1))]),c("label",ne,[u(c("input",{"onUpdate:modelValue":a[5]||(a[5]=e=>I.value.hasUrl=e),type:"checkbox"},null,512),[[f,I.value.hasUrl]]),a[15]||(a[15]=c("span",{class:"checkbox-label"},"仅显示可访问工具",-1))])])]),c("div",ue,[a[18]||(a[18]=c("label",{class:"filter-label"},"排序方式",-1)),c("div",ve,[u(c("select",{"onUpdate:modelValue":a[6]||(a[6]=e=>I.value.sortBy=e),class:"sort-select"},a[17]||(a[17]=[c("option",{value:"name"},"名称",-1),c("option",{value:"rating"},"评分",-1),c("option",{value:"clicks"},"使用次数",-1),c("option",{value:"created_at"},"创建时间",-1)]),512),[[v,I.value.sortBy]]),c("button",{class:"sort-order-button",title:"asc"===I.value.sortOrder?"升序":"降序",onClick:H},["asc"===I.value.sortOrder?(b(),k(i(Q),{key:0,class:"icon"})):(b(),k(i(z),{key:1,class:"icon"}))],8,de)])]),e.searchHistory.length>0?(b(),l("div",pe,[a[19]||(a[19]=c("label",{class:"filter-label"},"搜索历史",-1)),c("div",ge,[(b(!0),l(d,null,p(e.searchHistory.slice(0,5),(a,s)=>(b(),l("button",{key:s,class:"history-item",onClick:s=>e.$emit("search",a)},[o(i(L),{class:"icon"}),y(" "+g(a),1)],8,he))),128))])])):n("",!0),e.popularSearches.length>0?(b(),l("div",me,[a[20]||(a[20]=c("label",{class:"filter-label"},"热门搜索",-1)),c("div",ye,[(b(!0),l(d,null,p(e.popularSearches.slice(0,5),a=>(b(),l("button",{key:a,class:"popular-item",onClick:s=>e.$emit("search",a)},[o(i(B),{class:"icon"}),y(" "+g(a),1)],8,fe))),128))])])):n("",!0)]),c("div",ke,[c("button",{class:"reset-button",onClick:R},[o(i($),{class:"icon"}),a[21]||(a[21]=y(" 重置筛选 "))]),c("button",{class:"apply-button",onClick:M},[o(i(E),{class:"icon"}),a[22]||(a[22]=y(" 应用筛选 "))])])],2);var s}}}),[["__scopeId","data-v-9fc794f0"]]),Ce={class:"tools-view"},we={class:"filters-bar"},_e={class:"filters-content"},Ue={class:"filter-group search-group"},xe={class:"search-container"},Se={class:"filter-group"},Fe={class:"filter-group"},Oe={class:"filter-group"},Le={class:"view-options"},Ee={class:"results-info"},je={class:"results-count"},qe={class:"tools-content"},Ie={key:0,class:"loading-state"},Ve={key:1,class:"error-state"},Ae={key:2,class:"tools-grid"},Be={class:"card-header"},Te={class:"tool-icon"},De=["onClick"],He={class:"card-content"},Re={class:"tool-name"},Me={class:"tool-description"},ze={class:"tool-tags"},Qe={key:0,class:"tag more"},$e={class:"card-footer"},Ge={class:"tool-stats"},Ne={class:"stat"},Pe={class:"stat"},We={class:"tool-actions"},Ke=["onClick"],Xe=["onClick"],Je={key:3,class:"tools-list"},Ye=["onClick"],Ze={class:"item-left"},ea={class:"tool-icon"},aa={class:"tool-info"},sa={class:"tool-name"},ta={class:"tool-description"},la={class:"tool-meta"},ra={class:"category"},ca={class:"clicks"},oa={class:"item-right"},ia={class:"tool-tags"},na={class:"tool-actions"},ua=["onClick"],va={key:4,class:"empty-state"},da={key:0},pa={key:1},ga={key:2},ha={class:"empty-actions"},ma=j(s({__name:"ToolsView",setup(s){const m=A(),f=V(),k=x(),{searchQuery:U,filters:S,searchResults:L,popularSearches:j,searchHistory:B,search:z,clearSearch:Q}=G(),$=e(),N=e("all"),P=e("name"),W=e(!1),K=e(!1),X=e("grid"),J=a(()=>{if(U.value.trim())return L.value.map(e=>e.item);let e=k.filteredTools;return K.value&&console.warn("收藏功能尚未完全实现"),e=[...e].sort((e,a)=>{switch(P.value){case"click_count":return a.click_count-e.click_count;case"created_at":return new Date(a.created_at).getTime()-new Date(e.created_at).getTime();default:return e.name.localeCompare(a.name)}}),e}),Y=()=>{k.setSearchQuery(U.value)},Z=e=>{Object.assign(S,e)},ee=e=>{z(e),W.value=!1},ae=async e=>{if(console.log("点击工具:",e.name,"URL:",e.url),!e.url||""===e.url.trim())return console.warn("工具URL为空:",e),void alert("该工具暂无可用链接");try{let a=e.url.trim();a.startsWith("http://")||a.startsWith("https://")||(a="https://"+a),await k.incrementClickCount(e.id),window.open(a,"_blank","noopener,noreferrer")}catch(a){console.error("打开链接失败:",a),alert("无法打开该链接，请检查URL是否正确")}},se=async()=>{k.clearError(),await k.initialize()};return t(()=>m.query,e=>{e.category&&"string"==typeof e.category&&(N.value=e.category),e.search&&"string"==typeof e.search&&(U.value=e.search,k.setSearchQuery(e.search))},{immediate:!0}),t(N,e=>{k.setSelectedCategory(e);const a={...m.query};"all"===e?delete a.category:a.category=e,f.replace({query:a})}),t(U,e=>{const a={...m.query};e?a.search=e:delete a.search,f.replace({query:a})}),C(async()=>{k.initialized||await k.initialize()}),(e,a)=>(b(),l("div",Ce,[c("div",we,[c("div",_e,[c("div",Ue,[c("div",xe,[o(i(E),{class:"search-icon"}),u(c("input",{ref_key:"searchInput",ref:$,"onUpdate:modelValue":a[0]||(a[0]=e=>w(U)?U.value=e:null),type:"text",placeholder:"搜索工具...",class:"search-input",onInput:Y,onFocus:a[1]||(a[1]=e=>W.value=!1)},null,544),[[h,i(U)]]),i(U)?(b(),l("button",{key:0,class:"clear-search",onClick:a[2]||(a[2]=(...e)=>i(Q)&&i(Q)(...e))},[o(i(F),{class:"icon"})])):n("",!0),c("button",{class:r(["advanced-search-button",{active:W.value}]),title:"高级搜索",onClick:a[3]||(a[3]=e=>W.value=!W.value)},[o(i(T),{class:"icon"})],2),o(be,{"is-open":W.value,filters:i(S),"search-history":i(B),"popular-searches":i(j),onClose:a[4]||(a[4]=e=>W.value=!1),"onUpdate:filters":Z,onSearch:ee},null,8,["is-open","filters","search-history","popular-searches"])])]),c("div",Se,[a[12]||(a[12]=c("label",{class:"filter-label"},"排序：",-1)),u(c("select",{"onUpdate:modelValue":a[5]||(a[5]=e=>P.value=e),class:"filter-select"},a[11]||(a[11]=[c("option",{value:"name"},"名称",-1),c("option",{value:"click_count"},"热度",-1),c("option",{value:"created_at"},"最新",-1)]),512),[[v,P.value]])]),c("div",Fe,[c("button",{class:r(["filter-button",{active:K.value}]),onClick:a[6]||(a[6]=e=>K.value=!K.value)},[o(i(O),{class:"icon"}),a[13]||(a[13]=y(" 只看收藏 "))],2)]),c("div",Oe,[c("div",Le,[c("button",{class:r(["view-button",{active:"grid"===X.value}]),onClick:a[7]||(a[7]=e=>X.value="grid")},[o(i(H),{class:"icon"})],2),c("button",{class:r(["view-button",{active:"list"===X.value}]),onClick:a[8]||(a[8]=e=>X.value="list")},[o(i(R),{class:"icon"})],2)])]),c("div",Ee,[c("span",je," 找到 "+g(J.value.length)+" 个工具 ",1)])])]),c("div",qe,[i(k).loading?(b(),l("div",Ie,a[14]||(a[14]=[c("div",{class:"loading-spinner"},null,-1),c("p",null,"正在加载工具...",-1)]))):i(k).error?(b(),l("div",Ve,[a[15]||(a[15]=c("div",{class:"error-icon"},"❌",-1)),a[16]||(a[16]=c("h3",null,"加载失败",-1)),c("p",null,g(i(k).error),1),c("button",{class:"retry-button",onClick:se},"重试")])):J.value.length>0&&"grid"===X.value?(b(),l("div",Ae,[(b(!0),l(d,null,p(J.value,e=>{var a;return b(),l("div",{key:e.id,class:"tool-card"},[c("div",Be,[c("div",Te,g(e.icon||"🔧"),1),c("button",{class:r(["favorite-button",{active:e.isFavorite}]),onClick:_(a=>i(k).toggleFavorite(e.id),["stop"])},[o(i(O),{class:"icon"})],10,De)]),c("div",He,[c("h3",Re,g(e.name),1),c("p",Me,g(e.description),1),c("div",ze,[(b(!0),l(d,null,p((e.tags||[]).slice(0,3),e=>(b(),l("span",{key:e,class:"tag"},g(e),1))),128)),(e.tags||[]).length>3?(b(),l("span",Qe," +"+g((e.tags||[]).length-3),1)):n("",!0)])]),c("div",$e,[c("div",Ge,[c("span",Ne,[o(i(M),{class:"stat-icon"}),y(" "+g(e.click_count||0),1)]),c("span",Pe,[o(i(D),{class:"stat-icon"}),y(" "+g((null==(a=e.categories)?void 0:a.name)||"未分类"),1)])]),c("div",We,[c("button",{class:"detail-button",title:"查看详情",onClick:_(a=>{return s=e.id,void f.push(`/tools/${s}`);var s},["stop"])},[o(i(q),{class:"icon"})],8,Ke),c("button",{class:"visit-button",title:"访问工具",onClick:_(a=>ae(e),["stop"])},[o(i(I),{class:"icon"})],8,Xe)])])])}),128))])):J.value.length>0&&"list"===X.value?(b(),l("div",Je,[(b(!0),l(d,null,p(J.value,e=>(b(),l("div",{key:e.id,class:"tool-item",onClick:a=>ae(e)},[c("div",Ze,[c("div",ea,g(e.icon||"🔧"),1),c("div",aa,[c("h3",sa,g(e.name),1),c("p",ta,g(e.description),1),c("div",la,[c("span",ra,g(e.category.name),1),a[17]||(a[17]=c("span",{class:"separator"},"•",-1)),c("span",ca,g(e.clickCount)+" 次访问",1)])])]),c("div",oa,[c("div",ia,[(b(!0),l(d,null,p((e.tags||[]).slice(0,2),e=>(b(),l("span",{key:e,class:"tag"},g(e),1))),128))]),c("div",na,[c("button",{class:r(["favorite-button",{active:e.isFavorite}]),onClick:_(a=>i(k).toggleFavorite(e.id),["stop"])},[o(i(O),{class:"icon"})],10,ua),o(i(I),{class:"external-icon"})])])],8,Ye))),128))])):(b(),l("div",va,[a[18]||(a[18]=c("div",{class:"empty-icon"},"🔍",-1)),a[19]||(a[19]=c("h3",null,"未找到相关工具",-1)),i(U)?(b(),l("p",da,' 没有找到包含 "'+g(i(U))+'" 的工具，尝试使用其他关键词搜索 ',1)):"all"!==N.value?(b(),l("p",pa," 该分类下暂无工具，请选择其他分类 ")):(b(),l("p",ga,"暂无工具数据，请稍后再试")),c("div",ha,[i(U)?(b(),l("button",{key:0,class:"btn btn-primary",onClick:a[9]||(a[9]=(...e)=>i(Q)&&i(Q)(...e))}," 清除搜索条件 ")):n("",!0),"all"!==N.value?(b(),l("button",{key:1,class:"btn btn-secondary",onClick:a[10]||(a[10]=e=>N.value="all")}," 查看全部分类 ")):n("",!0)])]))])]))}}),[["__scopeId","data-v-5be087d0"]]);export{ma as default};
