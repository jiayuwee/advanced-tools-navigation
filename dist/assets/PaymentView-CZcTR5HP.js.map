{"version":3,"mappings":";swCAsKA,MAAMA,EAASC,IACTC,GAAQC,IAGRC,GAAUC,GAAI,GACdC,GAAQD,EAAmB,MAC3BE,GAAiBF,EAAI,IAErBG,GAAaH,EAAI,CACrB,CACEI,GAAI,IACJC,KAAM,SACNC,YAAa,gBACbC,SAAU,EACVC,MAAO,IACPC,MAAO,sBAILC,GAAcV,EAAI,CACtBW,UAAW,GACXC,MAAO,GACPC,QAAS,GACTC,KAAM,GACNC,QAAS,GACTC,YAAa,KAGTC,GAAiB,CACrB,CACEb,GAAI,SACJC,KAAM,MACNC,YAAa,cACbY,KAAM,uBAER,CACEd,GAAI,SACJC,KAAM,OACNC,YAAa,aACbY,KAAM,uBAER,CACEd,GAAI,SACJC,KAAM,MACNC,YAAa,uBACbY,KAAM,wBAKJC,GAAWC,EAAS,IACjBjB,GAAWkB,MAAMC,OACtB,CAACC,EAAKC,IAASD,EAAMC,EAAKhB,MAAQgB,EAAKjB,SACvC,IAIEkB,GAAWL,EAAS,IAAM,GAE1BM,GAAcN,EAAS,IAAMD,GAASE,MAAQI,GAASJ,OAEvDM,GAASP,EAAS,IAEpBlB,GAAemB,OACfX,GAAYW,MAAMV,WAClBD,GAAYW,MAAMT,OAClBF,GAAYW,MAAMR,SAClBH,GAAYW,MAAMP,MAClBJ,GAAYW,MAAMN,SAwBhBa,cAAgBC,UACpB,IACE9B,GAAQsB,OAAQ,EAChBpB,GAAMoB,MAAQ,KAGd,MAAMS,aAAEA,SAAiBC,EAAAF,UAAA,MAAAC,sBAAME,OAAO,mGAChCC,eAAEA,SAAmBF,EAAAF,UAAA,MAAAI,wBAAMD,OAAO,+EAClCE,aAAEA,SAAiBH,EAAAF,UAAA,MAAAK,sBAAMF,OAAO,uBAAeG,KAAAC,KAAAC,qEAE/CC,EAAYJ,IAClB,IAAKI,EAAUC,KACb,MAAM,IAAIC,MAAM,QAIlB,IAAIC,EAAU5C,GAAM6C,MAAMC,MAE1B,IAAKF,EAAS,CAEZ,MAAMG,EAAY/C,GAAM6C,MAAMG,QAC9B,IAAKD,EACH,MAAM,IAAIJ,MAAM,UAGlB,MAAMM,EAAY,CAChBC,WAAYH,EACZrC,SAAU,EACVyC,gBAAiBtC,GAAYW,OAO/BoB,SAJuBX,EAAamB,YAClCH,EACAR,EAAUC,KAAKnC,KAEEA,EACrB,CAGA,MAAM8C,QAAsBjB,EAAekB,eAAe,CACxDC,SAAUX,EACVY,eAAgBnD,GAAemB,MAC/BiC,WAAY,OAAOC,KAAKC,QACxBC,OAAQ/B,GAAYL,OACnBnB,GAAemB,OAElB,IAAI6B,EAAcQ,QAIhB,MAAM,IAAIlB,MAAMU,EAAcS,SAAW,cAFnCC,sBAAsBnB,EAIhC,OAASoB,GACP5D,GAAMoB,MAAQwC,aAAerB,MAAQqB,EAAIF,QAAU,UACrD,SACE5D,GAAQsB,OAAQ,CAClB,GAKIuC,sBAAwB/B,MAAOY,IACnC,MAAMX,aAAEA,SAAiBC,EAAAF,UAAA,MAAAC,sBAAME,OAAO,8BAAyB,OAAAF,iBAAAgC,uCAAAC,WAGzDjC,EAAaqB,eAAe,CAChCC,SAAUX,EACVY,eAAgBnD,GAAemB,MAC/BiC,WAAY,OAAOC,KAAKC,QACxBC,OAAQ/B,GAAYL,QAItB1B,EAAOqE,KAAK,CACVC,KAAM,mBACNvB,MAAO,CACLC,MAAOF,EACPgB,OAAQ/B,GAAYL,MAAM6C,eAK1BC,OAAS,KACbxE,EAAOyE,IAAG,WAIZC,EAAU,KA1GYxC,WACpB,IACE,MAAMe,EAAY/C,GAAM6C,MAAMG,QACxBJ,EAAU5C,GAAM6C,MAAMC,MAExBC,EAEF0B,QAAQC,IAAI,WAAY3B,GAEfH,GAET6B,QAAQC,IAAI,UAAW9B,EAG3B,OAASoB,GACP5D,GAAMoB,MAAQ,UAChB,GA2FAmD,GAEIvD,GAAewD,OAAS,IAC1BvE,GAAemB,MAAQJ,GAAe,GAAGb,cA5V3CsE,IAAAC,EA6JM,MA7JNC,EA6JM,CA5JJC,EA2JM,MA3JNC,EA2JM,eA1JJD,EAGM,OAHDE,MAAM,kBAAgB,CACzBF,EAAa,UAAT,QACJA,EAAkB,SAAf,qBAGLA,EAoJM,MApJNG,EAoJM,CAlJJH,EAgCM,MAhCNI,EAgCM,CA/BJC,EAAA,KAAAA,EAAA,GAAAL,EAAa,UAAT,QAAI,IACRA,EAcM,MAdNM,EAcM,QAbJR,EAYMS,EAAA,KAAAC,EAZclF,GAAAkB,MAARG,QAAZmD,EAYM,OAZ2BW,IAAK9D,EAAKpB,GAAI2E,MAAM,eACnDF,EAEM,MAFNU,EAEM,CADJV,EAA0C,OAApCW,IAAKhE,EAAKf,MAAQgF,IAAKjE,EAAKnB,kBAEpCwE,EAOM,MAPNa,EAOM,CANJb,EAA0C,KAA1Cc,EAA0CC,EAAjBpE,EAAKnB,MAAI,GAClCwE,EAAsD,IAAtDgB,EAAsDD,EAAvBpE,EAAKlB,aAAW,GAC/CuE,EAGM,MAHNiB,EAGM,CAFJjB,EAA0D,OAA1DkB,EAA4B,OAAIH,EAAGpE,EAAKjB,UAAQ,GAChDsE,EAAiD,OAAjDmB,EAAyB,IAACJ,EAAGpE,EAAKhB,OAAK,mBAM/CqE,EAaM,MAbNoB,EAaM,CAZJpB,EAGM,MAHNqB,EAGM,CAFJhB,EAAA,KAAAA,EAAA,GAAAL,EAAiB,YAAX,QAAI,IACVA,EAA4B,YAAtB,IAACe,EAAGzE,GAAAE,OAAQ,KAEpBwD,EAGM,MAHNsB,EAGM,CAFJjB,EAAA,KAAAA,EAAA,GAAAL,EAAiB,YAAX,QAAI,IACVA,EAA8C,OAA9CuB,EAAuB,OAAK3E,GAAAJ,OAAQ,KAEtCwD,EAGM,MAHNwB,EAGM,CAFJnB,EAAA,KAAAA,EAAA,GAAAL,EAAiB,YAAX,QAAI,IACVA,EAAoD,OAApDyB,EAA2B,MAAI5E,GAAAL,OAAW,SAMhDwD,EA6BM,MA7BN0B,EA6BM,CA5BJrB,EAAA,MAAAA,EAAA,IAAAL,EAAe,UAAX,UAAM,IACVA,EA0BM,MA1BN2B,EA0BM,MAzBJ7B,EAwBQS,EAAA,KAAAC,EAvBWpE,GAAVwF,GADT5B,EAwBQ,SAtBLS,IAAKmB,EAAOrG,GACb2E,SAAM,gBAAe,CAAA2B,SACDxG,WAAmBuG,EAAOrG,UAE9CyE,EAKE,8CAJS3E,GAAcmB,MAAAsF,GACvBC,KAAK,QACJvF,MAAOoF,EAAOrG,GACfC,KAAK,+BAHIH,GAAAmB,SAKXwD,EAWM,MAXNgC,EAWM,CAVJhC,EAEM,MAFNiC,EAEM,CADJjC,EAA6C,OAAvCW,IAAKiB,EAAOvF,KAAOuE,IAAKgB,EAAOpG,kBAEvCwE,EAGM,MAHNkC,EAGM,CAFJlC,EAAgD,MAAhDmC,EAAgDpB,EAApBa,EAAOpG,MAAI,GACvCwE,EAA8D,MAA9DoC,EAA8DrB,EAA3Ba,EAAOnG,aAAW,KAEvDuE,EAEM,MAFNqC,EAEM,CADJC,EAAgCC,EAAAC,GAAA,CAArBtC,MAAM,iCAQ3BF,EA2DM,MA3DNyC,EA2DM,CA1DJpC,EAAA,MAAAA,EAAA,IAAAL,EAAa,UAAT,QAAI,IACRA,EAwDO,OAxDP0C,EAwDO,CAvDL1C,EAqBM,MArBN2C,GAqBM,CApBJ3C,EASM,MATN4C,GASM,CARJvC,EAAA,MAAAA,EAAA,IAAAL,EAAkC,SAA3B6C,IAAI,YAAW,QAAI,MAC1B7C,EAME,SALAzE,GAAG,WACM,sBAAA8E,EAAA,KAAAA,EAAA,GAAAyB,GAAAjG,GAAAW,MAAYV,UAASgG,GAC9BC,KAAK,OACLe,SAAA,GACAC,YAAY,oBAHH,CAAAC,EAAAnH,GAAAW,MAAYV,eAMzBkE,EASM,MATNiD,GASM,CARJ5C,EAAA,MAAAA,EAAA,IAAAL,EAA+B,SAAxB6C,IAAI,SAAQ,QAAI,MACvB7C,EAME,SALAzE,GAAG,QACM,sBAAA8E,EAAA,KAAAA,EAAA,GAAAyB,GAAAjG,GAAAW,MAAYT,MAAK+F,GAC1BC,KAAK,QACLe,SAAA,GACAC,YAAY,sBAHH,CAAAC,EAAAnH,GAAAW,MAAYT,aAQ3BiE,EAoBM,MApBNkD,GAoBM,CAnBJlD,EAQM,MARNmD,GAQM,CAPJ9C,EAAA,MAAAA,EAAA,IAAAL,EAAoC,SAA7B6C,IAAI,WAAU,WAAO,MAC5B7C,EAKS,UALDzE,GAAG,UAAmB,sBAAA8E,EAAA,KAAAA,EAAA,GAAAyB,GAAAjG,GAAAW,MAAYR,QAAO8F,GAAEgB,SAAA,mBACjD9C,EAAkC,UAA1BxD,MAAM,IAAG,YAAQ,GACzBwD,EAA8B,UAAtBxD,MAAM,MAAK,MAAE,GACrBwD,EAA8B,UAAtBxD,MAAM,MAAK,MAAE,GACrBwD,EAA8B,UAAtBxD,MAAM,MAAK,MAAE,WAJO,CAAA4G,EAAAvH,GAAAW,MAAYR,aAO5CgE,EASM,MATNqD,GASM,CARJhD,EAAA,MAAAA,EAAA,IAAAL,EAA8B,SAAvB6C,IAAI,QAAO,QAAI,MACtB7C,EAME,SALAzE,GAAG,OACM,sBAAA8E,EAAA,KAAAA,EAAA,GAAAyB,GAAAjG,GAAAW,MAAYP,KAAI6F,GACzBC,KAAK,OACLe,SAAA,GACAC,YAAY,oBAHH,CAAAC,EAAAnH,GAAAW,MAAYP,YAQ3B+D,EASM,MATNsD,GASM,CARJjD,EAAA,MAAAA,EAAA,IAAAL,EAAmC,SAA5B6C,IAAI,WAAU,UAAM,MAC3B7C,EAME,SALAzE,GAAG,UACM,sBAAA8E,EAAA,KAAAA,EAAA,GAAAyB,GAAAjG,GAAAW,MAAYN,QAAO4F,GAC5BC,KAAK,OACLe,SAAA,GACAC,YAAY,sBAHH,CAAAC,EAAAnH,GAAAW,MAAYN,iBAU7B8D,EAYM,MAZNuD,GAYM,CAXJvD,EAAwD,UAAhDE,MAAM,aAAcsD,QAAOlE,QAAQ,QAC3CU,EASS,UARPE,MAAM,UACLuD,UAAW3G,GAAAN,OAAUtB,GAAAsB,MACrBgH,QAAOzG,gBAEG7B,GAAAsB,OAAXqD,IAAAC,EAAkD,MAAlD4D,cACA1D,EAES,YAAAe,EADP7F,GAAAsB,MAAO,kBAAuBK,GAAAL,SAAW,YAKpCpB,GAAAoB,WAAXsD,EAEM,MAFN6D,GAEM5C,EADD3F,GAAAoB,OAAK","names":["router","useRouter","route","useRoute","loading","ref","error","selectedMethod","orderItems","id","name","description","quantity","price","image","billingInfo","full_name","email","country","city","address","postal_code","paymentMethods","icon","subtotal","computed","value","reduce","sum","item","discount","finalAmount","canPay","handlePayment","async","OrderService","__vitePreload","import","PaymentService","useAuthStore","then","n","w","authStore","user","Error","orderId","query","order","productId","product","orderData","product_id","billing_address","createOrder","paymentResult","processPayment","order_id","payment_method","payment_id","Date","now","amount","success","message","processPaymentSuccess","err","__VITE_PRELOAD__","url","push","path","toString","goBack","go","onMounted","console","log","loadOrderData","length","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","class","_hoisted_3","_hoisted_4","_cache","_hoisted_5","_Fragment","_renderList","key","_hoisted_6","src","alt","_hoisted_8","_hoisted_9","_toDisplayString","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","method","selected","$event","type","_hoisted_23","_hoisted_24","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_createVNode","_unref","CheckIcon","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","for","required","placeholder","_vModelText","_hoisted_34","_hoisted_35","_hoisted_36","_vModelSelect","_hoisted_37","_hoisted_38","_hoisted_39","onClick","disabled","_hoisted_41","_hoisted_42"],"ignoreList":[],"sources":["../../src/views/PaymentView.vue"],"sourcesContent":["<template>\r\n  <div class=\"payment-view\">\r\n    <div class=\"payment-container\">\r\n      <div class=\"payment-header\">\r\n        <h1>支付订单</h1>\r\n        <p>请选择支付方式完成购买</p>\r\n      </div>\r\n\r\n      <div class=\"payment-content\">\r\n        <!-- 订单信息 -->\r\n        <div class=\"order-summary\">\r\n          <h3>订单信息</h3>\r\n          <div class=\"order-items\">\r\n            <div v-for=\"item in orderItems\" :key=\"item.id\" class=\"order-item\">\r\n              <div class=\"item-image\">\r\n                <img :src=\"item.image\" :alt=\"item.name\" />\r\n              </div>\r\n              <div class=\"item-info\">\r\n                <h4 class=\"item-name\">{{ item.name }}</h4>\r\n                <p class=\"item-description\">{{ item.description }}</p>\r\n                <div class=\"item-meta\">\r\n                  <span class=\"item-quantity\">数量: {{ item.quantity }}</span>\r\n                  <span class=\"item-price\">¥{{ item.price }}</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"order-total\">\r\n            <div class=\"total-row\">\r\n              <span>商品总额</span>\r\n              <span>¥{{ subtotal }}</span>\r\n            </div>\r\n            <div class=\"total-row\">\r\n              <span>优惠折扣</span>\r\n              <span class=\"discount\">-¥{{ discount }}</span>\r\n            </div>\r\n            <div class=\"total-row final\">\r\n              <span>应付金额</span>\r\n              <span class=\"final-amount\">¥{{ finalAmount }}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 支付方式 -->\r\n        <div class=\"payment-methods\">\r\n          <h3>选择支付方式</h3>\r\n          <div class=\"methods-list\">\r\n            <label\r\n              v-for=\"method in paymentMethods\"\r\n              :key=\"method.id\"\r\n              class=\"method-option\"\r\n              :class=\"{ selected: selectedMethod === method.id }\"\r\n            >\r\n              <input\r\n                v-model=\"selectedMethod\"\r\n                type=\"radio\"\r\n                :value=\"method.id\"\r\n                name=\"paymentMethod\"\r\n              />\r\n              <div class=\"method-content\">\r\n                <div class=\"method-icon\">\r\n                  <img :src=\"method.icon\" :alt=\"method.name\" />\r\n                </div>\r\n                <div class=\"method-info\">\r\n                  <div class=\"method-name\">{{ method.name }}</div>\r\n                  <div class=\"method-description\">{{ method.description }}</div>\r\n                </div>\r\n                <div class=\"method-check\">\r\n                  <CheckIcon class=\"check-icon\" />\r\n                </div>\r\n              </div>\r\n            </label>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 账单地址 -->\r\n        <div class=\"billing-address\">\r\n          <h3>账单地址</h3>\r\n          <form class=\"address-form\">\r\n            <div class=\"form-row\">\r\n              <div class=\"form-group\">\r\n                <label for=\"fullName\">姓名 *</label>\r\n                <input\r\n                  id=\"fullName\"\r\n                  v-model=\"billingInfo.full_name\"\r\n                  type=\"text\"\r\n                  required\r\n                  placeholder=\"请输入姓名\"\r\n                />\r\n              </div>\r\n              <div class=\"form-group\">\r\n                <label for=\"email\">邮箱 *</label>\r\n                <input\r\n                  id=\"email\"\r\n                  v-model=\"billingInfo.email\"\r\n                  type=\"email\"\r\n                  required\r\n                  placeholder=\"请输入邮箱地址\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"form-row\">\r\n              <div class=\"form-group\">\r\n                <label for=\"country\">国家/地区 *</label>\r\n                <select id=\"country\" v-model=\"billingInfo.country\" required>\r\n                  <option value=\"\">请选择国家/地区</option>\r\n                  <option value=\"CN\">中国</option>\r\n                  <option value=\"US\">美国</option>\r\n                  <option value=\"JP\">日本</option>\r\n                </select>\r\n              </div>\r\n              <div class=\"form-group\">\r\n                <label for=\"city\">城市 *</label>\r\n                <input\r\n                  id=\"city\"\r\n                  v-model=\"billingInfo.city\"\r\n                  type=\"text\"\r\n                  required\r\n                  placeholder=\"请输入城市\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div class=\"form-group\">\r\n              <label for=\"address\">详细地址 *</label>\r\n              <input\r\n                id=\"address\"\r\n                v-model=\"billingInfo.address\"\r\n                type=\"text\"\r\n                required\r\n                placeholder=\"请输入详细地址\"\r\n              />\r\n            </div>\r\n          </form>\r\n        </div>\r\n\r\n        <!-- 支付按钮 -->\r\n        <div class=\"payment-actions\">\r\n          <button class=\"cancel-btn\" @click=\"goBack\">取消订单</button>\r\n          <button\r\n            class=\"pay-btn\"\r\n            :disabled=\"!canPay || loading\"\r\n            @click=\"handlePayment\"\r\n          >\r\n            <div v-if=\"loading\" class=\"loading-spinner\"></div>\r\n            <span>{{\r\n              loading ? \"处理中...\" : `立即支付 ¥${finalAmount}`\r\n            }}</span>\r\n          </button>\r\n        </div>\r\n\r\n        <div v-if=\"error\" class=\"error-message\">\r\n          {{ error }}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed, onMounted } from \"vue\";\r\nimport { useRouter, useRoute } from \"vue-router\";\r\nimport { CheckIcon } from \"lucide-vue-next\";\r\n\r\nconst router = useRouter();\r\nconst route = useRoute();\r\n\r\n// 响应式状态\r\nconst loading = ref(false);\r\nconst error = ref<string | null>(null);\r\nconst selectedMethod = ref(\"\");\r\n\r\nconst orderItems = ref([\r\n  {\r\n    id: \"1\",\r\n    name: \"高效办公套件\",\r\n    description: \"提升办公效率的完整解决方案\",\r\n    quantity: 1,\r\n    price: 299,\r\n    image: \"/placeholder.jpg\",\r\n  },\r\n]);\r\n\r\nconst billingInfo = ref({\r\n  full_name: \"\",\r\n  email: \"\",\r\n  country: \"\",\r\n  city: \"\",\r\n  address: \"\",\r\n  postal_code: \"\",\r\n});\r\n\r\nconst paymentMethods = [\r\n  {\r\n    id: \"alipay\",\r\n    name: \"支付宝\",\r\n    description: \"使用支付宝安全快捷支付\",\r\n    icon: \"/payment-alipay.png\",\r\n  },\r\n  {\r\n    id: \"wechat\",\r\n    name: \"微信支付\",\r\n    description: \"使用微信支付便捷支付\",\r\n    icon: \"/payment-wechat.png\",\r\n  },\r\n  {\r\n    id: \"stripe\",\r\n    name: \"信用卡\",\r\n    description: \"支持 Visa、MasterCard 等\",\r\n    icon: \"/payment-stripe.png\",\r\n  },\r\n];\r\n\r\n// 计算属性\r\nconst subtotal = computed(() => {\r\n  return orderItems.value.reduce(\r\n    (sum, item) => sum + item.price * item.quantity,\r\n    0,\r\n  );\r\n});\r\n\r\nconst discount = computed(() => 0); // 暂时没有折扣\r\n\r\nconst finalAmount = computed(() => subtotal.value - discount.value);\r\n\r\nconst canPay = computed(() => {\r\n  return (\r\n    selectedMethod.value &&\r\n    billingInfo.value.full_name &&\r\n    billingInfo.value.email &&\r\n    billingInfo.value.country &&\r\n    billingInfo.value.city &&\r\n    billingInfo.value.address\r\n  );\r\n});\r\n\r\n// 方法\r\nconst loadOrderData = async () => {\r\n  try {\r\n    const productId = route.query.product;\r\n    const orderId = route.query.order;\r\n\r\n    if (productId) {\r\n      // 从产品创建订单\r\n      console.log(\"从产品创建订单:\", productId);\r\n      // TODO: 从API获取产品信息\r\n    } else if (orderId) {\r\n      // 加载现有订单\r\n      console.log(\"加载现有订单:\", orderId);\r\n      // TODO: 从API获取订单信息\r\n    }\r\n  } catch (err) {\r\n    error.value = \"加载订单信息失败\";\r\n  }\r\n};\r\n\r\nconst handlePayment = async () => {\r\n  try {\r\n    loading.value = true;\r\n    error.value = null;\r\n\r\n    // 导入必要的服务\r\n    const { OrderService } = await import(\"@/services/orderService\");\r\n    const { PaymentService } = await import(\"@/services/paymentService\");\r\n    const { useAuthStore } = await import(\"@/stores/auth\");\r\n\r\n    const authStore = useAuthStore();\r\n    if (!authStore.user) {\r\n      throw new Error(\"请先登录\");\r\n    }\r\n\r\n    // 创建订单（如果还没有）\r\n    let orderId = route.query.order as string;\r\n\r\n    if (!orderId) {\r\n      // 从产品创建新订单\r\n      const productId = route.query.product as string;\r\n      if (!productId) {\r\n        throw new Error(\"缺少产品信息\");\r\n      }\r\n\r\n      const orderData = {\r\n        product_id: productId,\r\n        quantity: 1,\r\n        billing_address: billingInfo.value,\r\n      };\r\n\r\n      const newOrder = await OrderService.createOrder(\r\n        orderData,\r\n        authStore.user.id,\r\n      );\r\n      orderId = newOrder.id;\r\n    }\r\n\r\n    // 根据选择的支付方式处理支付\r\n    const paymentResult = await PaymentService.processPayment({\r\n      order_id: orderId,\r\n      payment_method: selectedMethod.value,\r\n      payment_id: `PAY_${Date.now()}`,\r\n      amount: finalAmount.value,\r\n    }, selectedMethod.value);\r\n\r\n    if (paymentResult.success) {\r\n      // 处理支付成功\r\n      await processPaymentSuccess(orderId);\r\n    } else {\r\n      throw new Error(paymentResult.message || \"支付失败\");\r\n    }\r\n  } catch (err) {\r\n    error.value = err instanceof Error ? err.message : \"支付失败，请重试\";\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n};\r\n\r\n// 支付处理方法 (已移至PaymentService)\r\n\r\nconst processPaymentSuccess = async (orderId: string) => {\r\n  const { OrderService } = await import(\"@/services/orderService\");\r\n  \r\n  // 处理支付成功\r\n  await OrderService.processPayment({\r\n    order_id: orderId,\r\n    payment_method: selectedMethod.value!,\r\n    payment_id: `PAY_${Date.now()}`, // 模拟支付ID\r\n    amount: finalAmount.value,\r\n  });\r\n\r\n  // 支付成功，跳转到成功页面\r\n  router.push({\r\n    path: \"/payment/success\",\r\n    query: {\r\n      order: orderId,\r\n      amount: finalAmount.value.toString(),\r\n    },\r\n  });\r\n};\r\n\r\nconst goBack = () => {\r\n  router.go(-1);\r\n};\r\n\r\n// 生命周期\r\nonMounted(() => {\r\n  loadOrderData();\r\n  // 默认选择第一个支付方式\r\n  if (paymentMethods.length > 0) {\r\n    selectedMethod.value = paymentMethods[0].id;\r\n  }\r\n});\r\n</script>\r\n\r\n<style scoped>\r\n.payment-view {\r\n  min-height: 100vh;\r\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n  padding: 2rem;\r\n}\r\n\r\n.payment-container {\r\n  max-width: 800px;\r\n  margin: 0 auto;\r\n  background: rgba(255, 255, 255, 0.95);\r\n  backdrop-filter: blur(20px);\r\n  border-radius: 1rem;\r\n  padding: 2rem;\r\n  box-shadow: 0 1rem 3rem rgba(0, 0, 0, 0.1);\r\n}\r\n\r\n.payment-header {\r\n  text-align: center;\r\n  margin-bottom: 2rem;\r\n}\r\n\r\n.payment-header h1 {\r\n  font-size: 2rem;\r\n  font-weight: 700;\r\n  color: #323130;\r\n  margin: 0 0 0.5rem 0;\r\n}\r\n\r\n.payment-header p {\r\n  color: #605e5c;\r\n  margin: 0;\r\n}\r\n\r\n.payment-content {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 2rem;\r\n}\r\n\r\n/* 订单信息 */\r\n.order-summary h3,\r\n.payment-methods h3,\r\n.billing-address h3 {\r\n  font-size: 1.25rem;\r\n  font-weight: 600;\r\n  color: #323130;\r\n  margin: 0 0 1rem 0;\r\n}\r\n\r\n.order-items {\r\n  margin-bottom: 1.5rem;\r\n}\r\n\r\n.order-item {\r\n  display: flex;\r\n  gap: 1rem;\r\n  padding: 1rem 0;\r\n  border-bottom: 1px solid #e1dfdd;\r\n}\r\n\r\n.order-item:last-child {\r\n  border-bottom: none;\r\n}\r\n\r\n.item-image {\r\n  width: 60px;\r\n  height: 60px;\r\n  border-radius: 8px;\r\n  overflow: hidden;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.item-image img {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: cover;\r\n}\r\n\r\n.item-info {\r\n  flex: 1;\r\n}\r\n\r\n.item-name {\r\n  font-size: 1rem;\r\n  font-weight: 600;\r\n  color: #323130;\r\n  margin: 0 0 0.25rem 0;\r\n}\r\n\r\n.item-description {\r\n  color: #605e5c;\r\n  font-size: 0.875rem;\r\n  margin: 0 0 0.5rem 0;\r\n}\r\n\r\n.item-meta {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  font-size: 0.875rem;\r\n  color: #8a8886;\r\n}\r\n\r\n.item-price {\r\n  font-weight: 600;\r\n  color: #323130;\r\n}\r\n\r\n.order-total {\r\n  border-top: 1px solid #e1dfdd;\r\n  padding-top: 1rem;\r\n}\r\n\r\n.total-row {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  margin-bottom: 0.5rem;\r\n}\r\n\r\n.total-row.final {\r\n  font-size: 1.125rem;\r\n  font-weight: 700;\r\n  color: #323130;\r\n  border-top: 1px solid #e1dfdd;\r\n  padding-top: 0.5rem;\r\n  margin-top: 0.5rem;\r\n}\r\n\r\n.discount {\r\n  color: #16a34a;\r\n}\r\n\r\n.final-amount {\r\n  color: #d13438;\r\n}\r\n\r\n/* 支付方式 */\r\n.methods-list {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 0.75rem;\r\n}\r\n\r\n.method-option {\r\n  display: block;\r\n  cursor: pointer;\r\n}\r\n\r\n.method-option input {\r\n  display: none;\r\n}\r\n\r\n.method-content {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 1rem;\r\n  padding: 1rem;\r\n  border: 2px solid #e1dfdd;\r\n  border-radius: 8px;\r\n  transition: all 0.2s ease;\r\n}\r\n\r\n.method-option:hover .method-content {\r\n  border-color: #0078d4;\r\n}\r\n\r\n.method-option.selected .method-content {\r\n  border-color: #0078d4;\r\n  background: rgba(0, 120, 212, 0.05);\r\n}\r\n\r\n.method-icon {\r\n  width: 40px;\r\n  height: 40px;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.method-icon img {\r\n  width: 100%;\r\n  height: 100%;\r\n  object-fit: contain;\r\n}\r\n\r\n.method-info {\r\n  flex: 1;\r\n}\r\n\r\n.method-name {\r\n  font-weight: 600;\r\n  color: #323130;\r\n  margin-bottom: 0.25rem;\r\n}\r\n\r\n.method-description {\r\n  font-size: 0.875rem;\r\n  color: #605e5c;\r\n}\r\n\r\n.method-check {\r\n  opacity: 0;\r\n  transition: opacity 0.2s ease;\r\n}\r\n\r\n.method-option.selected .method-check {\r\n  opacity: 1;\r\n}\r\n\r\n.check-icon {\r\n  width: 20px;\r\n  height: 20px;\r\n  color: #0078d4;\r\n}\r\n\r\n/* 账单地址 */\r\n.address-form {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 1rem;\r\n}\r\n\r\n.form-row {\r\n  display: grid;\r\n  grid-template-columns: 1fr 1fr;\r\n  gap: 1rem;\r\n}\r\n\r\n.form-group {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 0.5rem;\r\n}\r\n\r\n.form-group label {\r\n  font-weight: 600;\r\n  color: #323130;\r\n}\r\n\r\n.form-group input,\r\n.form-group select {\r\n  padding: 0.75rem;\r\n  border: 1px solid #e1dfdd;\r\n  border-radius: 0.5rem;\r\n  font-size: 1rem;\r\n  transition: all 0.2s ease;\r\n}\r\n\r\n.form-group input:focus,\r\n.form-group select:focus {\r\n  outline: none;\r\n  border-color: #0078d4;\r\n  box-shadow: 0 0 0 2px rgba(0, 120, 212, 0.2);\r\n}\r\n\r\n/* 支付按钮 */\r\n.payment-actions {\r\n  display: flex;\r\n  gap: 1rem;\r\n  justify-content: flex-end;\r\n}\r\n\r\n.cancel-btn,\r\n.pay-btn {\r\n  padding: 0.875rem 1.5rem;\r\n  border: none;\r\n  border-radius: 0.5rem;\r\n  font-size: 1rem;\r\n  font-weight: 600;\r\n  cursor: pointer;\r\n  transition: all 0.2s ease;\r\n}\r\n\r\n.cancel-btn {\r\n  background: transparent;\r\n  color: #605e5c;\r\n  border: 1px solid #e1dfdd;\r\n}\r\n\r\n.cancel-btn:hover {\r\n  background: #f3f2f1;\r\n}\r\n\r\n.pay-btn {\r\n  background: #0078d4;\r\n  color: white;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n}\r\n\r\n.pay-btn:hover:not(:disabled) {\r\n  background: #106ebe;\r\n}\r\n\r\n.pay-btn:disabled {\r\n  background: #c8c6c4;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.loading-spinner {\r\n  width: 1rem;\r\n  height: 1rem;\r\n  border: 2px solid transparent;\r\n  border-top: 2px solid white;\r\n  border-radius: 50%;\r\n  animation: spin 1s linear infinite;\r\n}\r\n\r\n@keyframes spin {\r\n  0% {\r\n    transform: rotate(0deg);\r\n  }\r\n  100% {\r\n    transform: rotate(360deg);\r\n  }\r\n}\r\n\r\n.error-message {\r\n  padding: 0.75rem;\r\n  background: #fef2f2;\r\n  border: 1px solid #fecaca;\r\n  border-radius: 0.5rem;\r\n  color: #dc2626;\r\n  font-size: 0.875rem;\r\n  text-align: center;\r\n}\r\n\r\n/* 响应式设计 */\r\n@media (max-width: 768px) {\r\n  .payment-view {\r\n    padding: 1rem;\r\n  }\r\n\r\n  .payment-container {\r\n    padding: 1.5rem;\r\n  }\r\n\r\n  .form-row {\r\n    grid-template-columns: 1fr;\r\n  }\r\n\r\n  .payment-actions {\r\n    flex-direction: column;\r\n  }\r\n\r\n  .method-content {\r\n    flex-direction: column;\r\n    text-align: center;\r\n  }\r\n}\r\n</style>"],"file":"assets/PaymentView-CZcTR5HP.js"}