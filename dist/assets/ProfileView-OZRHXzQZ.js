import{d as e,r as a,c as l,o as s,au as o,t as i,v as r,A as t,E as n,z as u,x as d,C as c,D as m,I as v}from"./vendor-BUZxw6e1.js";import{_ as f}from"./index-BxdVNC7e.js";const p={class:"profile-view"},b={class:"profile-content"},g={class:"avatar-section"},h={class:"avatar-container"},y=["src","alt"],w={class:"avatar-info"},U={class:"form-section"},x={class:"form-row"},N={class:"form-group"},_=["disabled"],k={class:"form-group"},C=["disabled"],V={class:"form-group"},j={class:"form-group"},I=["disabled"],P={class:"form-row"},S={class:"form-group"},E=["disabled"],R={class:"form-group"},A=["disabled"],F={class:"form-actions"},O=["disabled"],T=["disabled"],L={key:0,class:"loading-spinner"},z={key:0,class:"error-message"},D={key:1,class:"success-message"};const q=f(e({__name:"ProfileView",setup(e,{expose:i}){i();const r=a(!1),t=a(null),n=a(!1),u=a(),d=a({id:"",email:"",username:"",fullName:"",avatarUrl:"",bio:"",website:"",location:""}),c=a({fullName:"",username:"",email:"",bio:"",website:"",location:""}),m=a({fullName:"",username:"",email:"",bio:"",website:"",location:""}),v=l(()=>Object.keys(c.value).some(e=>c.value[e]!==m.value[e])),f=async()=>{try{r.value=!0,t.value=null;const e={id:"user-1",email:"user@example.com",username:"user123",fullName:"张三",avatarUrl:"",bio:"这是我的个人简介",website:"https://example.com",location:"北京"};d.value=e,c.value={...e},m.value={...e}}catch(e){t.value=e instanceof Error?e.message:"加载用户资料失败"}finally{r.value=!1}};s(()=>{f()});const p={loading:r,error:t,success:n,fileInput:u,profile:d,form:c,originalForm:m,hasChanges:v,loadProfile:f,handleSave:async()=>{try{r.value=!0,t.value=null,n.value=!1,await new Promise(e=>setTimeout(e,1e3)),d.value={...d.value,...c.value},m.value={...c.value},n.value=!0,setTimeout(()=>{n.value=!1},3e3)}catch(e){t.value=e instanceof Error?e.message:"保存失败，请重试"}finally{r.value=!1}},handleReset:()=>{c.value={...m.value},t.value=null,n.value=!1},triggerFileUpload:()=>{var e;null==(e=u.value)||e.click()},handleAvatarUpload:async e=>{var a;const l=null==(a=e.target.files)?void 0:a[0];if(l)try{r.value=!0,t.value=null,await new Promise(e=>setTimeout(e,1e3));const e=URL.createObjectURL(l);d.value.avatarUrl=e}catch(s){t.value=s instanceof Error?s.message:"头像上传失败"}finally{r.value=!1}},get CameraIcon(){return o}};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}}),[["render",function(e,a,l,s,o,f){return v(),i("div",p,[a[14]||(a[14]=r("div",{class:"profile-header"},[r("h1",null,"个人资料"),r("p",null,"管理您的个人信息和偏好设置")],-1)),r("div",b,[r("div",g,[r("div",h,[r("img",{src:s.profile.avatarUrl||"/placeholder-user.jpg",alt:s.profile.fullName,class:"avatar"},null,8,y),r("button",{class:"avatar-upload",onClick:s.triggerFileUpload},[t(s.CameraIcon,{class:"icon"})]),r("input",{ref:"fileInput",type:"file",accept:"image/*",style:{display:"none"},onChange:s.handleAvatarUpload},null,544)]),r("div",w,[r("h3",null,n(s.profile.fullName||"未设置姓名"),1),r("p",null,n(s.profile.email),1)])]),r("form",{class:"profile-form",onSubmit:u(s.handleSave,["prevent"])},[r("div",U,[a[13]||(a[13]=r("h3",null,"基本信息",-1)),r("div",x,[r("div",N,[a[6]||(a[6]=r("label",{for:"fullName"},"姓名",-1)),c(r("input",{id:"fullName","onUpdate:modelValue":a[0]||(a[0]=e=>s.form.fullName=e),type:"text",placeholder:"请输入您的姓名",disabled:s.loading},null,8,_),[[m,s.form.fullName]])]),r("div",k,[a[7]||(a[7]=r("label",{for:"username"},"用户名",-1)),c(r("input",{id:"username","onUpdate:modelValue":a[1]||(a[1]=e=>s.form.username=e),type:"text",placeholder:"请输入用户名",disabled:s.loading},null,8,C),[[m,s.form.username]])])]),r("div",V,[a[8]||(a[8]=r("label",{for:"email"},"邮箱地址",-1)),c(r("input",{id:"email","onUpdate:modelValue":a[2]||(a[2]=e=>s.form.email=e),type:"email",disabled:"",class:"readonly"},null,512),[[m,s.form.email]]),a[9]||(a[9]=r("small",{class:"form-hint"},"邮箱地址不可修改",-1))]),r("div",j,[a[10]||(a[10]=r("label",{for:"bio"},"个人简介",-1)),c(r("textarea",{id:"bio","onUpdate:modelValue":a[3]||(a[3]=e=>s.form.bio=e),rows:"4",placeholder:"介绍一下您自己...",disabled:s.loading},null,8,I),[[m,s.form.bio]])]),r("div",P,[r("div",S,[a[11]||(a[11]=r("label",{for:"website"},"个人网站",-1)),c(r("input",{id:"website","onUpdate:modelValue":a[4]||(a[4]=e=>s.form.website=e),type:"url",placeholder:"https://example.com",disabled:s.loading},null,8,E),[[m,s.form.website]])]),r("div",R,[a[12]||(a[12]=r("label",{for:"location"},"所在地",-1)),c(r("input",{id:"location","onUpdate:modelValue":a[5]||(a[5]=e=>s.form.location=e),type:"text",placeholder:"请输入您的所在地",disabled:s.loading},null,8,A),[[m,s.form.location]])])])]),r("div",F,[r("button",{type:"button",class:"btn btn-secondary",disabled:s.loading,onClick:s.handleReset}," 重置 ",8,O),r("button",{type:"submit",class:"btn btn-primary",disabled:s.loading||!s.hasChanges},[s.loading?(v(),i("div",L)):d("",!0),r("span",null,n(s.loading?"保存中...":"保存更改"),1)],8,T)]),s.error?(v(),i("div",z,n(s.error),1)):d("",!0),s.success?(v(),i("div",D,"个人资料已成功更新！")):d("",!0)],32)])])}],["__scopeId","data-v-eaaca367"],["__file","/mnt/persist/workspace/src/views/user/ProfileView.vue"]]);export{q as default};
