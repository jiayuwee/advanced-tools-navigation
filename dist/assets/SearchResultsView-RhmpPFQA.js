import{d as l,r as s,c as a,o as e,w as u,m as t,q as n,t as i,E as o,D as r,y as c,G as v,P as d,F as p,z as h,A as y}from"./vendor-B_bmgS9f.js";import{d as g,c as m,_ as k}from"./index-BZH0TPyE.js";import{E as f,s as q}from"./EnhancedSearchBox-B50nz949.js";import"./folder-o9BoEDv8.js";import"./trending-up-BWRNCflz.js";const w={class:"search-results-view"},C={class:"container"},_={class:"search-header"},b={class:"search-info"},j={key:0},P={key:0},x={class:"search-box"},O={key:0,class:"loading-state"},S={key:1,class:"search-results"},E={class:"search-stats"},D={class:"search-filters"},F={key:0,class:"search-suggestions"},G={class:"suggestions-list"},R=["onClick"],U={class:"results-content"},V={key:0,class:"results-section"},$={class:"tools-grid"},z=["onClick"],A={class:"tool-icon"},B={class:"tool-info"},I={class:"tool-meta"},T={class:"category"},H={class:"clicks"},J={key:1,class:"results-section"},K={class:"products-grid"},L=["onClick"],M={class:"product-image"},N=["src","alt"],Q={class:"product-info"},W={class:"product-meta"},X={class:"price"},Y={class:"rating"},Z={key:2,class:"no-results"},ll={key:2,class:"error-state"},sl=k(l({__name:"SearchResultsView",setup(l){const k=g(),sl=m(),al=s(!1),el=s(null),ul=s(null),tl=s(""),nl=s("all"),il=a(()=>ul.value?ul.value.items.filter(l=>"tool"===l.type||!l.type||l.hasOwnProperty("clickCount")||l.hasOwnProperty("category_id")):[]),ol=a(()=>ul.value?ul.value.items.filter(l=>"product"===l.type||l.hasOwnProperty("price")||l.hasOwnProperty("rating")):[]),rl=async()=>{if(tl.value.trim())try{al.value=!0,el.value=null;const l=await q.search({query:tl.value,type:nl.value,limit:50});ul.value=l}catch(l){el.value="搜索失败，请稍后重试",console.error("搜索错误:",l)}finally{al.value=!1}},cl=l=>{ul.value=l,tl.value=l.query,sl.push({name:"SearchResults",query:{q:l.query,type:nl.value}})},vl=()=>{rl()};return e(()=>{tl.value=k.query.q||"",nl.value=k.query.type||"all",tl.value&&rl()}),u(()=>k.query,l=>{tl.value=l.q||"",nl.value=l.type||"all",tl.value&&rl()}),(l,s)=>(y(),t("div",w,[n("div",C,[n("div",_,[n("div",b,[s[3]||(s[3]=n("h1",null,"搜索结果",-1)),tl.value?(y(),t("p",j,[s[1]||(s[1]=o(' 关于 "')),n("strong",null,r(tl.value),1),s[2]||(s[2]=o('" 的搜索结果 ')),ul.value?(y(),t("span",P,"("+r(ul.value.total)+" 个结果)",1)):i("",!0)])):i("",!0)]),n("div",x,[c(f,{"initial-query":tl.value,placeholder:"重新搜索...",onSearch:cl},null,8,["initial-query"])])]),al.value?(y(),t("div",O,s[4]||(s[4]=[n("div",{class:"loading-spinner"},null,-1),n("p",null,"正在搜索...",-1)]))):ul.value?(y(),t("div",S,[n("div",E,[n("p",null," 找到 "+r(ul.value.total)+" 个结果，用时 "+r(ul.value.searchTime)+"ms ",1),n("div",D,[v(n("select",{"onUpdate:modelValue":s[0]||(s[0]=l=>nl.value=l),onChange:vl},s[5]||(s[5]=[n("option",{value:"all"},"全部类型",-1),n("option",{value:"tools"},"工具",-1),n("option",{value:"products"},"产品",-1),n("option",{value:"categories"},"分类",-1)]),544),[[d,nl.value]])])]),ul.value.suggestions.length>0?(y(),t("div",F,[s[6]||(s[6]=n("h3",null,"相关建议",-1)),n("div",G,[(y(!0),t(p,null,h(ul.value.suggestions,l=>(y(),t("button",{key:l,class:"suggestion-tag",onClick:s=>(l=>{tl.value=l,rl()})(l)},r(l),9,R))),128))])])):i("",!0),n("div",U,[il.value.length>0?(y(),t("div",V,[n("h2",null,"工具 ("+r(il.value.length)+")",1),n("div",$,[(y(!0),t(p,null,h(il.value,l=>{var s;return y(),t("div",{key:l.id,class:"tool-card",onClick:s=>(l=>{l.url?window.open(l.url,"_blank"):sl.push(`/tools/${l.id}`)})(l)},[n("div",A,r(l.icon),1),n("div",B,[n("h3",null,r(l.name),1),n("p",null,r(l.description),1),n("div",I,[n("span",T,r(null==(s=l.category)?void 0:s.name),1),n("span",H,r(l.clickCount)+" 次使用",1)])])],8,z)}),128))])])):i("",!0),ol.value.length>0?(y(),t("div",J,[n("h2",null,"产品 ("+r(ol.value.length)+")",1),n("div",K,[(y(!0),t(p,null,h(ol.value,l=>(y(),t("div",{key:l.id,class:"product-card",onClick:s=>(l=>{sl.push(`/product/${l.id}`)})(l)},[n("div",M,[n("img",{src:l.imageUrl,alt:l.name},null,8,N)]),n("div",Q,[n("h3",null,r(l.name),1),n("p",null,r(l.description),1),n("div",W,[n("span",X,"¥"+r(l.price),1),n("span",Y,"★ "+r(l.rating),1)])])],8,L))),128))])])):i("",!0),0===ul.value.total?(y(),t("div",Z,s[7]||(s[7]=[n("div",{class:"no-results-icon"},"🔍",-1),n("h3",null,"未找到相关结果",-1),n("p",null,"尝试使用不同的关键词或检查拼写",-1),n("div",{class:"search-tips"},[n("h4",null,"搜索建议："),n("ul",null,[n("li",null,"使用更通用的关键词"),n("li",null,"检查拼写是否正确"),n("li",null,"尝试使用同义词"),n("li",null,"减少搜索词的数量")])],-1)]))):i("",!0)])])):el.value?(y(),t("div",ll,[s[8]||(s[8]=n("div",{class:"error-icon"},"⚠️",-1)),s[9]||(s[9]=n("h3",null,"搜索出错",-1)),n("p",null,r(el.value),1),n("button",{class:"retry-button",onClick:rl},"重试")])):i("",!0)])]))}}),[["__scopeId","data-v-504565d2"]]);export{sl as default};
