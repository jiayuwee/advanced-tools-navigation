import{d as e,r as a,c as l,o as s,W as i,t as n,v as t,x as o,F as d,B as r,E as c,J as u,C as m,Z as p,A as v,D as y,G as f,I as g}from"./vendor-BUZxw6e1.js";import{u as h,e as b,_ as I}from"./index-BxdVNC7e.js";const w={class:"payment-view"},k={class:"payment-container"},q={class:"payment-content"},P={class:"order-summary"},V={class:"order-items"},_={class:"item-image"},M=["src","alt"],x={class:"item-info"},C={class:"item-name"},N={class:"item-description"},U={class:"item-meta"},j={class:"item-quantity"},A={class:"item-price"},B={class:"order-total"},S={class:"total-row"},D={class:"total-row"},E={class:"discount"},J={class:"total-row final"},O={class:"final-amount"},F={class:"payment-methods"},G={class:"methods-list"},T=["value"],W={class:"method-content"},Z={class:"method-icon"},$=["src","alt"],z={class:"method-info"},H={class:"method-name"},K={class:"method-description"},L={class:"method-check"},Q={class:"billing-address"},R={class:"address-form"},X={class:"form-row"},Y={class:"form-group"},ee={class:"form-group"},ae={class:"form-row"},le={class:"form-group"},se={class:"form-group"},ie={class:"form-group"},ne={class:"payment-actions"},te=["disabled"],oe={key:0,class:"loading-spinner"},de={key:0,class:"error-message"};const re=I(e({__name:"PaymentView",setup(e,{expose:n}){n();const t=h(),o=b(),d=a(!1),r=a(null),c=a(""),u=a([{id:"1",name:"高效办公套件",description:"提升办公效率的完整解决方案",quantity:1,price:299,image:"/placeholder.jpg"}]),m=a({fullName:"",email:"",country:"",city:"",address:""}),p=[{id:"alipay",name:"支付宝",description:"使用支付宝安全快捷支付",icon:"/payment-alipay.png"},{id:"wechat",name:"微信支付",description:"使用微信支付便捷支付",icon:"/payment-wechat.png"},{id:"stripe",name:"信用卡",description:"支持 Visa、MasterCard 等",icon:"/payment-stripe.png"}],v=l(()=>u.value.reduce((e,a)=>e+a.price*a.quantity,0)),y=l(()=>0),f=l(()=>v.value-y.value),g=l(()=>c.value&&m.value.fullName&&m.value.email&&m.value.country&&m.value.city&&m.value.address),I=()=>{const e=o.query.product,a=o.query.order;e?console.log("从产品创建订单:",e):a&&console.log("加载现有订单:",a)};s(()=>{I(),p.length>0&&(c.value=p[0].id)});const w={router:t,route:o,loading:d,error:r,selectedMethod:c,orderItems:u,billingInfo:m,paymentMethods:p,subtotal:v,discount:y,finalAmount:f,canPay:g,loadOrderData:I,handlePayment:async()=>{try{d.value=!0,r.value=null,await new Promise(e=>setTimeout(e,2e3)),t.push("/payment/success")}catch(e){r.value=e instanceof Error?e.message:"支付失败，请重试"}finally{d.value=!1}},goBack:()=>{t.go(-1)},get CheckIcon(){return i}};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}}),[["render",function(e,a,l,s,i,h){return g(),n("div",w,[t("div",k,[a[18]||(a[18]=t("div",{class:"payment-header"},[t("h1",null,"支付订单"),t("p",null,"请选择支付方式完成购买")],-1)),t("div",q,[t("div",P,[a[9]||(a[9]=t("h3",null,"订单信息",-1)),t("div",V,[(g(!0),n(d,null,r(s.orderItems,e=>(g(),n("div",{key:e.id,class:"order-item"},[t("div",_,[t("img",{src:e.image,alt:e.name},null,8,M)]),t("div",x,[t("h4",C,c(e.name),1),t("p",N,c(e.description),1),t("div",U,[t("span",j,"数量: "+c(e.quantity),1),t("span",A,"¥"+c(e.price),1)])])]))),128))]),t("div",B,[t("div",S,[a[6]||(a[6]=t("span",null,"商品总额",-1)),t("span",null,"¥"+c(s.subtotal),1)]),t("div",D,[a[7]||(a[7]=t("span",null,"优惠折扣",-1)),t("span",E,"-¥"+c(s.discount),1)]),t("div",J,[a[8]||(a[8]=t("span",null,"应付金额",-1)),t("span",O,"¥"+c(s.finalAmount),1)])])]),t("div",F,[a[10]||(a[10]=t("h3",null,"选择支付方式",-1)),t("div",G,[(g(),n(d,null,r(s.paymentMethods,e=>t("label",{key:e.id,class:u(["method-option",{selected:s.selectedMethod===e.id}])},[m(t("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>s.selectedMethod=e),type:"radio",value:e.id,name:"paymentMethod"},null,8,T),[[p,s.selectedMethod]]),t("div",W,[t("div",Z,[t("img",{src:e.icon,alt:e.name},null,8,$)]),t("div",z,[t("div",H,c(e.name),1),t("div",K,c(e.description),1)]),t("div",L,[v(s.CheckIcon,{class:"check-icon"})])])],2)),64))])]),t("div",Q,[a[17]||(a[17]=t("h3",null,"账单地址",-1)),t("form",R,[t("div",X,[t("div",Y,[a[11]||(a[11]=t("label",{for:"fullName"},"姓名 *",-1)),m(t("input",{id:"fullName","onUpdate:modelValue":a[1]||(a[1]=e=>s.billingInfo.fullName=e),type:"text",required:"",placeholder:"请输入姓名"},null,512),[[y,s.billingInfo.fullName]])]),t("div",ee,[a[12]||(a[12]=t("label",{for:"email"},"邮箱 *",-1)),m(t("input",{id:"email","onUpdate:modelValue":a[2]||(a[2]=e=>s.billingInfo.email=e),type:"email",required:"",placeholder:"请输入邮箱地址"},null,512),[[y,s.billingInfo.email]])])]),t("div",ae,[t("div",le,[a[14]||(a[14]=t("label",{for:"country"},"国家/地区 *",-1)),m(t("select",{id:"country","onUpdate:modelValue":a[3]||(a[3]=e=>s.billingInfo.country=e),required:""},a[13]||(a[13]=[t("option",{value:""},"请选择国家/地区",-1),t("option",{value:"CN"},"中国",-1),t("option",{value:"US"},"美国",-1),t("option",{value:"JP"},"日本",-1)]),512),[[f,s.billingInfo.country]])]),t("div",se,[a[15]||(a[15]=t("label",{for:"city"},"城市 *",-1)),m(t("input",{id:"city","onUpdate:modelValue":a[4]||(a[4]=e=>s.billingInfo.city=e),type:"text",required:"",placeholder:"请输入城市"},null,512),[[y,s.billingInfo.city]])])]),t("div",ie,[a[16]||(a[16]=t("label",{for:"address"},"详细地址 *",-1)),m(t("input",{id:"address","onUpdate:modelValue":a[5]||(a[5]=e=>s.billingInfo.address=e),type:"text",required:"",placeholder:"请输入详细地址"},null,512),[[y,s.billingInfo.address]])])])]),t("div",ne,[t("button",{class:"cancel-btn",onClick:s.goBack},"取消订单"),t("button",{class:"pay-btn",disabled:!s.canPay||s.loading,onClick:s.handlePayment},[s.loading?(g(),n("div",oe)):o("",!0),t("span",null,c(s.loading?"处理中...":`立即支付 ¥${s.finalAmount}`),1)],8,te)]),s.error?(g(),n("div",de,c(s.error),1)):o("",!0)])])])}],["__scopeId","data-v-7779902a"],["__file","/mnt/persist/workspace/src/views/PaymentView.vue"]]);export{re as default};
