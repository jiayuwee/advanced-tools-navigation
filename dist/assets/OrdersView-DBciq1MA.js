import{d as e,r as t,c as a,o as s,ax as r,a5 as l,t as i,v as n,F as d,B as o,J as c,Y as u,E as p,x as m,A as v,a6 as y,I as g}from"./vendor-BUZxw6e1.js";import{u as k,_ as f}from"./index-BxdVNC7e.js";const w={class:"orders-view"},S={class:"orders-filters"},b=["onClick"],O={class:"filter-count"},D={class:"orders-content"},h={key:0,class:"loading-state"},I={key:1,class:"orders-list"},C={class:"order-header"},A={class:"order-info"},_={class:"order-number"},x={class:"order-date"},F={class:"order-status"},P={class:"order-items"},j={class:"item-image"},E=["src","alt"],T={class:"item-info"},q={class:"item-name"},N={class:"item-description"},Y={class:"item-meta"},V={class:"item-quantity"},z={class:"item-price"},B={class:"item-total"},J={class:"order-footer"},L={class:"order-total"},M={class:"total-amount"},U={class:"order-actions"},$=["onClick"],G=["onClick"],H=["onClick"],K=["onClick"],Q={key:2,class:"empty-state"};const R=f(e({__name:"OrdersView",setup(e,{expose:l}){l();const i=k(),n=t(!0),d=t("all"),o=t([]),c=a(()=>"all"===d.value?o.value:o.value.filter(e=>e.status===d.value)),u=async()=>{try{n.value=!0,await new Promise(e=>setTimeout(e,1e3)),o.value=[{id:"order-1",userId:"user-1",items:[{id:"item-1",orderId:"order-1",productId:"product-1",quantity:1,unitPrice:299,totalPrice:299,createdAt:(new Date).toISOString(),product:{id:"product-1",name:"高效办公套件",shortDescription:"提升办公效率的完整解决方案",images:["/placeholder.jpg"]}}],totalAmount:299,currency:"CNY",status:"paid",paymentMethod:"alipay",createdAt:new Date(Date.now()-864e5).toISOString(),updatedAt:(new Date).toISOString(),completedAt:(new Date).toISOString()},{id:"order-2",userId:"user-1",items:[{id:"item-2",orderId:"order-2",productId:"product-2",quantity:1,unitPrice:199,totalPrice:199,createdAt:(new Date).toISOString(),product:{id:"product-2",name:"设计师工具包",shortDescription:"专业设计师必备工具集合",images:["/placeholder.jpg"]}}],totalAmount:199,currency:"CNY",status:"pending",createdAt:new Date(Date.now()-36e5).toISOString(),updatedAt:(new Date).toISOString()}]}catch(e){console.error("加载订单失败:",e)}finally{n.value=!1}};s(()=>{u()});const p={router:i,loading:n,activeFilter:d,orders:o,statusFilters:[{key:"all",label:"全部订单"},{key:"pending",label:"待支付"},{key:"paid",label:"已支付"},{key:"cancelled",label:"已取消"},{key:"refunded",label:"已退款"}],filteredOrders:c,getFilterCount:e=>"all"===e?o.value.length:o.value.filter(t=>t.status===e).length,loadOrders:u,getStatusText:e=>({pending:"待支付",paid:"已支付",cancelled:"已取消",refunded:"已退款"}[e]||e),getEmptyStateTitle:()=>({all:"暂无订单",pending:"暂无待支付订单",paid:"暂无已支付订单",cancelled:"暂无已取消订单",refunded:"暂无已退款订单"}[d.value]||"暂无订单"),getEmptyStateDescription:()=>({all:"您还没有任何订单，去购买一些产品吧！",pending:"您没有待支付的订单",paid:"您没有已支付的订单",cancelled:"您没有已取消的订单",refunded:"您没有已退款的订单"}[d.value]||"暂无相关订单"),formatDate:e=>new Date(e).toLocaleString("zh-CN"),payOrder:e=>{i.push(`/payment?order=${e.id}`)},cancelOrder:async e=>{if(confirm("确定要取消这个订单吗？"))try{const t=o.value.findIndex(t=>t.id===e.id);-1!==t&&(o.value[t].status="cancelled")}catch(t){console.error("取消订单失败:",t)}},downloadOrder:e=>{console.log("下载订单产品:",e.id)},viewOrderDetail:e=>{console.log("查看订单详情:",e.id)},get DownloadIcon(){return r}};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}}),[["render",function(e,t,a,s,r,k){const f=l("router-link");return g(),i("div",w,[t[5]||(t[5]=n("div",{class:"orders-header"},[n("h1",null,"我的订单"),n("p",null,"查看和管理您的订单历史")],-1)),n("div",S,[(g(),i(d,null,o(s.statusFilters,e=>n("button",{key:e.key,class:c(["filter-btn",{active:s.activeFilter===e.key}]),onClick:t=>s.activeFilter=e.key},[u(p(e.label)+" ",1),n("span",O,p(s.getFilterCount(e.key)),1)],10,b)),64))]),n("div",D,[s.loading?(g(),i("div",h,t[0]||(t[0]=[n("div",{class:"loading-spinner"},null,-1),n("p",null,"正在加载订单...",-1)]))):s.filteredOrders.length>0?(g(),i("div",I,[(g(!0),i(d,null,o(s.filteredOrders,e=>(g(),i("div",{key:e.id,class:"order-item"},[n("div",C,[n("div",A,[n("h3",_," 订单号: "+p(e.id.slice(-8).toUpperCase()),1),n("p",x," 下单时间: "+p(s.formatDate(e.createdAt)),1)]),n("div",F,[n("span",{class:c(["status-badge",e.status])},p(s.getStatusText(e.status)),3)])]),n("div",P,[(g(!0),i(d,null,o(e.items,e=>{var t,a,s,r,l;return g(),i("div",{key:e.id,class:"order-item-detail"},[n("div",j,[n("img",{src:(null==(a=null==(t=e.product)?void 0:t.images)?void 0:a[0])||"/placeholder.jpg",alt:null==(s=e.product)?void 0:s.name},null,8,E)]),n("div",T,[n("h4",q,p(null==(r=e.product)?void 0:r.name),1),n("p",N,p(null==(l=e.product)?void 0:l.shortDescription),1),n("div",Y,[n("span",V,"数量: "+p(e.quantity),1),n("span",z,"单价: ¥"+p(e.unitPrice),1)])]),n("div",B,"¥"+p(e.totalPrice),1)])}),128))]),n("div",J,[n("div",L,[t[1]||(t[1]=n("span",{class:"total-label"},"订单总额:",-1)),n("span",M,"¥"+p(e.totalAmount),1)]),n("div",U,["pending"===e.status?(g(),i("button",{key:0,class:"action-btn primary",onClick:t=>s.payOrder(e)}," 立即支付 ",8,$)):m("",!0),"pending"===e.status?(g(),i("button",{key:1,class:"action-btn secondary",onClick:t=>s.cancelOrder(e)}," 取消订单 ",8,G)):m("",!0),"paid"===e.status?(g(),i("button",{key:2,class:"action-btn secondary",onClick:t=>s.downloadOrder(e)},[v(s.DownloadIcon,{class:"icon"}),t[2]||(t[2]=u(" 下载产品 "))],8,H)):m("",!0),n("button",{class:"action-btn secondary",onClick:t=>s.viewOrderDetail(e)}," 查看详情 ",8,K)])])]))),128))])):(g(),i("div",Q,[t[4]||(t[4]=n("div",{class:"empty-icon"},"📦",-1)),n("h3",null,p(s.getEmptyStateTitle()),1),n("p",null,p(s.getEmptyStateDescription()),1),v(f,{to:"/products",class:"empty-action"},{default:y(()=>t[3]||(t[3]=[u("去购买产品")])),_:1,__:[3]})]))])])}],["__scopeId","data-v-b1a7e600"],["__file","/mnt/persist/workspace/src/views/user/OrdersView.vue"]]);export{R as default};
